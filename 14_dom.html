<!doctype html>
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>DOM یا مدل شیء سند :: Eloquent JavaScript</title>
  <link rel=stylesheet href="js/node_modules/codemirror/lib/codemirror.css">
  <script src="js/acorn_codemirror.js"></script>
  <link rel=stylesheet href="css/ejs.css">
  <script src="js/sandbox.js"></script>
  <script src="js/ejs.js"></script><script>var chapNum = 14;</script><script>var clicky_site_ids = clicky_site_ids || []; clicky_site_ids.push(101171577);</script>
  <script async src="//static.getclicky.com/js"></script>

</head>

<article>
<nav><a href="13_browser.html" title="previous chapter">◀</a> <a href="index.html" title="cover">◆</a> <a href="15_event.html" title="next chapter">▶</a></nav>

<h1><span class=chap_num>Chapter 14</span>DOM یا مدل شیء سند</h1>

<blockquote>

<p><a class="p_ident" id="p_2jmj7l5rSw" href="#p_2jmj7l5rSw" tabindex="-1" role="presentation"></a>چه بد! داستانی تکراری! وقتی کار ساخت خانه را تمام می‌کنی، متوجه می‌شوی که چیزی یاد گرفتی که می‌بایست پیش از شروع کار می‌دانستی.</p>

<footer>فردریش نیچه, <cite>فراسوی نیک و بد</cite></footer>

</blockquote><figure class="chapter framed"><img src="img/chapter_picture_14.jpg" alt="Picture of a tree with letters and scripts hanging from its branches"></figure>

<p><a class="p_ident" id="p_n3OM6EV/KR" href="#p_n3OM6EV/KR" tabindex="-1" role="presentation"></a>وقتی یک صفحه وب را در مرورگرتان باز می کنید، مرورگر متن HTML صفحه را گرفته و آن را تفسیر می کند، بسیار شبیه به آنچه تجزیه‌گر ما برای تجزیه‌ی برنامه‌ها در <a href="12_language.html#parsing">فصل 12</a> انجام می داد. مرورگر یک مدل از ساختار سند می سازد و از آن برای نمایش سند روی صفحه‌ی نمایش استفاده می کند.</p>

<p><a class="p_ident" id="p_ntA3uElDxM" href="#p_ntA3uElDxM" tabindex="-1" role="presentation"></a>این نمایش از سند، یکی از ابزارهایی است که یک برنامه‌ی جاوااسکریپت در جعبه‌ی شنی (sandbox) خود به آن دسترسی دارد. یک ساختار داده که می‌تواند خوانده شود یا تغییر یابد؛ ساختار داده‌ای <em>زنده</em>: زمانی که تغییری در آن رخ می‌دهد، صفحه‌ای که در مانیتور نمایش داده می شود نیز به‌روز می شود تا تغییرات را منعکس کند.</p>

<h2><a class="h_ident" id="h_B+jPe26cOz" href="#h_B+jPe26cOz" tabindex="-1" role="presentation"></a>ساختار سند</h2>

<p>می توانید یک سند HTML را به عنوان مجموعه‌ای از مستطیل‌های تودرتو در نظر بگیرید. برچسب‌هایی مثل <bdo><code>&lt;body&gt;</code></bdo> و <bdo><code>&lt;/body&gt;</code></bdo>، دیگر برچسب‌ها را در بر می گیرند، که خود نیز حاوی برچسب‌های دیگر یا متن می‌باشند. به عنوان مثال، سندی از <a href="13_browser.html">فصل قبل</a> را مشاهده ‌می کنید:</p>

<pre class="snippet cm-s-default" data-language="text/html"  data-sandbox="homepage"><a class="c_ident" id="c_4wSSl86LKl" href="#c_4wSSl86LKl" tabindex="-1" role="presentation"></a><span class="cm-meta">&lt;!doctype html&gt;</span>
<span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">html</span><span class="cm-tag cm-bracket">&gt;</span>
  <span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">head</span><span class="cm-tag cm-bracket">&gt;</span>
    <span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">title</span><span class="cm-tag cm-bracket">&gt;</span>My home page<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">title</span><span class="cm-tag cm-bracket">&gt;</span>
  <span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">head</span><span class="cm-tag cm-bracket">&gt;</span>
  <span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">body</span><span class="cm-tag cm-bracket">&gt;</span>
    <span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">h1</span><span class="cm-tag cm-bracket">&gt;</span>My home page<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">h1</span><span class="cm-tag cm-bracket">&gt;</span>
    <span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">p</span><span class="cm-tag cm-bracket">&gt;</span>Hello, I am Marijn and this is my home page.<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">p</span><span class="cm-tag cm-bracket">&gt;</span>
    <span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">p</span><span class="cm-tag cm-bracket">&gt;</span>I also wrote a book! Read it
      <span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">a</span> <span class="cm-attribute">href</span>=<span class="cm-string">&quot;http://eloquentjavascript.net&quot;</span><span class="cm-tag cm-bracket">&gt;</span>here<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">a</span><span class="cm-tag cm-bracket">&gt;</span>.<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">p</span><span class="cm-tag cm-bracket">&gt;</span>
  <span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">body</span><span class="cm-tag cm-bracket">&gt;</span>
<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">html</span><span class="cm-tag cm-bracket">&gt;</span></pre>

<p>ساختار این صفحه به شکل زیر است:</p><figure><img src="img/html-boxes.svg" alt="HTML document as nested boxes"></figure>

<p><a class="p_ident" id="p_pjDAG8c7k9" href="#p_pjDAG8c7k9" tabindex="-1" role="presentation"></a>ساختار داده‌ای که مرورگر برای نمایش این سند استفاده می کند از این شکل پیروی می کند. برای هر مستطیل، یک شیء وجود دارد، که می توانیم با آن ارتباط برقرار کرده تا چیزهایی مثل برچسب HTML آن یا برچسب‌ها و متونی که دربر دارد را بدست بیاوریم. این طرز نمایش را <em>مدل شیء سند</em> یا به اختصار DOM می گویند.</p>

<p>متغیر سراسری <code>document</code> امکان دسترسی به این اشیاء را فراهم می سازد. خاصیت <code>documentElement</code> آن به شیئی ارجاع می دهد که نمایانگر برچسب <bdo><code>&lt;html&gt;</code></bdo> است. چون هر سند HTML دارای یک سرصفحه و یک بدنه می باشد ، در نتیجه دارای خاصیت‌های <code>head</code> و <code>body</code> نیز می باشد که به آن عناصر اشاره می می‌کنند.</p>

<h2><a class="h_ident" id="h_61lnXO6abr" href="#h_61lnXO6abr" tabindex="-1" role="presentation"></a>درخت‌ها</h2>

<p>کمی به درخت‌های گرامر که در <a href="12_language.html#parsing">فصل 12</a> معرفی شدند فکر کنید. ساختار آن‌ها بسیار شبیه به ساختار یک سند مرورگر است. هر <em>گره</em> ممکن است به دیگر گره‌ها ارجاع دهد، <em>فرزندان</em>، که خود می توانند فرزندان خود را داشته باشند. این شکل یک ساختار تودرتوی معمول است که عناصر در آن می توانند حاوی زیرعنصرهایی مشابه باشند.</p>

<p><a class="p_ident" id="p_Yfb0Ie8yZw" href="#p_Yfb0Ie8yZw" tabindex="-1" role="presentation"></a>یک ساختار داده را درخت می نامیم زمانی که دارای شاخه‌هایی بدون دور است ( یک گره ممکن نیست به شکل￼ مستقیم یا غیر مستقیم حاوی خودش باشد) و دارای یک <em>ریشه</em> مشخص باشد. در رابطه با DOM، ریشه‌ی درخت <bdo><code>document.<wbr>documentElement</code></bdo> است.</p>

<p>درخت‌ها در علم کامپیوتر کاربرد زیادی دارند. علاوه بر نمایش ساختارهای درختی مانند اسناد HTML یا برنامه‌ها، اغلب از آن‌ها برای نگهداری مجموعه‌های مرتب شده‌ی داده استفاده می شود چراکه معمولا ورود یا جستجوی عناصر در یک درخت با کارایی بیشتری نسبت به یک‌ آرایه‌ی تخت انجام می شود.</p>

<p><a class="p_ident" id="p_2qC0ZocETq" href="#p_2qC0ZocETq" tabindex="-1" role="presentation"></a>یک درخت معمول دارای انواع مختلفی از گره‌ها می‌باشد. درخت گرامر <a href="12_language.html">زبان Egg</a> دارای شناسه‌ها، مقادیر، و گره‌های کاربرد (Application) بود. گره‌های کاربرد می توانستند دارای فرزند باشند، درحالیکه شناسه‌ها و مقادیر از جنس <em>برگ</em> بودند؛ منظور گره‌هایی است که فرزندی ندارند.</p>

<p><a class="p_ident" id="p_BPT5caOywU" href="#p_BPT5caOywU" tabindex="-1" role="presentation"></a>همین روال برای DOM هم برقرار است. گره‌ها به عنوان عناصر، که برچسب‌های HTML را نمایش می دهند، ساختار سند را تعیین می کنند. این گره‌ها می توانند گره‌های فرزند داشته باشند. یک نمونه از این نوع گره‌ها <bdo><code>document.body</code></bdo> است. بعضی از این فرزندان می توانند گره‌هایی از نوع برگ باشند، مثل متن‌ها یا گره‌های توضیحات.</p>

<p><a class="p_ident" id="p_4vDbo+rf3M" href="#p_4vDbo+rf3M" tabindex="-1" role="presentation"></a>هر شیء گره‌ی DOM دارای خاصیتی به نام <code>nodeType</code> است که حاوی کدی (عددی) است که نوع آن گره را مشخص می کند. عناصر دارای کد 1 می‌باشند که همچنین به عنوان یک خاصیت ثابت <bdo><code>Node.<wbr>ELEMENT_NODE</code></bdo> نیز تعریف شده است. گره‌های متنی ، که نمایانگر یک قسمت از متن در سند می باشند دارای کد 3 می‌باشند (<bdo><code>Node.TEXT_NODE</code></bdo>). کد 8 نیز به توضیحات اختصاص دارد (<bdo><code>Node.<wbr>COMMENT_NODE</code></bdo>).</p>

<p>یک روش دیگر برای به تصویر کشیدن درخت مربوط به سندمان، شکل زیر است.</p><figure><img src="img/html-tree.svg" alt="HTML document as a tree"></figure>

<p>برگ‌ها، گره‌های متنی هستند و پیکان‌ها نمایانگر روابط والد-فرزندی بین گره‌ها می باشند.</p>

<h2 id="standard"><a class="h_ident" id="h_oM9lfT151A" href="#h_oM9lfT151A" tabindex="-1" role="presentation"></a>استاندارد</h2>

<p><a class="p_ident" id="p_U31P8vW5B+" href="#p_U31P8vW5B+" tabindex="-1" role="presentation"></a>استفاده از کدهای عددی رمزگونه برای نمایش نوع گره‌ها چیزی نیست که در جاوااسکریپت معمول باشد. در ادامه فصل می بینیم که دیگر بخش‌های رابط DOM نیز حسی نامانوس ایجاد می کنند. دلیل آن این است که DOM فقط برای جاوااسکریپت طراحی نشده است. بلکه تلاش شده که رابط آن نسبت به زبان‌ها بی طرف باشد که بتوان از آن در دیگر سیستم‌ها به خوبی استفاده شود – نه فقط در HTML بلکه همچنین برای XML که فرمتی عمومی برای داده‌ها است و گرامری شبیه به HTML دارد.</p>

<p>خوب این زیاد مطلوب نیست. استانداردها اغلب مفید هستند. اما در این مورد خاص، مزیت آن (سازگاری فرا زبانی) آن قدرها قانع کننده نیست. داشتن رابطی که به خوبی با زبانی که استفاده می کنید یکپارچه شود، زمان زیادی برای شما صرفه جویی می کند تا اینکه یک رابط عمومی برای همه‌ی زبان‌ها داشته باشیم.</p>

<p>یک نمونه از این یکپارچگی ضعیف، خاصیت <code>childNodes</code> است که گره‌های عنصر در DOM، حاوی آن می‌باشند. این خاصیت یک شیء آرایه‌طور را نگهداری می کند که خاصیتی به نام <code>length</code> دارد و همچنین خاصیت‌هایی دارد که توسط اعداد برچسب‌گذاری شده اند تا بتوان به گره‌های فرزند دسترسی داشت. اما این یک نمونه از نوع <code>NodeList</code> است نه یک آرایه‌ی واقعی بنابراین متدهای آرایه مثل <code>slice</code> و <code>map</code> را ندارد.</p>

<p>همچنین مشکلاتی وجود دارد که ناشی از طراحی ضعیف است. به عنوان مثال، راهی برای ایجاد یک گره جدید به همراه گره‌های فرزند و خصوصیت‌ها در یک گام وجود ندارد. بلکه باید ابتدا گره را ایجاد کنید، بعد فرزندان و خصوصیت‌ها را یکی پس از دیگری به وسیله اثرات جانبی بسازید. کدهایی که با DOM تعامل زیادی برقرار می‌کنند، معمولا طولانی، تکراری و بدریخت هستند.</p>

<p>اما این ایرادات، مشکلاتی مهلک محسوب نمی شوند. چون جاوااسکریپت این امکان را به ما می دهد که تجریدهای خودمان را بنویسیم، می توان راه‌های بهتری را برای انجام عملیات برنامه‌تان طراحی کنید. خیلی از کتاب‌خانه‌هایی که برای برنامه‌نویسی مرتبط با مرورگر ایجاد شده اند، این ابزار را فراهم می کنند.</p>

<h2><a class="h_ident" id="h_jrjdfj0V6G" href="#h_jrjdfj0V6G" tabindex="-1" role="presentation"></a>حرکت در درخت</h2>

<p>گره‌های DOM حاوی پیوندهای زیادی به دیگر گره‌های نزدیک می‌باشند. نمودار زیر این موضوع را به تصویر می کشد:</p><figure><img src="img/html-links.svg" alt="Links between DOM nodes"></figure>

<p><a class="p_ident" id="p_NWoZK3kTsE" href="#p_NWoZK3kTsE" tabindex="-1" role="presentation"></a>اگرچه این نمودار فقط یک پیوند برای هر نوع نشان می دهد، اما هر گره دارای یک خاصیت به نام <code>parentNode</code> است که به گره‌هایی که بخشی از آن است اشاره می کند. به همین صورت، هر گره‌ی عنصر (گره نوع ‍‍1) دارای یک خاصیت <code>childNodes</code> است که به یک شیء آرایه‌طور اشاره می کند که حاوی فرزندان آن گره می باشد.</p>

<p>در تئوری، می توانید با استفاده از پیوندهای والد و فرزند، به هر جای درخت حرکت کنید. اما جاوااسکریپت پیوندهای مناسب دیگری را در اختیار شما قرار می دهد. خاصیت‌های <code>firstChild</code> و <code>lastChild</code> به اولین و آخرین عنصرهای فرزند اشاره می کنند یا مقدار <code>null</code> را در صورتی که فرزندی نداشته باشد خواهند داشت. به طور مشابه، <code>previousSibling</code> و <code>nextSibling</code> به گره‌های همجوار اشاره می کنند که گره‌هایی هستند که تحت والد مشترکی قرار دارند و درست قبل یا بعد از گره‌ی مورد نظر قرار گرفته اند. برای اولین فرزند، <code>previousSibling</code> برابر با￼ <code>null</code> خواهد بود و برای فرزند آخر، <code>nextSibling</code> برابر <code>null</code> خواهد بود.</p>

<p>همچنین خاصیتی به نام <code>children</code> وجود دارد که شبیه به <code>childeNodes</code> است با این تفاوت که فقط فرزندان نوع عنصر (نوع 1) را شامل می شود نه دیگر انواع گره فرزند. این خاصیت می تواند در زمانی که به گره های متنی نیازی ندارید استفاده شود.</p>

<p>وقتی با یک ساختار داده‌ی تودرتو مثل این ساختار کار می کنید، توابع بازگشتی اغلب مفید هستند. تابع مثال زیر یک سند را برای یافتن گره‌های متنی جستجو می کند که دارای یک رشته‌ی خاص باشند و در صورت پیدا کردن آن مقدار <code>true</code> را برمی گرداند.</p>

<pre id="talksAbout" class="snippet cm-s-default" data-language="javascript"  data-sandbox="homepage"><a class="c_ident" id="c_mDHDYNTxd7" href="#c_mDHDYNTxd7" tabindex="-1" role="presentation"></a><span class="cm-keyword">function</span> <span class="cm-def">talksAbout</span>(<span class="cm-def">node</span>, <span class="cm-def">string</span>) {
  <span class="cm-keyword">if</span> (<span class="cm-variable-2">node</span>.<span class="cm-property">nodeType</span> <span class="cm-operator">==</span> <span class="cm-variable">Node</span>.<span class="cm-property">ELEMENT_NODE</span>) {
    <span class="cm-keyword">for</span> (<span class="cm-keyword">let</span> <span class="cm-def">i</span> <span class="cm-operator">=</span> <span class="cm-number">0</span>; <span class="cm-variable-2">i</span> <span class="cm-operator">&lt;</span> <span class="cm-variable-2">node</span>.<span class="cm-property">childNodes</span>.<span class="cm-property">length</span>; <span class="cm-variable-2">i</span><span class="cm-operator">++</span>) {
      <span class="cm-keyword">if</span> (<span class="cm-variable">talksAbout</span>(<span class="cm-variable-2">node</span>.<span class="cm-property">childNodes</span>[<span class="cm-variable-2">i</span>], <span class="cm-variable-2">string</span>)) {
        <span class="cm-keyword">return</span> <span class="cm-atom">true</span>;
      }
    }
    <span class="cm-keyword">return</span> <span class="cm-atom">false</span>;
  } <span class="cm-keyword">else</span> <span class="cm-keyword">if</span> (<span class="cm-variable-2">node</span>.<span class="cm-property">nodeType</span> <span class="cm-operator">==</span> <span class="cm-variable">Node</span>.<span class="cm-property">TEXT_NODE</span>) {
    <span class="cm-keyword">return</span> <span class="cm-variable-2">node</span>.<span class="cm-property">nodeValue</span>.<span class="cm-property">indexOf</span>(<span class="cm-variable-2">string</span>) <span class="cm-operator">&gt;</span> <span class="cm-operator">-</span><span class="cm-number">1</span>;
  }
}

<span class="cm-variable">console</span>.<span class="cm-property">log</span>(<span class="cm-variable">talksAbout</span>(<span class="cm-variable">document</span>.<span class="cm-property">body</span>, <span class="cm-string">&quot;book&quot;</span>));
<span class="cm-comment">// → true</span></pre>

<p>چون <code>childNodes</code> یک آرایه‌ی واقعی نیست نمی توان برای پیمایش آن از <bdo><code>for</code>/<code>of</code></bdo> استفاده کرد بلکه باید یا از یک حلقه‌ی معولی <code>for</code> بهره برد یا از <bdo><code>Array.from</code></bdo> استفاده نمود.</p>

<p>خاصیت <code>nodeValue</code> یک گره‌ی متنی، حاوی رشته‌ی متنی است که گره نشان می دهد.</p>

<h2><a class="h_ident" id="h_jkfe+D+vyO" href="#h_jkfe+D+vyO" tabindex="-1" role="presentation"></a>پیدا کردن عناصر</h2>

<p>حرکت در طول پیوندها به گره‌های والد، فرزندان و گره‌های همجوار اغلب مفید است. اما اگر بخواهیم یک گره‌ی خاص را در یک سند پیدا کنیم، شروع از <bdo><code>document.body</code></bdo> و پیمایش یک مسیر ثابت از خاصیت‌ها برای یافتن گره، ایده‌ی خوبی نیست. برای این کار نیاز است تا فرض‌هایی درباره‌ی یک ساختار دقیق از سند داشته باشیم – ساختاری که احتمالا قرار است آن را تغییر دهید. یکی دیگر از فاکتورهایی که کار را پیچیده می کند این است که گره‌های متنی برای فضاهای خالی بین گره‌ها هم ایجاد می شوند. مثلا در برچسب <bdo><code>&lt;body&gt;</code></bdo> سند، فقط سه فرزند ندارد (<bdo><code>&lt;h1&gt;</code></bdo> و دو <bdo><code>&lt;p&gt;</code></bdo> ) بلکه در واقع دارای هفت فرزند می‌باشد. آن سه عنصر به همراه فضاهای خالی قبل، بعد و بین‌شان.</p>

<p><a class="p_ident" id="p_Agg/RXngim" href="#p_Agg/RXngim" tabindex="-1" role="presentation"></a>بنابراین اگر بخواهیم خصوصیت <code>href</code> پیوند موجود در سند را به دست بیاوریم، نمی خواهیم دستوری شبیه به ” فرزند دوم ششمین فرزند body سند را به دست بیاور” داشته باشیم. بهتر می بود اگر می توانستیم دستوری شبیه به “اولین لینکی که در سند آمده است را بگیر” داشته باشیم. و می توانیم این کار را بکنیم.</p>

<pre class="snippet cm-s-default" data-language="javascript"  data-sandbox="homepage"><a class="c_ident" id="c_X6zFdF/80F" href="#c_X6zFdF/80F" tabindex="-1" role="presentation"></a><span class="cm-keyword">let</span> <span class="cm-def">link</span> <span class="cm-operator">=</span> <span class="cm-variable">document</span>.<span class="cm-property">body</span>.<span class="cm-property">getElementsByTagName</span>(<span class="cm-string">&quot;a&quot;</span>)[<span class="cm-number">0</span>];
<span class="cm-variable">console</span>.<span class="cm-property">log</span>(<span class="cm-variable">link</span>.<span class="cm-property">href</span>);</pre>

<p>تمامی گره‌های عنصر، دارای متدی به نام <code>getElementsByTagName</code> هستند که تمامی عناصری که برچسب داده شده را دارند و زیرمجموعه‌ی آن گره محسوب می شوند (فرزند مستقیم و غیر مستقیم) را جمع آوری می کند و￼ به صورت یک شیء آرایه‌طور برمی گرداند.</p>

<p>برای یافتن یک گره‌ی خاص <em>واحد</em>، می توانید به آن یک خصوصیت <code>id</code> اختصاص دهید و از <bdo><code>document.<wbr>getElementById</code></bdo> استفاده کنید.</p>

<pre class="snippet cm-s-default" data-language="text/html" ><a class="c_ident" id="c_CpFVpKYjsr" href="#c_CpFVpKYjsr" tabindex="-1" role="presentation"></a><span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">p</span><span class="cm-tag cm-bracket">&gt;</span>My ostrich Gertrude:<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">p</span><span class="cm-tag cm-bracket">&gt;</span>
<span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">p</span><span class="cm-tag cm-bracket">&gt;</span><span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">img</span> <span class="cm-attribute">id</span>=<span class="cm-string">&quot;gertrude&quot;</span> <span class="cm-attribute">src</span>=<span class="cm-string">&quot;img/ostrich.png&quot;</span><span class="cm-tag cm-bracket">&gt;</span><span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">p</span><span class="cm-tag cm-bracket">&gt;</span>

<span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">script</span><span class="cm-tag cm-bracket">&gt;</span>
  <span class="cm-keyword">let</span> <span class="cm-def">ostrich</span> <span class="cm-operator">=</span> <span class="cm-variable">document</span>.<span class="cm-property">getElementById</span>(<span class="cm-string">&quot;gertrude&quot;</span>);
  <span class="cm-variable">console</span>.<span class="cm-property">log</span>(<span class="cm-variable">ostrich</span>.<span class="cm-property">src</span>);
<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">script</span><span class="cm-tag cm-bracket">&gt;</span></pre>

<p>سومین متد که کاری مشابه انجام می دهد <code>getElementsByClassName</code> است که شبیه به <code>getElementsByTagName</code> عمل می کند و در محتوای یک گره‌ی عنصر به جستجو می پردازد و تمامی عناصری که رشته‌ی داده شده را در خصوصیت <code>class</code> شان دارند برمی گرداند.</p>

<h2><a class="h_ident" id="h_mmI08QO0Iz" href="#h_mmI08QO0Iz" tabindex="-1" role="presentation"></a>ایجاد تغییر در سند</h2>

<p>تقریبا تمامی قسمت‌های ساختار داده‌ی DOM را می‌توان تغییر داد. می توان شکل درخت سند را با ایجاد تغییر در روابط والد-فرزندی دستکاری کرد. گره‌ها دارای متدی به نام <code>remove</code> می‌باشند که می توان از آن برای حذف گره از والد کنونی‌اش استفاده نمود. برای افزودن یک گره‌ی فرزند به یک گره‌ی عنصر می‌توانیم از <code>appendChild</code> استفاده کنیم که باعث می شود آن گره به انتهای لیست فرزندان اضافه شود. یا از <code>insertBefore</code> استفاده کنیم که گره‌ای که به عنوان آرگومان اول آمده را قبل از گره‌ای که به عنوان آرگومان دوم آمده است وارد می کند.</p>

<pre class="snippet cm-s-default" data-language="text/html" ><a class="c_ident" id="c_xdAyPFCEJ5" href="#c_xdAyPFCEJ5" tabindex="-1" role="presentation"></a><span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">p</span><span class="cm-tag cm-bracket">&gt;</span>One<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">p</span><span class="cm-tag cm-bracket">&gt;</span>
<span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">p</span><span class="cm-tag cm-bracket">&gt;</span>Two<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">p</span><span class="cm-tag cm-bracket">&gt;</span>
<span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">p</span><span class="cm-tag cm-bracket">&gt;</span>Three<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">p</span><span class="cm-tag cm-bracket">&gt;</span>

<span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">script</span><span class="cm-tag cm-bracket">&gt;</span>
  <span class="cm-keyword">let</span> <span class="cm-def">paragraphs</span> <span class="cm-operator">=</span> <span class="cm-variable">document</span>.<span class="cm-property">body</span>.<span class="cm-property">getElementsByTagName</span>(<span class="cm-string">&quot;p&quot;</span>);
  <span class="cm-variable">document</span>.<span class="cm-property">body</span>.<span class="cm-property">insertBefore</span>(<span class="cm-variable">paragraphs</span>[<span class="cm-number">2</span>], <span class="cm-variable">paragraphs</span>[<span class="cm-number">0</span>]);
<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">script</span><span class="cm-tag cm-bracket">&gt;</span></pre>

<p><a class="p_ident" id="p_sNOF69+xiE" href="#p_sNOF69+xiE" tabindex="-1" role="presentation"></a>یک گره فقط در یک موقعیت از سند می تواند موجودیت داشته باشد. بنابراین، قراردادن پاراگراف <em>3</em> جلوی پاراگراف یک <em>1</em> آن را از انتهای سند حذف می کند و بعد جلو پاراگراف <em>1</em> قرار می دهد که نتیجه به این صورت می شود: <bdo><em>3/2/1</em></bdo>. تمامی عملیاتی که گره‌ای را در جایی قرار می دهد به عنوان یک اثر جانبی موجب می شوند که ابتدا آن گره از جایگاه فعلی‌اش حذف شود (اگر جایی بوده باشد).</p>

<p>متد <code>replaceChild</code> برای جایگزین کردن یک گره‌ی فرزند با گره‌ی فرزندی دیگر استفاده می شود. این متد دو گره به عنوان آرگومان دریافت می کند: گره‌ی جدید و گره‌ای که باید جایگزین شود. گره‌ی جایگزین شده باید فرزند عنصری باشد که متد روی آن فراخوانی شده است. توجه داشته باشید که هر دوی <code>replaceChild</code> و <code>insertBefore</code> به عنوان آرگومان اول گره‌ای <em>جدید</em> دریافت می کنند.</p>

<h2><a class="h_ident" id="h_riRWH0lO2A" href="#h_riRWH0lO2A" tabindex="-1" role="presentation"></a>ایجاد گره‌ها</h2>

<p>فرض کنید می خواهیم اسکریپتی بنویسیم که تمامی عکس‌های موجود در سند (برچسب‌های <bdo><code>&lt;img&gt;</code></bdo>) را با نوشته‌ای که در خصوصیت <code>alt</code> آن قرار دارد جایگزین کند، نوشته‌ای که برای مشخص کردن یک نمایش متنی برای تصویر استفاده می شود.</p>

<p>این کار هم شامل حذف عکس‌ها می شود و هم ایجاد یک گره‌ی متنی جهت جایگزینی عکس. گره‌های متنی توسط <bdo><code>document.<wbr>createTextNode</code></bdo> ایجاد می شوند.</p>

<pre class="snippet cm-s-default" data-language="text/html" ><a class="c_ident" id="c_x13nsyh4X4" href="#c_x13nsyh4X4" tabindex="-1" role="presentation"></a><span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">p</span><span class="cm-tag cm-bracket">&gt;</span>The <span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">img</span> <span class="cm-attribute">src</span>=<span class="cm-string">&quot;img/cat.png&quot;</span> <span class="cm-attribute">alt</span>=<span class="cm-string">&quot;Cat&quot;</span><span class="cm-tag cm-bracket">&gt;</span> in the
  <span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">img</span> <span class="cm-attribute">src</span>=<span class="cm-string">&quot;img/hat.png&quot;</span> <span class="cm-attribute">alt</span>=<span class="cm-string">&quot;Hat&quot;</span><span class="cm-tag cm-bracket">&gt;</span>.<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">p</span><span class="cm-tag cm-bracket">&gt;</span>

<span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">p</span><span class="cm-tag cm-bracket">&gt;</span><span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">button</span> <span class="cm-attribute">onclick</span>=<span class="cm-string">&quot;replaceImages()&quot;</span><span class="cm-tag cm-bracket">&gt;</span>Replace<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">button</span><span class="cm-tag cm-bracket">&gt;</span><span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">p</span><span class="cm-tag cm-bracket">&gt;</span>

<span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">script</span><span class="cm-tag cm-bracket">&gt;</span>
  <span class="cm-keyword">function</span> <span class="cm-def">replaceImages</span>() {
    <span class="cm-keyword">let</span> <span class="cm-def">images</span> <span class="cm-operator">=</span> <span class="cm-variable">document</span>.<span class="cm-property">body</span>.<span class="cm-property">getElementsByTagName</span>(<span class="cm-string">&quot;img&quot;</span>);
    <span class="cm-keyword">for</span> (<span class="cm-keyword">let</span> <span class="cm-def">i</span> <span class="cm-operator">=</span> <span class="cm-variable-2">images</span>.<span class="cm-property">length</span> <span class="cm-operator">-</span> <span class="cm-number">1</span>; <span class="cm-variable-2">i</span> <span class="cm-operator">&gt;=</span> <span class="cm-number">0</span>; <span class="cm-variable-2">i</span><span class="cm-operator">--</span>) {
      <span class="cm-keyword">let</span> <span class="cm-def">image</span> <span class="cm-operator">=</span> <span class="cm-variable-2">images</span>[<span class="cm-variable-2">i</span>];
      <span class="cm-keyword">if</span> (<span class="cm-variable-2">image</span>.<span class="cm-property">alt</span>) {
        <span class="cm-keyword">let</span> <span class="cm-def">text</span> <span class="cm-operator">=</span> <span class="cm-variable">document</span>.<span class="cm-property">createTextNode</span>(<span class="cm-variable-2">image</span>.<span class="cm-property">alt</span>);
        <span class="cm-variable-2">image</span>.<span class="cm-property">parentNode</span>.<span class="cm-property">replaceChild</span>(<span class="cm-variable-2">text</span>, <span class="cm-variable-2">image</span>);
      }
    }
  }
<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">script</span><span class="cm-tag cm-bracket">&gt;</span></pre>

<p>با دادن یک رشته، تابع <code>createTextNode</code> به ما یک گره‌ی متنی تحویل می دهد که می توانیم آن را در سند قرار داده تا در صفحه نمایش نشان داده شود.</p>

<p><a class="p_ident" id="p_pD/MhHwik3" href="#p_pD/MhHwik3" tabindex="-1" role="presentation"></a>حلقه‌ای که عکس‌ها را پیمایش می کند از پایان لیست کارش را شروع می کند. این کار لازم است چرا که لیست گره‌ها که توسط متدی مثل <code>getElementsByTagName</code> برگردانده می شود ( یا خاصیتی مثل <code>childNodes</code>)، لیستی زنده است. به این معنا که با تغییر سند، لیست هم به‌روز می شود. اگر از ابتدا شروع می کردیم، حذف اولین عکس ممکن بود باعث شود لیست اولین عنصرش را از دست بدهد که در این صورت با تکرار حلقه در بار دوم ، زمانی که <code>i</code> برابر 1 می شود، از کار می ایستاد زیرا طول مجموعه اکنون برابر 1 است.</p>

<p>اگر یک مجموعه‌ی ثابت از گره‌ها را لازم دارید، به‌جای یک مجموعه‌ی زنده از آن ها، می توانید مجموعه را با فراخوانی <bdo><code>Array.from</code></bdo> به یک آرایه‌ی واقعی تبدیل کنید.</p>

<pre class="snippet cm-s-default" data-language="javascript" ><a class="c_ident" id="c_YYMkVyoN/K" href="#c_YYMkVyoN/K" tabindex="-1" role="presentation"></a><span class="cm-keyword">let</span> <span class="cm-def">arrayish</span> <span class="cm-operator">=</span> {<span class="cm-number cm-property">0</span>: <span class="cm-string">&quot;one&quot;</span>, <span class="cm-number cm-property">1</span>: <span class="cm-string">&quot;two&quot;</span>, <span class="cm-property">length</span>: <span class="cm-number">2</span>};
<span class="cm-keyword">let</span> <span class="cm-def">array</span> <span class="cm-operator">=</span> <span class="cm-variable">Array</span>.<span class="cm-property">from</span>(<span class="cm-variable">arrayish</span>);
<span class="cm-variable">console</span>.<span class="cm-property">log</span>(<span class="cm-variable">array</span>.<span class="cm-property">map</span>(<span class="cm-def">s</span> <span class="cm-operator">=&gt;</span> <span class="cm-variable-2">s</span>.<span class="cm-property">toUpperCase</span>()));
<span class="cm-comment">// → [&quot;ONE&quot;, &quot;TWO&quot;]</span></pre>

<p>برای ایجاد گره‌های عنصر، می توانید از متد <bdo><code>document.<wbr>createElement</code></bdo> استفاده کنید. این متد یک نام برچسب گرفته و یک گره‌ی تهی از نوع داده شده را بر می گرداند.</p>

<p id="elt">در مثال پیش رو یک تابع کاربردی به نام <code>elt</code> ایجاد می شود که یک گره‌ی عنصر را ایجاد کرده و دیگر آرگومان‌هایش را به عنوان فرزندان آن گره در نظر می گیرد. در ادامه از همین تابع برای افزودن یک خصوصیت به یک برچسب نقل قول استفاده می‌شود.</p>

<pre class="snippet cm-s-default" data-language="text/html" ><a class="c_ident" id="c_3rSOndXJQI" href="#c_3rSOndXJQI" tabindex="-1" role="presentation"></a><span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">blockquote</span> <span class="cm-attribute">id</span>=<span class="cm-string">&quot;quote&quot;</span><span class="cm-tag cm-bracket">&gt;</span>
  No book can ever be finished. While working on it we learn
  just enough to find it immature the moment we turn away
  from it.
<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">blockquote</span><span class="cm-tag cm-bracket">&gt;</span>

<span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">script</span><span class="cm-tag cm-bracket">&gt;</span>
  <span class="cm-keyword">function</span> <span class="cm-def">elt</span>(<span class="cm-def">type</span>, <span class="cm-meta">...</span><span class="cm-def">children</span>) {
    <span class="cm-keyword">let</span> <span class="cm-def">node</span> <span class="cm-operator">=</span> <span class="cm-variable">document</span>.<span class="cm-property">createElement</span>(<span class="cm-variable-2">type</span>);
    <span class="cm-keyword">for</span> (<span class="cm-keyword">let</span> <span class="cm-def">child</span> <span class="cm-keyword">of</span> <span class="cm-variable-2">children</span>) {
      <span class="cm-keyword">if</span> (<span class="cm-keyword">typeof</span> <span class="cm-variable-2">child</span> <span class="cm-operator">!=</span> <span class="cm-string">&quot;string&quot;</span>) <span class="cm-variable-2">node</span>.<span class="cm-property">appendChild</span>(<span class="cm-variable-2">child</span>);
      <span class="cm-keyword">else</span> <span class="cm-variable-2">node</span>.<span class="cm-property">appendChild</span>(<span class="cm-variable">document</span>.<span class="cm-property">createTextNode</span>(<span class="cm-variable-2">child</span>));
    }
    <span class="cm-keyword">return</span> <span class="cm-variable-2">node</span>;
  }

  <span class="cm-variable">document</span>.<span class="cm-property">getElementById</span>(<span class="cm-string">&quot;quote&quot;</span>).<span class="cm-property">appendChild</span>(
    <span class="cm-variable">elt</span>(<span class="cm-string">&quot;footer&quot;</span>, <span class="cm-string">&quot;—&quot;</span>,
        <span class="cm-variable">elt</span>(<span class="cm-string">&quot;strong&quot;</span>, <span class="cm-string">&quot;Karl Popper&quot;</span>),
        <span class="cm-string">&quot;, preface to the second editon of &quot;</span>,
        <span class="cm-variable">elt</span>(<span class="cm-string">&quot;em&quot;</span>, <span class="cm-string">&quot;The Open Society and Its Enemies&quot;</span>),
        <span class="cm-string">&quot;, 1950&quot;</span>));
<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">script</span><span class="cm-tag cm-bracket">&gt;</span></pre>

<h2><a class="h_ident" id="h_O0wNoz3KxF" href="#h_O0wNoz3KxF" tabindex="-1" role="presentation"></a>خصوصیت‌ها</h2>

<p>بعضی از خصوصیت‌های عناصر مثل <code>href</code> برای پیوندها را می توان به عنوان خاصیتی با همین نام روی شیء DOM عنصر، مورد دستیابی قرار داد. این برای بیشتر خصوصیت‌های استاندارد رایج، برقرار است.</p>

<p>اما HTML این امکان را فراهم کرده است که هر خصوصیتی که بخواهید را به گره‌ها اضافه کنید. این امکان می‌تواند مفید باشد زیرا به شما اجازه می دهد اطلاعات بیشتری را در یک سند ذخیره کنید. با این وجود اگر نام خصوصیت‌های خودتان را بسازید، این خصوصیت‌ها به عنوان خاصیت شیء گره در دسترس نخواهند بود. برای کار با آن ها باید از متدهای <code>getAttribute</code> و <code>setAttribute</code> استفاده کنید.</p>

<pre class="snippet cm-s-default" data-language="text/html" ><a class="c_ident" id="c_S977zg3XyT" href="#c_S977zg3XyT" tabindex="-1" role="presentation"></a><span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">p</span> <span class="cm-attribute">data-classified</span>=<span class="cm-string">&quot;secret&quot;</span><span class="cm-tag cm-bracket">&gt;</span>The launch code is 00000000.<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">p</span><span class="cm-tag cm-bracket">&gt;</span>
<span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">p</span> <span class="cm-attribute">data-classified</span>=<span class="cm-string">&quot;unclassified&quot;</span><span class="cm-tag cm-bracket">&gt;</span>I have two feet.<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">p</span><span class="cm-tag cm-bracket">&gt;</span>

<span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">script</span><span class="cm-tag cm-bracket">&gt;</span>
  <span class="cm-keyword">let</span> <span class="cm-def">paras</span> <span class="cm-operator">=</span> <span class="cm-variable">document</span>.<span class="cm-property">body</span>.<span class="cm-property">getElementsByTagName</span>(<span class="cm-string">&quot;p&quot;</span>);
  <span class="cm-keyword">for</span> (<span class="cm-keyword">let</span> <span class="cm-def">para</span> <span class="cm-keyword">of</span> <span class="cm-variable">Array</span>.<span class="cm-property">from</span>(<span class="cm-variable">paras</span>)) {
    <span class="cm-keyword">if</span> (<span class="cm-variable">para</span>.<span class="cm-property">getAttribute</span>(<span class="cm-string">&quot;data-classified&quot;</span>) <span class="cm-operator">==</span> <span class="cm-string">&quot;secret&quot;</span>) {
      <span class="cm-variable">para</span>.<span class="cm-property">remove</span>();
    }
  }
<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">script</span><span class="cm-tag cm-bracket">&gt;</span></pre>

<p>توصیه شده که نام این گونه‌ خصوصیت‌های ساختگی را با پیشوند <bdo><code>data-</code></bdo> آغاز کنید تا مطمئن شوید که تداخلی با دیگر خصوصیت‌ها پیش نخواهد آمد.</p>

<p>خصوصیت <code>class</code> که یکی از خصوصیت‌های رایج است، یک کلیدواژه در جاوااسکریپت محسوب می شود. به دلایل تاریخی – بعضی از پیاده‌سازی‌های قدیمی جاوااسکریپت نمی توانستند نام‌های خاصیتی که با کلیدواژه‌ها مطابقت داشتند را مدیریت کنند – خاصیتی که برای دسترسی به این خصوصیت در نظر گرفته شده است <code>className</code> است. همچنین می توانید تحت نام واقعی خودش <code>&quot;class&quot;</code> نیز به وسیله‌ی متدهای <code>getAttribute</code> و <code>setAttribute</code> به آن دسترسی داشته باشید.</p>

<h2><a class="h_ident" id="h_AvxsvFKyUv" href="#h_AvxsvFKyUv" tabindex="-1" role="presentation"></a>طرح‌بندی (layout)</h2>

<p><a class="p_ident" id="p_bpk35930LG" href="#p_bpk35930LG" tabindex="-1" role="presentation"></a>ممکن است متوجه شده باشید که انواع مختلف عنصرها به صورت متفاوتی طرح بندی می شوند. بعضی مانند پاراگراف ها (<bdo><code>&lt;p&gt;</code></bdo>) یا سرعنوان‌ها (<code>&lt;h1&gt;</code>)، تمامی عرض سند را اشغال کرده و هر کدام در خط جدیدی به نمایش در می‌آیند. این عناصر، عناصر بلاک نامیده می شوند. دیگر عناصر، مثل پیوندها (<code>&lt;a&gt;</code>) یا عنصر <bdo><code>&lt;strong&gt;</code></bdo> در همان خط کنار متن پیرامونشان نمایش داده می شوند. این عنصرها را عناصر درون خطی (inline) می نامند.</p>

<p>برای هر سند داده شده، مرورگرها می‌توانند با درنظر گرفتن موقعیت و اندازه‌ی هر عنصر، یک طرح را محاسبه کنند. این طرح بعد برای به تصویر کشیدن سند استفاده می شود.</p>

<p>اندازه و موقعیت یک عنصر را می توان از طریق جاوااسکریپت به دست آورد. خاصیت‌های <code>offsetWidth</code> و <code>offsetHeight</code> فضایی که یک عنصر اشغال می کند را در واحد <em>پیکسل</em> نشان می دهند. یک پیکسل واحد بنیادی اندازه‌گیری در مرورگر است. به طور سنتی این واحد به کوچکترین نقطه‌ای که صفحه‌نمایش می تواند به تصویر بکشد مرتبط است اما در مانیتورهای مدرن، که قادرند نقطه‌های <em>خیلی</em> کوچک را به تصویر بکشند، دیگر موضوعیت￼ ندارد و یک پیکسل مرورگر ممکن است چند نقطه‌ را در صفحه نمایش پوشش دهد.</p>

<p><a class="p_ident" id="p_ymvNS28/qS" href="#p_ymvNS28/qS" tabindex="-1" role="presentation"></a>به طور مشابه، <code>clientWidth</code> و <code>clientHeight</code> به شما اندازه‌ی فضای <em>درون</em> یک عنصر را نشان می دهد و عرض خط مرزی (border) در نظر گرفته نمی شود.</p>

<pre class="snippet cm-s-default" data-language="text/html" ><a class="c_ident" id="c_E5M9cwi2qC" href="#c_E5M9cwi2qC" tabindex="-1" role="presentation"></a><span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">p</span> <span class="cm-attribute">style</span>=<span class="cm-string">&quot;border: 3px solid red&quot;</span><span class="cm-tag cm-bracket">&gt;</span>
  I'm boxed in
<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">p</span><span class="cm-tag cm-bracket">&gt;</span>

<span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">script</span><span class="cm-tag cm-bracket">&gt;</span>
  <span class="cm-keyword">let</span> <span class="cm-def">para</span> <span class="cm-operator">=</span> <span class="cm-variable">document</span>.<span class="cm-property">body</span>.<span class="cm-property">getElementsByTagName</span>(<span class="cm-string">&quot;p&quot;</span>)[<span class="cm-number">0</span>];
  <span class="cm-variable">console</span>.<span class="cm-property">log</span>(<span class="cm-string">&quot;clientHeight:&quot;</span>, <span class="cm-variable">para</span>.<span class="cm-property">clientHeight</span>);
  <span class="cm-variable">console</span>.<span class="cm-property">log</span>(<span class="cm-string">&quot;offsetHeight:&quot;</span>, <span class="cm-variable">para</span>.<span class="cm-property">offsetHeight</span>);
<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">script</span><span class="cm-tag cm-bracket">&gt;</span></pre>

<p id="boundingRect">موثرترین روش برای بدست آوردن موقعیت دقیق یک عنصر روی صفحه‌ی نمایش، استفاده از متد <code>getBoundingClientRect</code> است. این متد یک شیء بر می گرداند که شامل خاصیت‌های <code>top</code>، <code>bottom</code>، <code>left</code> و <code>right</code> می باشد که مشخص می کنند موقعیت هر ضلع یک عنصر به نسبت بالا و چپ صفحه‌نمایش چند پیکسل است. اگر این اعداد را نسبت به کل سند لازم دارید، بایستی موقعیت اسکرول فعلی را به آن اضافه کنید. این موقعیت را می می‌توان در متغیرهای <code>pageXOffset</code> و <code>pageYOffset</code> بدست آورد.</p>

<p>طرح بندی یک سند می تواند کار زیادی ببرد. برای اعمال سرعت بیشتر، موتور مروگر با هر بار تغییر در سند آن را دوباره طرح بندی نمی کند بلکه تا زمانی که بتواند آن را به تاخیر می اندازد .زمانی که برنامه‌ی جاوااسکریپت که سند را تغییر داده است به پایان اجرایش برسد، مرورگر بایستی یک طرح جدید محاسبه کند تا بتواند سند تغییریافته را به تصویر بکشد. زمانی که یک برنامه موقعیت یا اندازه‌ی چیزی را با خواندن خاصیت‌هایی مثل <code>offsetHeight</code> یا فراخوانی <code>getBoundingClientRect</code> درخواست می کند، فراهم ساختن اطلاعات صحیح نیز نیاز به محاسبه‌ی طرح دارد.</p>

<p><a class="p_ident" id="p_8iX6WJG+D2" href="#p_8iX6WJG+D2" tabindex="-1" role="presentation"></a>برنامه‌ای که زیاد و به تکرار به خواندن اطلاعات طرح DOM و تغییر DOM می پردازد باعث می شود که محاسبات طرح‌بندی زیاد اتفاق بیفتد که در نتیجه این برنامه به کندی اجرا خواهد شد. کد پیش رو مثالی از این گونه برنامه است. این مثال از دو برنامه تشکیل یافته است که خطی از کاراکترهای <em>X</em> با پهنای <bdo>2,000</bdo> پیکسل می سازند و زمانی که هرکدام طول می کشد را محاسبه می کنند.</p>

<pre class="snippet cm-s-default" data-language="text/html" ><a class="c_ident" id="c_Mmn5ZrRT52" href="#c_Mmn5ZrRT52" tabindex="-1" role="presentation"></a><span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">p</span><span class="cm-tag cm-bracket">&gt;</span><span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">span</span> <span class="cm-attribute">id</span>=<span class="cm-string">&quot;one&quot;</span><span class="cm-tag cm-bracket">&gt;</span><span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">span</span><span class="cm-tag cm-bracket">&gt;</span><span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">p</span><span class="cm-tag cm-bracket">&gt;</span>
<span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">p</span><span class="cm-tag cm-bracket">&gt;</span><span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">span</span> <span class="cm-attribute">id</span>=<span class="cm-string">&quot;two&quot;</span><span class="cm-tag cm-bracket">&gt;</span><span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">span</span><span class="cm-tag cm-bracket">&gt;</span><span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">p</span><span class="cm-tag cm-bracket">&gt;</span>

<span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">script</span><span class="cm-tag cm-bracket">&gt;</span>
  <span class="cm-keyword">function</span> <span class="cm-def">time</span>(<span class="cm-def">name</span>, <span class="cm-def">action</span>) {
    <span class="cm-keyword">let</span> <span class="cm-def">start</span> <span class="cm-operator">=</span> <span class="cm-variable">Date</span>.<span class="cm-property">now</span>(); <span class="cm-comment">// Current time in milliseconds</span>
    <span class="cm-variable-2">action</span>();
    <span class="cm-variable">console</span>.<span class="cm-property">log</span>(<span class="cm-variable-2">name</span>, <span class="cm-string">&quot;took&quot;</span>, <span class="cm-variable">Date</span>.<span class="cm-property">now</span>() <span class="cm-operator">-</span> <span class="cm-variable-2">start</span>, <span class="cm-string">&quot;ms&quot;</span>);
  }

  <span class="cm-variable">time</span>(<span class="cm-string">&quot;naive&quot;</span>, () <span class="cm-operator">=&gt;</span> {
    <span class="cm-keyword">let</span> <span class="cm-def">target</span> <span class="cm-operator">=</span> <span class="cm-variable">document</span>.<span class="cm-property">getElementById</span>(<span class="cm-string">&quot;one&quot;</span>);
    <span class="cm-keyword">while</span> (<span class="cm-variable-2">target</span>.<span class="cm-property">offsetWidth</span> <span class="cm-operator">&lt;</span> <span class="cm-number">2000</span>) {
      <span class="cm-variable-2">target</span>.<span class="cm-property">appendChild</span>(<span class="cm-variable">document</span>.<span class="cm-property">createTextNode</span>(<span class="cm-string">&quot;X&quot;</span>));
    }
  });
  <span class="cm-comment">// → naive took 32 ms</span>

  <span class="cm-variable">time</span>(<span class="cm-string">&quot;clever&quot;</span>, <span class="cm-keyword">function</span>() {
    <span class="cm-keyword">let</span> <span class="cm-def">target</span> <span class="cm-operator">=</span> <span class="cm-variable">document</span>.<span class="cm-property">getElementById</span>(<span class="cm-string">&quot;two&quot;</span>);
    <span class="cm-variable-2">target</span>.<span class="cm-property">appendChild</span>(<span class="cm-variable">document</span>.<span class="cm-property">createTextNode</span>(<span class="cm-string">&quot;XXXXX&quot;</span>));
    <span class="cm-keyword">let</span> <span class="cm-def">total</span> <span class="cm-operator">=</span> <span class="cm-variable">Math</span>.<span class="cm-property">ceil</span>(<span class="cm-number">2000</span> <span class="cm-operator">/</span> (<span class="cm-variable-2">target</span>.<span class="cm-property">offsetWidth</span> <span class="cm-operator">/</span> <span class="cm-number">5</span>));
    <span class="cm-variable-2">target</span>.<span class="cm-property">firstChild</span>.<span class="cm-property">nodeValue</span> <span class="cm-operator">=</span> <span class="cm-string">&quot;X&quot;</span>.<span class="cm-property">repeat</span>(<span class="cm-variable-2">total</span>);
  });
  <span class="cm-comment">// → clever took 1 ms</span>
<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">script</span><span class="cm-tag cm-bracket">&gt;</span></pre>

<h2><a class="h_ident" id="h_HCjm+UpXpb" href="#h_HCjm+UpXpb" tabindex="-1" role="presentation"></a>سبک دهی</h2>

<p><a class="p_ident" id="p_DZMJ1GOqkX" href="#p_DZMJ1GOqkX" tabindex="-1" role="presentation"></a>تاکنون دیده‌ایم که عناصر مختلف HTML به شکل متفاوتی به تصویر کشیده می‌شوند. بعضی به عنوان بلاک و بعضی درون‌خطی (inline) نشان داده می شوند. بعضی سبک بصری اضافه می کنند – <code>&lt;strong&gt;</code> محتوایش را توپر می کند و <code>&lt;a&gt;</code> محتوایش را آبی رنگ و زیر آن خط می اندازد.</p>

<p>شیوه‌ای که یک برچسب <code>&lt;img&gt;</code> تصویر را نمایش می دهد یا یک برچسب <code>&lt;a&gt;</code> متنی را به یک لینک تبدیل می‌کند، به طور کامل به نوع آن عنصر وابسته است. اما سبک بصری‌ای که به صورت پیش‌فرض به یک عنصر اضافه می شود، مثل رنگ متن یا داشتن زیرخط، را می توانیم تغییر دهیم. در اینجا مثالی که از خصوصیت <code>style</code> استفاده می کند را می بینیم.</p>

<pre class="snippet cm-s-default" data-language="text/html" ><a class="c_ident" id="c_Qie8s1kOFZ" href="#c_Qie8s1kOFZ" tabindex="-1" role="presentation"></a><span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">p</span><span class="cm-tag cm-bracket">&gt;</span><span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">a</span> <span class="cm-attribute">href</span>=<span class="cm-string">&quot;.&quot;</span><span class="cm-tag cm-bracket">&gt;</span>Normal link<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">a</span><span class="cm-tag cm-bracket">&gt;</span><span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">p</span><span class="cm-tag cm-bracket">&gt;</span>
<span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">p</span><span class="cm-tag cm-bracket">&gt;</span><span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">a</span> <span class="cm-attribute">href</span>=<span class="cm-string">&quot;.&quot;</span> <span class="cm-attribute">style</span>=<span class="cm-string">&quot;color: green&quot;</span><span class="cm-tag cm-bracket">&gt;</span>Green link<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">a</span><span class="cm-tag cm-bracket">&gt;</span><span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">p</span><span class="cm-tag cm-bracket">&gt;</span></pre>

<p><a class="p_ident" id="p_JuyNAPtrVU" href="#p_JuyNAPtrVU" tabindex="-1" role="presentation"></a>یک خصوصیت style می تواند حاوی یک یا چند <em>اعلان</em> باشد که شامل یک خاصیت (مثل <code>color</code>) که به همراه دونقطه و مقدارش می‌آید. زمانی که بیش از یک اعلان وجود دارد، باید هر اعلان با یک نقطه‌ویرگول جدا شود مثل <bdo><code>&quot;color: red; border: none&quot;</code></bdo>.</p>

<p>خیلی از جنبه‌های مربوط به سند وجود دارند که می توانند توسط سبک‌دهی تاثیر بپذیرند. به عنوان مثال خاصیت <code>display</code> برای کنترل نحوه‌ی نمایش یک عنصر به صورت درون‌خطی یا بلاک استفاده می شود.</p>

<pre class="snippet cm-s-default" data-language="text/html" ><a class="c_ident" id="c_NN8SrlwTXB" href="#c_NN8SrlwTXB" tabindex="-1" role="presentation"></a>This text is displayed <span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">strong</span><span class="cm-tag cm-bracket">&gt;</span>inline<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">strong</span><span class="cm-tag cm-bracket">&gt;</span>,
<span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">strong</span> <span class="cm-attribute">style</span>=<span class="cm-string">&quot;display: block&quot;</span><span class="cm-tag cm-bracket">&gt;</span>as a block<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">strong</span><span class="cm-tag cm-bracket">&gt;</span>, and
<span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">strong</span> <span class="cm-attribute">style</span>=<span class="cm-string">&quot;display: none&quot;</span><span class="cm-tag cm-bracket">&gt;</span>not at all<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">strong</span><span class="cm-tag cm-bracket">&gt;</span>.</pre>

<p>برچسب <code>block</code> در خط خودش به پایان می رسد به دلیل اینکه عناصر بلاکی به صورت درون خطی کنار متن پیرامونشان نشان داده نمی شوند. برچسب آخر اصلا نمایش داده نمی شود – <bdo><code>display: none</code></bdo> مانع از نمایش یک عنصر در صفحه‌ی نمایش می شود. این روشی برای مخفی کردن عناصر است. معمولا ترجیح داده می شود بجای حذف کامل یک عنصر از سند، از این روش استفاده شود به دلیل این که بازگرداندن آن در آینده در این روش آسان تر است.</p>

<p>کدهای جاوااسکریپت می توانند مستقیما سبک‌دهی یک عنصر را با استفاده از خاصیت <code>style</code> دستکاری کنند. این￼ خاصیت شیءای را نگهداری می کند که خاصیت‌هایی برای همه‌ی ویژگی‌های سبک‌دهی دارد. مقدار این خاصیت‌ها از نوع رشته است که می توانیم برای تغییر یک جنبه‌ی خاص از سبک بصری عنصر مورد نظر آن را بنویسیم.</p>

<pre class="snippet cm-s-default" data-language="text/html" ><a class="c_ident" id="c_WtWpdICuOL" href="#c_WtWpdICuOL" tabindex="-1" role="presentation"></a><span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">p</span> <span class="cm-attribute">id</span>=<span class="cm-string">&quot;para&quot;</span> <span class="cm-attribute">style</span>=<span class="cm-string">&quot;color: purple&quot;</span><span class="cm-tag cm-bracket">&gt;</span>
  Nice text
<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">p</span><span class="cm-tag cm-bracket">&gt;</span>

<span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">script</span><span class="cm-tag cm-bracket">&gt;</span>
  <span class="cm-keyword">let</span> <span class="cm-def">para</span> <span class="cm-operator">=</span> <span class="cm-variable">document</span>.<span class="cm-property">getElementById</span>(<span class="cm-string">&quot;para&quot;</span>);
  <span class="cm-variable">console</span>.<span class="cm-property">log</span>(<span class="cm-variable">para</span>.<span class="cm-property">style</span>.<span class="cm-property">color</span>);
  <span class="cm-variable">para</span>.<span class="cm-property">style</span>.<span class="cm-property">color</span> <span class="cm-operator">=</span> <span class="cm-string">&quot;magenta&quot;</span>;
<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">script</span><span class="cm-tag cm-bracket">&gt;</span></pre>

<p>نام بعضی از خاصیت‌های سبک‌دهی حاوی کاراکتر <bdo>خط پیوند (-)</bdo> است مانند <bdo><code>font-family</code></bdo>. به دلیل این که کار با این نوع نام ها در جاوااسکریپت کمی دشوار است (برای دسترسی باید چیزی مثل <bdo><code>style[&quot;font-family&quot;]</code></bdo> داشته باشید)، نام خاصیت‌های این گونه نام‌ها در شیء <code>style</code> آن خط پیوند را حذف کرده و حرف بعد از آن را با حروف بزرگ می نویسند <bdo>(<code>style.fontFamily</code>)</bdo>.</p>

<h2><a class="h_ident" id="h_tSG6LG86on" href="#h_tSG6LG86on" tabindex="-1" role="presentation"></a>سبک‌های آبشاری</h2>

<p><a class="p_ident" id="p_FyNdvsEP0m" href="#p_FyNdvsEP0m" tabindex="-1" role="presentation"></a>سیستم سبک‌دهی بصری برای HTML را CSS می نامند که مخفف برگه‌های سبک آبشاری یا سلسله‌مراتبی (cascading style sheets) است. یک برگه‌ی سبک به مجموعه‌ای از دستورات گفته می شود که برای سبک‌دهی ظاهری به عناصر یک سند استفاده می شوند. می توان آن را درون یک جفت برچسب <bdo><code>&lt;style&gt;</code></bdo> قرار داد.</p>

<pre class="snippet cm-s-default" data-language="text/html" ><a class="c_ident" id="c_WnNZqmUMzQ" href="#c_WnNZqmUMzQ" tabindex="-1" role="presentation"></a><span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">style</span><span class="cm-tag cm-bracket">&gt;</span>
  <span class="cm-tag">strong</span> {
    <span class="cm-property">font-style</span>: <span class="cm-atom">italic</span>;
    <span class="cm-property">color</span>: <span class="cm-keyword">gray</span>;
  }
<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">style</span><span class="cm-tag cm-bracket">&gt;</span>
<span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">p</span><span class="cm-tag cm-bracket">&gt;</span>Now <span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">strong</span><span class="cm-tag cm-bracket">&gt;</span>strong text<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">strong</span><span class="cm-tag cm-bracket">&gt;</span> is italic and gray.<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">p</span><span class="cm-tag cm-bracket">&gt;</span></pre>

<p>معنای <em>آبشاری</em> این است که قوانینی با سلسله‌مراتب با هم ترکیب می شوند تا سبک نهایی را برای یک عنصر تولید کنند. در مثال بالا، سبک پیش‌فرض برای برچسب‌های <bdo><code>&lt;strong&gt;</code></bdo>، که در آن <bdo><code>font-weight: bold</code></bdo> تعریف شده بود، توسط دستوری دیگر که در برچسب <code>&lt;style&gt;</code> آمده است تغییر یافته و <bdo><code>font-style</code></bdo> و <code>color</code> به آن اضافه شده است.</p>

<p>وقتی چندین دستور یک مقدار را برای یک خاصیت واحد تعریف می کنند، آخرین دستوری که خوانده شود دارای حق تقدم بالاتری خواهد بود و اعمال می شود. بنابراین اگر دستوری که در برچسب <bdo><code>&lt;style&gt;</code></bdo> آمده است <bdo><code>font-weight: normal</code></bdo> را داشته باشد، دستور پیش‌فرض <bdo><code>font-weight</code></bdo> در نظر گرفته نمی شود و متن به شکل نرمال نمایش داده می شود نه به صورت توپر. دستوراتی که در خصوصیت <code>style</code> به صورت مستقیم به یک گره اعمال می شوند دارای بالاترین حق تقدم هستند و همیشه در سلسله‌مراتب برنده می شوند.</p>

<p><a class="p_ident" id="p_vFS2daQmbc" href="#p_vFS2daQmbc" tabindex="-1" role="presentation"></a>می توان چیزهایی بجز نام برچسب‌ها را در دستورات CSS مورد هدف قرار داد. دستوری به شکل <bdo><code>.abc</code></bdo>، به همه‌ی عناصری که خصوصیت classشان دارای مقدار <code>&quot;abc&quot;</code> است اعمال می شود. دستوری به شکل <bdo><code>#xyz</code></bdo> به عنصری اعمال می شود که خصوصیت <code>id</code> آن برابر <code>&quot;xyz&quot;</code> باشد (که باید در سند منحصر به فرد باشد).</p>

<pre class="snippet cm-s-default" data-language="text/css" ><a class="c_ident" id="c_0kqCdknBKh" href="#c_0kqCdknBKh" tabindex="-1" role="presentation"></a><span class="cm-qualifier">.subtle</span> {
  <span class="cm-property">color</span>: <span class="cm-keyword">gray</span>;
  <span class="cm-property">font-size</span>: <span class="cm-number">80%</span>;
}
<span class="cm-builtin">#header</span> {
  <span class="cm-property">background</span>: <span class="cm-keyword">blue</span>;
  <span class="cm-property">color</span>: <span class="cm-keyword">white</span>;
}
<span class="cm-comment">/* p elements with id main and with classes a and b */</span>
<span class="cm-tag">p</span><span class="cm-builtin">#main</span><span class="cm-qualifier">.a</span><span class="cm-qualifier">.b</span> {
  <span class="cm-property">margin-bottom</span>: <span class="cm-number">20px</span>;
}</pre>

<p><a class="p_ident" id="p_bUnjoivX3+" href="#p_bUnjoivX3+" tabindex="-1" role="presentation"></a>قاعده‌ی حق تقدمی که موجب می‌شد دستوری که آخر تعریف شده بود اعمال شود، زمانی موثر است که دستورات دارای specificity (درجه‌ی صراحت) یکسانی باشند. درجه‌ی صراحت یک دستور، معیاری از میزان دقتی است که آن دستور، عناصر هدفش را توصیف می کند که توسط عدد و نوع (برچسب، class و ID) عناصر مورد هدف تعیین می شود. به عنوان مثال، دستوری که <bdo><code>p.a</code></bdo> را هدف قرار می دهد دارای صراحت بیشتری از دستوراتی است که <code>p</code> یا فقط <bdo><code>.a</code></bdo> را هدف قرار می دهند و بنابراین حق تقدم بیشتری خواهد داشت.</p>

<p>دستوری به شکل <bdo><code>p &gt; a {…}</code></bdo> سبک‌های تعریف شده را به همه‌ی برچسب‌های <code>&lt;a&gt;</code> که فرزند مستقیم برچسب‌های <code>&lt;p&gt;</code> محسوب می شوند اعمال می کند. به طور مشابه، <bdo><code>p a {…}</code></bdo> به همه‌ی برچسب‌های <code>&lt;a&gt;</code> که درون برچسب‌های <code>&lt;p&gt;</code> باشند اعمال می شود فارغ از اینکه فرزند مستقیم یا غیر مستقیم باشند.</p>

<h2><a class="h_ident" id="h_KjINefn2Lo" href="#h_KjINefn2Lo" tabindex="-1" role="presentation"></a>گزینشگرهای پرس و جو</h2>

<p>ما در این کتاب زیاد از برگه‌های سبک‌دهی استفاده نخواهیم کرد. درک آن ها برای برنامه‌نویسی در مرورگر مفید است اما دامنه‌ی بحث در باره‌ی سبک‌دهی به اندازه‌ای گسترده می‌باشد که نیاز به کتاب مجزایی داشته باشند.</p>

<p><a class="p_ident" id="p_G/OP24PLTX" href="#p_G/OP24PLTX" tabindex="-1" role="presentation"></a>علت اینکه قواعد گزینشگر (selector) – منظور شیوه‌ی نشان‌کذاری استفاده شده در برگه‌های سبک‌دهی برای تعیین عناصر هدف برای اعمال سبک‌ها می‌باشد – را معرفی کردم این است که می توانیم از این زبان نصف و نیمه به عنوای روشی موثر برای پیدا کردن عناصر DOM استفاده کنیم.</p>

<p>متد <code>querySelectorAll</code> که هم در شیء <code>document</code> موجود است و هم روی گره‌های عنصر، یک رشته‌ی گزینشگر دریافت می کند و یک <code>NodeList‍</code> که حاوی تمامی عناصر تطبیق خورده است را برمی گرداند.</p>

<pre class="snippet cm-s-default" data-language="text/html" ><a class="c_ident" id="c_yJ0zujW+YH" href="#c_yJ0zujW+YH" tabindex="-1" role="presentation"></a><span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">p</span><span class="cm-tag cm-bracket">&gt;</span>And if you go chasing
  <span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">span</span> <span class="cm-attribute">class</span>=<span class="cm-string">&quot;animal&quot;</span><span class="cm-tag cm-bracket">&gt;</span>rabbits<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">span</span><span class="cm-tag cm-bracket">&gt;</span><span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">p</span><span class="cm-tag cm-bracket">&gt;</span>
<span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">p</span><span class="cm-tag cm-bracket">&gt;</span>And you know you're going to fall<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">p</span><span class="cm-tag cm-bracket">&gt;</span>
<span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">p</span><span class="cm-tag cm-bracket">&gt;</span>Tell 'em a <span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">span</span> <span class="cm-attribute">class</span>=<span class="cm-string">&quot;character&quot;</span><span class="cm-tag cm-bracket">&gt;</span>hookah smoking
  <span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">span</span> <span class="cm-attribute">class</span>=<span class="cm-string">&quot;animal&quot;</span><span class="cm-tag cm-bracket">&gt;</span>caterpillar<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">span</span><span class="cm-tag cm-bracket">&gt;</span><span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">span</span><span class="cm-tag cm-bracket">&gt;</span><span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">p</span><span class="cm-tag cm-bracket">&gt;</span>
<span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">p</span><span class="cm-tag cm-bracket">&gt;</span>Has given you the call<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">p</span><span class="cm-tag cm-bracket">&gt;</span>

<span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">script</span><span class="cm-tag cm-bracket">&gt;</span>
  <span class="cm-keyword">function</span> <span class="cm-def">count</span>(<span class="cm-def">selector</span>) {
    <span class="cm-keyword">return</span> <span class="cm-variable">document</span>.<span class="cm-property">querySelectorAll</span>(<span class="cm-variable-2">selector</span>).<span class="cm-property">length</span>;
  }
  <span class="cm-variable">console</span>.<span class="cm-property">log</span>(<span class="cm-variable">count</span>(<span class="cm-string">&quot;p&quot;</span>));           <span class="cm-comment">// All &lt;p&gt; elements</span>
  <span class="cm-comment">// → 4</span>
  <span class="cm-variable">console</span>.<span class="cm-property">log</span>(<span class="cm-variable">count</span>(<span class="cm-string">&quot;.animal&quot;</span>));     <span class="cm-comment">// Class animal</span>
  <span class="cm-comment">// → 2</span>
  <span class="cm-variable">console</span>.<span class="cm-property">log</span>(<span class="cm-variable">count</span>(<span class="cm-string">&quot;p .animal&quot;</span>));   <span class="cm-comment">// Animal inside of &lt;p&gt;</span>
  <span class="cm-comment">// → 2</span>
  <span class="cm-variable">console</span>.<span class="cm-property">log</span>(<span class="cm-variable">count</span>(<span class="cm-string">&quot;p &gt; .animal&quot;</span>)); <span class="cm-comment">// Direct child of &lt;p&gt;</span>
  <span class="cm-comment">// → 1</span>
<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">script</span><span class="cm-tag cm-bracket">&gt;</span></pre>

<p>برخلاف متدهایی مثل <code>getElementsByTagName</code>، شیءای که توسط <code>querySelectorAll</code> برگردانده می شود زنده یا پویا نیست. با تغییر سند، این شیء به روز نمی شود و هنوز یک آرایه‌ی واقعی نیست و اگر لازم دارید تا از ویژگی‌های آرایه‌ها بهره ببرید باید <bdo><code>Array.from</code></bdo> را روی آن‌ها فراخوانی کنید.</p>

<p><a class="p_ident" id="p_EvBRWcWEg4" href="#p_EvBRWcWEg4" tabindex="-1" role="presentation"></a>متد <code>querySelector</code> (بدون All) به شکل مشابهی عمل می کند. این متد برای زمانی که قصد دارید یک عنصر مشخص را هدف قرار دهید مناسب است. این متد فقط اولین عنصری که مطابق گزینشگر بود را برمی گرداند و در صورت پیدا نکردن هیچ عنصری مقدار null را تولید می کند.</p>

<h2 id="animation"><a class="h_ident" id="h_DpcLDonzDU" href="#h_DpcLDonzDU" tabindex="-1" role="presentation"></a>موقعیت دهی و متحرک‌سازی</h2>

<p><a class="p_ident" id="p_o4FWKvoOFs" href="#p_o4FWKvoOFs" tabindex="-1" role="presentation"></a>خاصیت <code>position</code> در سبک‌دهی، تاثیر مهمی در در طرح‌بندی صفحه‌ می‌گذارد. به صورت پیش فرض مقدار آن برابر <code>static</code> است که یعنی عنصر مورد نظر در موقعیت نرمال خودش در سند قرار می گیرد. زمانی که این مقدار به <code>relative</code> تغییر می یابد، عنصر همچنان فضایی در سند اشغال می کند اما اکنون می توان از خاصیت‌های <code>top</code> و <code>left</code> برای تغییر مکان آن نسبت به جایگاه نرمالش استفاده کرد. زمانی که <code>position</code> برابر <code>absolute</code> قرار گیرد، عنصر مورد نظر از جریان چیدمان صفحه خارج می شود – به این معنا که دیگر فضایی را اشغال نمی کند و ممکن است روی دیگر عناصر بیفتد. همچنین در این حالت خاصیت‌های <code>top</code> و <code>left</code> را می توان برای موقعیت دهی مطلق عنصر نسبت به گوشه‌ی بالا و چپ نزدیک ترین عنصر والدش (که دارای مقدار <code>position</code> غیر از static است) استفاده کرد یا در صورت نبود آن، نسبت به کل سند موقعیت دهی می شود.</p>

<p>می توانیم از این خاصیت برای ایجاد یک پویانمایی استفاده کنیم. صفحه‌ی پیش رو تصویری از یک گربه را نشان می دهد که به دور دایره‌ای حرکت می کند.</p>

<pre class="snippet cm-s-default" data-language="text/html" ><a class="c_ident" id="c_SCZYa8azNm" href="#c_SCZYa8azNm" tabindex="-1" role="presentation"></a><span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">p</span> <span class="cm-attribute">style</span>=<span class="cm-string">&quot;text-align: center&quot;</span><span class="cm-tag cm-bracket">&gt;</span>
  <span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">img</span> <span class="cm-attribute">src</span>=<span class="cm-string">&quot;img/cat.png&quot;</span> <span class="cm-attribute">style</span>=<span class="cm-string">&quot;position: relative&quot;</span><span class="cm-tag cm-bracket">&gt;</span>
<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">p</span><span class="cm-tag cm-bracket">&gt;</span>
<span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">script</span><span class="cm-tag cm-bracket">&gt;</span>
  <span class="cm-keyword">let</span> <span class="cm-def">cat</span> <span class="cm-operator">=</span> <span class="cm-variable">document</span>.<span class="cm-property">querySelector</span>(<span class="cm-string">&quot;img&quot;</span>);
  <span class="cm-keyword">let</span> <span class="cm-def">angle</span> <span class="cm-operator">=</span> <span class="cm-variable">Math</span>.<span class="cm-property">PI</span> <span class="cm-operator">/</span> <span class="cm-number">2</span>;
  <span class="cm-keyword">function</span> <span class="cm-def">animate</span>(<span class="cm-def">time</span>, <span class="cm-def">lastTime</span>) {
    <span class="cm-keyword">if</span> (<span class="cm-variable-2">lastTime</span> <span class="cm-operator">!=</span> <span class="cm-atom">null</span>) {
      <span class="cm-variable">angle</span> <span class="cm-operator">+=</span> (<span class="cm-variable-2">time</span> <span class="cm-operator">-</span> <span class="cm-variable-2">lastTime</span>) <span class="cm-operator">*</span> <span class="cm-number">0.001</span>;
    }
    <span class="cm-variable">cat</span>.<span class="cm-property">style</span>.<span class="cm-property">top</span> <span class="cm-operator">=</span> (<span class="cm-variable">Math</span>.<span class="cm-property">sin</span>(<span class="cm-variable">angle</span>) <span class="cm-operator">*</span> <span class="cm-number">20</span>) <span class="cm-operator">+</span> <span class="cm-string">&quot;px&quot;</span>;
    <span class="cm-variable">cat</span>.<span class="cm-property">style</span>.<span class="cm-property">left</span> <span class="cm-operator">=</span> (<span class="cm-variable">Math</span>.<span class="cm-property">cos</span>(<span class="cm-variable">angle</span>) <span class="cm-operator">*</span> <span class="cm-number">200</span>) <span class="cm-operator">+</span> <span class="cm-string">&quot;px&quot;</span>;
    <span class="cm-variable">requestAnimationFrame</span>(<span class="cm-def">newTime</span> <span class="cm-operator">=&gt;</span> <span class="cm-variable">animate</span>(<span class="cm-variable-2">newTime</span>, <span class="cm-variable-2">time</span>));
  }
  <span class="cm-variable">requestAnimationFrame</span>(<span class="cm-variable">animate</span>);
<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">script</span><span class="cm-tag cm-bracket">&gt;</span></pre>

<p>تصویر ما در مرکز صفحه قرار گرفته است و مقدار <code>position</code> آن برابر <code>relative</code> است. ما پیوسته مقدار <code>top</code> و <code>left</code> تصویر را برای ایجاد حرکت به‌روز رسانی می کنیم.</p>

<p id="animationFrame"><a class="p_ident" id="p_5sPdYwQo/V" href="#p_5sPdYwQo/V" tabindex="-1" role="presentation"></a>این اسکریپت از <code>requestAnimationFrame</code> برای زمانبندی اجرای تابع <code>animate</code> هنگامی که مرورگر آماده است تا تصویر صفحه را دوباره بکشد، استفاده می کنیم. تابع <code>animate</code> خود دوباره <code>requestAnimationFrame</code> را برای زمانبندی به‌روزرسانی بعدی فراخوانی می کند. زمانی که پنجره‌ی مرورگر (یا تب مرورگر) فعال است، این باعث می شود که به‌روز‌رسانی‌ها با نرخ 60 بار در ثانیه انجام شود که پویانمایی روانی را تولید می کند.</p>

<p>اگر فقط DOM را در حلقه به‌روزرسانی می کردیم، صفحه ممکن بود قفل شود چیزی در تصویر نمایش داده نشود. مرورگرها صفحه‌ی نمایش خود را در هنگام اجرای یک برنامه‌ی جاوااسکریپت به‌روزرسانی نمی کنند و اجازه‌ی هیچ تعاملی با صفحه را هم فراهم نمی کنند. به همین دلیل است که به <code>requestAnimationFrame</code> نیاز داریم – این تابع به مرورگر می گوید که کار ما در این لحظه تمام است و می تواند به کارش ادامه دهد، مثل به‌روزرسانی صفحه نمایش و پاسخ به درخواست‌های کاربر.</p>

<p>تابع پویانمایی، زمان فعلی را به عنوان یک آرگومان دریافت می کند. برای کسب اطمینان از اینکه میزان حرکت￼ گربه در هزارم ثانیه مداوم و باثبات است، این تابع سرعت را در قسمت‌هایی که زاویه تغییر می کند بر اساس تفاوت بین زمان فعلی و آخرین باری که تابع اجرا شد در نظر می گیرد. اگر با هر قدم مقدار ثابتی حرکت در زاویه انجام می‌شد، ممکن بود حرکت تصویر لنگ بزند، درصورتی‌ که به عنوان مثال یک برنامه‌ی سنگین دیگر روی همان کامپیوتر اجرا می شد که تابع را برای کسری از ثانیه از حرکت می انداخت.</p>

<p id="sin_cos">برای حرکت دایره‌ای از توابع مثلثات مثل <bdo><code>Math.cos</code></bdo> و <bdo><code>Math.sin</code></bdo> استفاده می شود. برای افرادی که با این مفاهیم آشنا نیستند، به طور خلاصه آن ها را معرفی خواهم کرد چرا که کم و بیش از آن ها در کتاب استفاده خواهیم کرد.</p>

<p><a class="p_ident" id="p_DRhHBjyVId" href="#p_DRhHBjyVId" tabindex="-1" role="presentation"></a>متدهای <bdo><code>Math.cos</code></bdo> و <bdo><code>Math.sin</code></bdo> برای پیدا کردن نقاطی که روی محیط دایره‌ای با مرکز <bdo>(0,0)</bdo> و شعاع یک استفاده می شوند. هر دوی این متدها ورودی‌هایشان را به عنوان موقعیت‌هایی روی این دایره تفسیر می کنند، که صفر به معنای نقطه‌ای است که در راست‌ترین قسمت دایره قرار گرفته است و حرکت در جهت گردش عقربه‌های ساعت تا <bdo>2π</bdo> می باشد (حدود <bdo>6.28</bdo>) که یک دور کامل دایره انجام می شود. <bdo><code>Math.cos</code></bdo> مختصات x نقطه‌ای که مربوط به موقعیت داده شده است را برمی‌گرداند در حالیکه <bdo><code>Math.sin</code></bdo> مختصات y آن را می دهد. موقعیت‌هایی (یا زاویه‌ها) که از <bdo>2π</bdo> بزرگتر باشند یا از 0 کوچکتر باشند معتبر محسوب می شوند – چرخش تکرار می شود بنابراین <bdo><em>a</em>+2π</bdo> معادل همان زاویه‌ی <em>a</em> خواهد بود.</p>

<p><a class="p_ident" id="p_iBcDofBaKA" href="#p_iBcDofBaKA" tabindex="-1" role="presentation"></a>این واحد اندازه‌گیری برای زاویه‌ها را رادیان می نامند- یک دایره‌ی کامل برابر <bdo>2π</bdo> رادیان است، مشابه 360 در واحد درجه. ثابت π در جاوااسکریپت توسط <bdo><code>Math.PI</code></bdo> در دسترس است.</p><figure><img src="img/cos_sin.svg" alt="Using cosine and sine to compute coordinates"></figure>

<p><a class="p_ident" id="p_4n84s1DpT5" href="#p_4n84s1DpT5" tabindex="-1" role="presentation"></a>کد پویانمایی گربه یک شمارنده هم نگهداری می کند، <code>angle</code>، تا زاویه‌ی فعلی حرکت را داشته باشد و با هر بار فراخوانی تابع <code>animate</code> آن را افزایش می دهد. بعدا می تواند از این زاویه برای محاسبه موقعیت فعلی عنصر تصویر استفاده کند. مقدار خاصیت سبکی <code>top</code> هم به وسیله‌ی <bdo><code>Math.sin</code></bdo> و ضرب آن در 20 محاسبه می شود که نمایانگر شعاع عمودی در بیضی ما است. مقدار <code>left</code> نیز بر اساس <bdo><code>Math.cos</code></bdo> و ضرب آن در 200 است بنابراین بیضی ما دارای عرض بسیار بیشتری نسبت به طولش است.</p>

<p><a class="p_ident" id="p_/aRZoq1buo" href="#p_/aRZoq1buo" tabindex="-1" role="presentation"></a>توجه داشته باشید که مقادیر مربوط به سبک‌ها معمولا به واحد نیاز دارند. در این مثال، ما باید <code>&quot;px&quot;</code> را به عدد اضافه کنیم تا به مرورگر اعلام کنیم که شمارش در واحد پیکسل می باشد (نه سانتیمتر، “em”، یا دیگر واحدها). به راحتی ممکن است این نکته فراموش شود. استفاده از اعداد بدون واحدها باعث می شود که سبک‌دهی شما اعمال نگردد- مگر اینکه آن عدد 0 باشد که همیشه معنای یکسانی دارد.</p>

<h2><a class="h_ident" id="h_EzvDUHyjs2" href="#h_EzvDUHyjs2" tabindex="-1" role="presentation"></a>خلاصه</h2>

<p>برنامه‌های جاوااسکریپت می توانند در صفحه‌ای که مرورگر به نمایش می گذارد، با استفاده از یک ساختار داده به نام DOM، دخالت و دستکاری کنند. این ساختار داده نمایانگر مدل مرورگر از صفحه است و یک برنامه‌ی جاوااسکریپت می تواند آن را تغییر دهد و در سندی که به نمایش درمی آید تغییر ایجاد کند.</p>

<p>DOM به شکل یک درخت سازماندهی شده است که در آن عناصر به صورت سلسله‌مراتبی براساس ساختار سند مرتب می شوند. اشیائی که نماینده‌ی عناصر هستند دارای خاصیت‌هایی مانند <code>parentNode</code> و <code>childNodes</code> هستند که می توان از آن ها برای حرکت در این درخت استفاده کرد.</p>

<p>نحوه‌ی نمایش یک سند را می توان با سبک‌دهی تغییر داد و این کار به دو روش چسباندن سبک‌ها به عناصر به صورت مستقیم و یا با تعریف دستوراتی که عناصر خاصی را هدف قرار می دهند صورت می‌پذیرد. خاصیت‌های سبک‌دهی زیاد و متنوعی وجود دارد مثل <code>color</code> یا <code>display</code>. کدهای جاوااسکریپت می توانند سبک یک عنصر را مستقیما از طریق خصوصیت <code>style</code> دستکاری کنند.</p>

<h2><a class="h_ident" id="h_ggOFdVwDCk" href="#h_ggOFdVwDCk" tabindex="-1" role="presentation"></a>تمرین‌ها</h2>

<h3 id="exercise_table"><a class="i_ident" id="i_cG/PUQtNdg" href="#i_cG/PUQtNdg" tabindex="-1" role="presentation"></a>ساخت یک جدول</h3>

<p>یک جدول HTML به وسیله‌ی ساختار برچسب‌های زیر ساخته می شود:</p>

<pre class="snippet cm-s-default" data-language="text/html" ><a class="c_ident" id="c_MudCG4cYiG" href="#c_MudCG4cYiG" tabindex="-1" role="presentation"></a><span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">table</span><span class="cm-tag cm-bracket">&gt;</span>
  <span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">tr</span><span class="cm-tag cm-bracket">&gt;</span>
    <span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">th</span><span class="cm-tag cm-bracket">&gt;</span>name<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">th</span><span class="cm-tag cm-bracket">&gt;</span>
    <span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">th</span><span class="cm-tag cm-bracket">&gt;</span>height<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">th</span><span class="cm-tag cm-bracket">&gt;</span>
    <span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">th</span><span class="cm-tag cm-bracket">&gt;</span>place<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">th</span><span class="cm-tag cm-bracket">&gt;</span>
  <span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">tr</span><span class="cm-tag cm-bracket">&gt;</span>
  <span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">tr</span><span class="cm-tag cm-bracket">&gt;</span>
    <span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">td</span><span class="cm-tag cm-bracket">&gt;</span>Kilimanjaro<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">td</span><span class="cm-tag cm-bracket">&gt;</span>
    <span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">td</span><span class="cm-tag cm-bracket">&gt;</span>5895<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">td</span><span class="cm-tag cm-bracket">&gt;</span>
    <span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">td</span><span class="cm-tag cm-bracket">&gt;</span>Tanzania<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">td</span><span class="cm-tag cm-bracket">&gt;</span>
  <span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">tr</span><span class="cm-tag cm-bracket">&gt;</span>
<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">table</span><span class="cm-tag cm-bracket">&gt;</span></pre>

<p>برای هر ردیف، برچسب <bdo><code>&lt;table&gt;</code></bdo> یک برچسب <bdo><code>&lt;tr&gt;</code></bdo> خواهد داشت. درون این برچسب‌های <bdo><code>&lt;tr&gt;</code></bdo> می توانیم سلول‌های جدول را قرار دهیم: سلول‌های معمولی (<bdo><code>&lt;td&gt;</code></bdo>) یا سلول‌های عنوان (<bdo><code>&lt;th&gt;</code></bdo>).</p>

<p>با در دست داشتن مجموعه اطلاعاتی در باره‌ی کوه‌ها، آرایه‌ای از اشیاء شامل <code>name</code>، <code>height</code> و <code>place</code> ، یک ساختار DOM برای جدولی که این اشیاء را می شمارد ایجاد کنید. این جدول باید یک ستون برای هر کلید و یک ردیف برای هر شیء داشته باشد، مازاد بر آن یک ردیف عنوان به وسیله‌ی عنصرهای <bdo><code>&lt;th&gt;</code></bdo> در قسمت بالا که نام ستون‌ها را لیست کند.</p>

<p>این برنامه را به صورتی بنویسید که در آن ستون‌ها به طور خودکار از اشیاء گرفته می می‌شوند و این کار با گرفتن نام‌های خاصیت‌های اولین شیء در مجموعه‌ی داده‌ها رخ می دهد.</p>

<p>به این صورت بنویسید که ستون‌ها به صورت خودکار با گرفتن نام‌ خاصیت‌های اولین شیء در مجموعه‌ی داده‌ها ایجاد شوند.</p>

<p>جدول نهایی را به عنصری که دارای خصوصیت <code>id</code> برابر با <code>&quot;mountains&quot;</code> می‌باشد اضافه کنید تا در صفحه نمایش داده￼ شود.</p>

<p>بعد از این که این قسمت را تکمیل کردید سلول‌هایی که حاوی مقادیر عددی هستند را راست چین کنید و این کار را با تنظیم <bdo><code>style.textAlign</code></bdo> برابر با <code>&quot;right&quot;</code> انجام دهید.</p>

<pre class="snippet cm-s-default" data-language="text/html" ><a class="c_ident" id="c_SaASguUQJh" href="#c_SaASguUQJh" tabindex="-1" role="presentation"></a><span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">h1</span><span class="cm-tag cm-bracket">&gt;</span>Mountains<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">h1</span><span class="cm-tag cm-bracket">&gt;</span>

<span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">div</span> <span class="cm-attribute">id</span>=<span class="cm-string">&quot;mountains&quot;</span><span class="cm-tag cm-bracket">&gt;</span><span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">div</span><span class="cm-tag cm-bracket">&gt;</span>

<span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">script</span><span class="cm-tag cm-bracket">&gt;</span>
  <span class="cm-keyword">const</span> <span class="cm-def">MOUNTAINS</span> <span class="cm-operator">=</span> [
    {<span class="cm-property">name</span>: <span class="cm-string">&quot;Kilimanjaro&quot;</span>, <span class="cm-property">height</span>: <span class="cm-number">5895</span>, <span class="cm-property">place</span>: <span class="cm-string">&quot;Tanzania&quot;</span>},
    {<span class="cm-property">name</span>: <span class="cm-string">&quot;Everest&quot;</span>, <span class="cm-property">height</span>: <span class="cm-number">8848</span>, <span class="cm-property">place</span>: <span class="cm-string">&quot;Nepal&quot;</span>},
    {<span class="cm-property">name</span>: <span class="cm-string">&quot;Mount Fuji&quot;</span>, <span class="cm-property">height</span>: <span class="cm-number">3776</span>, <span class="cm-property">place</span>: <span class="cm-string">&quot;Japan&quot;</span>},
    {<span class="cm-property">name</span>: <span class="cm-string">&quot;Vaalserberg&quot;</span>, <span class="cm-property">height</span>: <span class="cm-number">323</span>, <span class="cm-property">place</span>: <span class="cm-string">&quot;Netherlands&quot;</span>},
    {<span class="cm-property">name</span>: <span class="cm-string">&quot;Denali&quot;</span>, <span class="cm-property">height</span>: <span class="cm-number">6168</span>, <span class="cm-property">place</span>: <span class="cm-string">&quot;United States&quot;</span>},
    {<span class="cm-property">name</span>: <span class="cm-string">&quot;Popocatepetl&quot;</span>, <span class="cm-property">height</span>: <span class="cm-number">5465</span>, <span class="cm-property">place</span>: <span class="cm-string">&quot;Mexico&quot;</span>},
    {<span class="cm-property">name</span>: <span class="cm-string">&quot;Mont Blanc&quot;</span>, <span class="cm-property">height</span>: <span class="cm-number">4808</span>, <span class="cm-property">place</span>: <span class="cm-string">&quot;Italy/France&quot;</span>}
  ];

  <span class="cm-comment">// Your code here</span>
<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">script</span><span class="cm-tag cm-bracket">&gt;</span></pre>

<div class="solution"><div class="solution-text">

<p>می توانید از <bdo><code>document.<wbr>createElement</code></bdo> برای ایجاد گره‌های جدید استفاده کنید، همچنین از <bdo><code>document.<wbr>createTextNode</code></bdo> برای ایجاد گره‌های متنی و از <bdo><code>appendChild</code></bdo> نیز برای قرار دادن گره‌ها در دیگر گره‌ها.</p>

<p>لازم خواهد شد تا نام‌ کلید‌های شیء را یک بار پیمایش کرده تا ردیف بالایی را پر کنید و بعد دوباره برای هر شیء</p>

<p>در ادامه لازم دارید تا نام کلید‌ها را پیمایش کنید؛ یک بار برای پر کردن ردیف بالایی و بعد دوباره برای هر همه‌ی اشیاء موجود در آرایه تا بتوانید ردیف‌های داده را بسازید. برای بدست آوردن یک آرایه از نام کلید‌ها از شیء اول، <bdo><code>Object.keys</code></bdo> به دردتان خواهد خورد.</p>

<p>برای اضافه کردن جدول به گره‌ی والد فعلی، می توانید از <bdo><code>document.<wbr>getElementById</code></bdo> یا <bdo><code>document.<wbr>querySelector</code></bdo> برای پیدا کردن گره‌ای با خاصیت <code>id</code> مورد نظر استفاده کنید.</p>

</div></div>

<h3><a class="i_ident" id="i_fZAmRnDswn" href="#i_fZAmRnDswn" tabindex="-1" role="presentation"></a>گرفتن عناصر به وسیله‌ی نام برچسب‌ها</h3>

<p>متد <bdo><code>document.<wbr>getElementsByTagName</code></bdo> تمامی عناصر فرزند را برای نام برچسب داده شده برمی گرداند. نسخه‌ی خودتان از این متد را به عنوان یک تابع بنویسید که یک گره و یک رشته (نام برچسب) را به عنوان ورودی‌ها بگیرد و آرایه‌ای که حاوی تمامی گره‌های فرزند متعلق به آن برچسب را برگرداند.</p>

<p>برای پیدا کردن نام برچسب یک عنصر، از خاصیت <code>nodeName</code> استفاده کنید. اما توجه داشته باشید که این خاصیت نام برچسب را با حروف بزرگ برمی گرداند. از متدهای رشته، <code>toLowerCase</code> یا <code>toUpperCase</code> برای درست کردن آن استفاده کنید.</p>

<pre class="snippet cm-s-default" data-language="text/html" ><a class="c_ident" id="c_SHm9FthIXO" href="#c_SHm9FthIXO" tabindex="-1" role="presentation"></a><span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">h1</span><span class="cm-tag cm-bracket">&gt;</span>Heading with a <span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">span</span><span class="cm-tag cm-bracket">&gt;</span>span<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">span</span><span class="cm-tag cm-bracket">&gt;</span> element.<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">h1</span><span class="cm-tag cm-bracket">&gt;</span>
<span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">p</span><span class="cm-tag cm-bracket">&gt;</span>A paragraph with <span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">span</span><span class="cm-tag cm-bracket">&gt;</span>one<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">span</span><span class="cm-tag cm-bracket">&gt;</span>, <span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">span</span><span class="cm-tag cm-bracket">&gt;</span>two<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">span</span><span class="cm-tag cm-bracket">&gt;</span>
  spans.<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">p</span><span class="cm-tag cm-bracket">&gt;</span>

<span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">script</span><span class="cm-tag cm-bracket">&gt;</span>
  <span class="cm-keyword">function</span> <span class="cm-def">byTagName</span>(<span class="cm-def">node</span>, <span class="cm-def">tagName</span>) {
    <span class="cm-comment">// Your code here.</span>
  }

  <span class="cm-variable">console</span>.<span class="cm-property">log</span>(<span class="cm-variable">byTagName</span>(<span class="cm-variable">document</span>.<span class="cm-property">body</span>, <span class="cm-string">&quot;h1&quot;</span>).<span class="cm-property">length</span>);
  <span class="cm-comment">// → 1</span>
  <span class="cm-variable">console</span>.<span class="cm-property">log</span>(<span class="cm-variable">byTagName</span>(<span class="cm-variable">document</span>.<span class="cm-property">body</span>, <span class="cm-string">&quot;span&quot;</span>).<span class="cm-property">length</span>);
  <span class="cm-comment">// → 3</span>
  <span class="cm-keyword">let</span> <span class="cm-def">para</span> <span class="cm-operator">=</span> <span class="cm-variable">document</span>.<span class="cm-property">querySelector</span>(<span class="cm-string">&quot;p&quot;</span>);
  <span class="cm-variable">console</span>.<span class="cm-property">log</span>(<span class="cm-variable">byTagName</span>(<span class="cm-variable">para</span>, <span class="cm-string">&quot;span&quot;</span>).<span class="cm-property">length</span>);
  <span class="cm-comment">// → 2</span>
<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">script</span><span class="cm-tag cm-bracket">&gt;</span></pre>

<div class="solution"><div class="solution-text">

<p>ساده‌ترین روش پیاده‌سازی این راه‌حل استفاده از یک تابع بازگشتی است، شبیه به <a href="14_dom.html#talksAbout"><code>talksAbout</code> تابع</a> که پیش‌تر در این فصل تعریف گردید.</p>

<p>می‌توانید عناصر آرایه‌ی تولیدی را به وسیله‌ی فراخوانی تابع <code>byTagname</code> به صورت بازگشتی به هم بچسبانید تا خروجی را تولید کنید. یا می توانید تابعی درونی تعریف کنید که خودش را به صورت بازگشتی فراخوانی کند که این تابع به یک متغیر آرایه که در تابع بیرونی‌اش تعریف شده دسترسی دارد و می تواند عناصری که پیدا‌ می‌کند را به آن اضافه نماید. فراموش نکنید که باید تابع درونی را یک بار از تابع بیرونی فراخوانی کنید تا روند کار شروع شود.</p>

<p>تابع بازگشتی باید نوع گره را بررسی کیند. در اینجا فقط مایلیم تا گره‌ نوع 1 (<code>Node.<wbr>ELEMENT_NODE</code>) را در نظر بگیریم. برای این نوع گره‌ها، ما باید فرزندانشان را پیمایش کنیم و برای هر فرزند، مشاهده کنیم که آیا با پرس‌وجوی‌ ما مطابقت دارد یا خیر و همچنین یک فراخوانی بازگشتی روی آن نیز داشته باشیم تا فرزندان آن را نیز پوشش داده باشیم.</p>

</div></div>

<h3><a class="i_ident" id="i_6HcsNCNcZW" href="#i_6HcsNCNcZW" tabindex="-1" role="presentation"></a>کلاه گربه</h3>

<p>پویانمایی <a href="14_dom.html#animation">ایجاد شده در قبل</a> را توسعه دهید تا گربه و کلاهش (<bdo><code>&lt;img src=&quot;img/<wbr>hat.<wbr>png&quot;&gt;</code></bdo>) هر کدام در جهت مخالف هم بچرخند.</p>

<p>یا کاری کنید که کلاه دور گربه بچرخد. یا پویانمایی را به صورتی که جالب باشد تغییر دهید.</p>

<p>برای ساده سازی روند موقعیت دهی چند شیء، احتمالا ایده‌ی خوبی است که به سراغ موقعیت دهی مطلق برویم. به این معنا که <code>top</code> و <code>left</code> بر اساس گوشه‌ی چپ و بالای سند محاسبه بشوند. برای جلوگیری از مختصات منفی، که باعث می شود که تصاویر به بیرون از فضای قابل مشاهده صفحه منتقل شوند، می توانید یک عدد مشخص و ثابت را به مقادیر موقعیت ها اضافه کنید.</p>

<pre class="snippet cm-s-default" data-language="text/html" ><a class="c_ident" id="c_h3Gqsempqw" href="#c_h3Gqsempqw" tabindex="-1" role="presentation"></a><span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">style</span><span class="cm-tag cm-bracket">&gt;</span><span class="cm-tag">body</span> { <span class="cm-property">min-height</span>: <span class="cm-number">200px</span> }<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">style</span><span class="cm-tag cm-bracket">&gt;</span>
<span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">img</span> <span class="cm-attribute">src</span>=<span class="cm-string">&quot;img/cat.png&quot;</span> <span class="cm-attribute">id</span>=<span class="cm-string">&quot;cat&quot;</span> <span class="cm-attribute">style</span>=<span class="cm-string">&quot;position: absolute&quot;</span><span class="cm-tag cm-bracket">&gt;</span>
<span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">img</span> <span class="cm-attribute">src</span>=<span class="cm-string">&quot;img/hat.png&quot;</span> <span class="cm-attribute">id</span>=<span class="cm-string">&quot;hat&quot;</span> <span class="cm-attribute">style</span>=<span class="cm-string">&quot;position: absolute&quot;</span><span class="cm-tag cm-bracket">&gt;</span>

<span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">script</span><span class="cm-tag cm-bracket">&gt;</span>
  <span class="cm-keyword">let</span> <span class="cm-def">cat</span> <span class="cm-operator">=</span> <span class="cm-variable">document</span>.<span class="cm-property">querySelector</span>(<span class="cm-string">&quot;#cat&quot;</span>);
  <span class="cm-keyword">let</span> <span class="cm-def">hat</span> <span class="cm-operator">=</span> <span class="cm-variable">document</span>.<span class="cm-property">querySelector</span>(<span class="cm-string">&quot;#hat&quot;</span>);

  <span class="cm-keyword">let</span> <span class="cm-def">angle</span> <span class="cm-operator">=</span> <span class="cm-number">0</span>;
  <span class="cm-keyword">let</span> <span class="cm-def">lastTime</span> <span class="cm-operator">=</span> <span class="cm-atom">null</span>;
  <span class="cm-keyword">function</span> <span class="cm-def">animate</span>(<span class="cm-def">time</span>) {
    <span class="cm-keyword">if</span> (<span class="cm-variable">lastTime</span> <span class="cm-operator">!=</span> <span class="cm-atom">null</span>) <span class="cm-variable">angle</span> <span class="cm-operator">+=</span> (<span class="cm-variable-2">time</span> <span class="cm-operator">-</span> <span class="cm-variable">lastTime</span>) <span class="cm-operator">*</span> <span class="cm-number">0.001</span>;
    <span class="cm-variable">lastTime</span> <span class="cm-operator">=</span> <span class="cm-variable-2">time</span>;
    <span class="cm-variable">cat</span>.<span class="cm-property">style</span>.<span class="cm-property">top</span> <span class="cm-operator">=</span> (<span class="cm-variable">Math</span>.<span class="cm-property">sin</span>(<span class="cm-variable">angle</span>) <span class="cm-operator">*</span> <span class="cm-number">40</span> <span class="cm-operator">+</span> <span class="cm-number">40</span>) <span class="cm-operator">+</span> <span class="cm-string">&quot;px&quot;</span>;
    <span class="cm-variable">cat</span>.<span class="cm-property">style</span>.<span class="cm-property">left</span> <span class="cm-operator">=</span> (<span class="cm-variable">Math</span>.<span class="cm-property">cos</span>(<span class="cm-variable">angle</span>) <span class="cm-operator">*</span> <span class="cm-number">200</span> <span class="cm-operator">+</span> <span class="cm-number">230</span>) <span class="cm-operator">+</span> <span class="cm-string">&quot;px&quot;</span>;

    <span class="cm-comment">// Your extensions here.</span>

    <span class="cm-variable">requestAnimationFrame</span>(<span class="cm-variable">animate</span>);
  }
  <span class="cm-variable">requestAnimationFrame</span>(<span class="cm-variable">animate</span>);
<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">script</span><span class="cm-tag cm-bracket">&gt;</span></pre>

<div class="solution"><div class="solution-text">

<p><a class="p_ident" id="p_wwW0b1Mdqm" href="#p_wwW0b1Mdqm" tabindex="-1" role="presentation"></a><bdo><code>Math.cos</code></bdo> و <bdo><code>Math.sin</code></bdo> زاویه‌ها را در واحد رادیان اندازه‌گیری می کنند، جایی‌که یک دایره‌ی کامل برابر با <bdo>2π</bdo> می‌باشد. برای یک زاویه‌ی داده شده، می توانید برای به‌دست آوردن زاویه‌ی مخالف، نصف <bdo>2π</bdo> که می‌شود <bdo><code>Math.PI</code></bdo>. این کار برای قرار دادن کلاه در طرف دیگر دایره کاربرد دارد.</p>

</div></div><nav><a href="13_browser.html" title="previous chapter">◀</a> <a href="index.html" title="cover">◆</a> <a href="15_event.html" title="next chapter">▶</a></nav>
</article>
