<!doctype html>
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>HTTP و فرم‌ها :: Eloquent JavaScript</title>
  <link rel=stylesheet href="js/node_modules/codemirror/lib/codemirror.css">
  <script src="js/acorn_codemirror.js"></script>
  <link rel=stylesheet href="css/ejs.css">
  <script src="js/sandbox.js"></script>
  <script src="js/ejs.js"></script><script>var chapNum = 18;var sandboxLoadFiles = ["code/chapter/18_http.js"];</script><script>var clicky_site_ids = clicky_site_ids || []; clicky_site_ids.push(101171577);</script>
  <script async src="//static.getclicky.com/js"></script>

</head>

<article>
<nav><a href="17_canvas.html" title="previous chapter">◀</a> <a href="index.html" title="cover">◆</a> <a href="19_paint.html" title="next chapter">▶</a></nav>

<h1><span class=chap_num>فصل 18</span>HTTP و فرم‌ها</h1>

<blockquote>

<p><a class="p_ident" id="p_2jmj7l5rSw" href="#p_2jmj7l5rSw" tabindex="-1" role="presentation"></a>ارتباط باید مستقل از وضعیت باشد [...] این‌گونه که هر درخواست از سمت سرویس‌گیرنده به سرویس‌دهنده باید شامل تمامی اطلاعات مورد نیاز برای درک درخواست باشد، و نباید بتوان از زمینه‌ای در ارتباط که روی سرویس‌دهنده از پیش ذخیره شده است، استفاده نمود.</p>

<footer>روی فیلدینگ, <cite>سبک‌های معماری و طراحی معمار‌ی‌های نرم‌افزار مبتنی بر شبکه</cite></footer>

</blockquote><figure class="chapter framed"><img src="img/chapter_picture_18.jpg" alt="Picture of a web form on a medieval scroll"></figure>

<p><a class="p_ident" id="p_d7X440OpD2" href="#p_d7X440OpD2" tabindex="-1" role="presentation"></a>پروتوکل انتقال ابرمتن (http) که پیش از این در <a href="13_browser.html#web">فصل 13</a> آمد، مکانیزمی است که از طریق آن داده‌ها در شبکه‌ی گسترده‌ی وب، درخواست و فراهم می شوند. این فصل به توصیف این پروتوکل با جزئیات بیشتری می پردازد و چگونگی دسترسی جاوااسکریپت در مرورگر را به آن شرح می‌دهد.</p>

<h2><a class="h_ident" id="h_FicebXJJuQ" href="#h_FicebXJJuQ" tabindex="-1" role="presentation"></a>پروتوکل</h2>

<p><a class="p_ident" id="p_sDEofouzMn" href="#p_sDEofouzMn" tabindex="-1" role="presentation"></a>اگر آدرس <bdo><em>eloquentjavascript.net/18_http.html</em></bdo> را در نوار آدرس مرورگرتان تایپ کنید، مرورگر ابتدا به دنبال آدرس سرویس‌دهنده‌ی (server) مرتبط با دامنه‌ی <em>eloquentjavascript.net</em> می‌گردد و تلاش می کند تا یک ارتباط TCP روی پورت 80 ، پورت پیش‌فرض برای ترافیک HTTP، به آن بگشاید. اگر سرویس دهنده وجود داشته ‌باشد و این ارتباط را پذیرش کند، مرورگر ممکن است اطلاعاتی شبیه به زیر را به آن ارسال نماید:</p>

<pre class="snippet cm-s-default" data-language="http" ><a class="c_ident" id="c_Y12YPXciUz" href="#c_Y12YPXciUz" tabindex="-1" role="presentation"></a>GET /18_http.html HTTP/1.1
Host: eloquentjavascript.net
User-Agent: Your browser's name</pre>

<p>سپس سرویس‌دهنده از طریق همان اتصال پاسخ می دهد.</p>

<pre class="snippet cm-s-default" data-language="http" ><a class="c_ident" id="c_Y84SZaL9nl" href="#c_Y84SZaL9nl" tabindex="-1" role="presentation"></a>HTTP/1.1 200 OK
Content-Length: 65585
Content-Type: text/html
Last-Modified: Mon, 08 Jan 2018 10:29:45 GMT

&lt;!doctype html&gt;
... the rest of the document</pre>

<p><a class="p_ident" id="p_fUuwhaGBuC" href="#p_fUuwhaGBuC" tabindex="-1" role="presentation"></a>مرورگر بخشی از پاسخ را که بعد از خط خالی می آید را می‌گیرد، بخش بدنه یا body (نباید با برچسب <bdo><code>&lt;body&gt;</code></bdo> در HTML اشتباه گرفته شود)، و آن را به عنوان یک سند HTML نشان می‌دهد.</p>

<p><a class="p_ident" id="p_CI4psKsAeV" href="#p_CI4psKsAeV" tabindex="-1" role="presentation"></a>اطلاعاتی که توسط کاربر ارسال می شود را درخواست (request) می نامند. یک درخواست با این خط شروع می شود:</p>

<pre class="snippet cm-s-default" data-language="http" ><a class="c_ident" id="c_q82hekYuxl" href="#c_q82hekYuxl" tabindex="-1" role="presentation"></a>GET /18_http.html HTTP/1.1</pre>

<p><a class="p_ident" id="p_jIdkvFXyZn" href="#p_jIdkvFXyZn" tabindex="-1" role="presentation"></a>اولین کلمه معرف روش یا متد (method) درخواست است. GET به این معناست که ما قصد گرفتن منبع مشخص شده را داریم. دیگر متدهای رایج شامل DELETE برای حذف یک منبع، PUT برای جایگزین کردن آن، و POST برای ارسال اطلاعات به آن می شوند. توجه داشته باشید که سرویس دهنده مجبور نیست هر درخواستی را که دریافت می کند اجرا کند. اگر به یک وب سایت تصادفی درخواستی از نوع DELETE برای حذف صفحه‌ی اصلی آن ارسال نمایید، احتمالا رد خواهد شد.</p>

<p><a class="p_ident" id="p_GEQgJnuvrt" href="#p_GEQgJnuvrt" tabindex="-1" role="presentation"></a>قسمت بعد از نام متد، معرف مسیر منبعی است که درخواست برای آن ارسال می شود. در ساده ترین شکل، یک منبع، فایلی روی سرویس‌دهنده می‌باشد اما اجباری برای آن در پروتوکل وجود ندارد. یک منبع می تواند هرچیزی که بتوان آن را انتقال داد باشد همان طور که یک فایل اینگونه می‌باشد. خیلی از سرویس‌دهنده‌ها پاسخ‌های تولیدی را به صورت پویا و درحین اجرا ایجاد می کنند. به عنوان مثال، اگر آدرس <a href="https://github.com/marijnh"><em>https://github.com/marijnh</em></a> را باز کنید، سرویس دهنده در بانک اطلاعاتیش به دنبال کاربری با نام “marijnh” می گردد و اگر پیدا کرد، یک صفحه‌ی پروفایل برای این کاربر ایجاد و برمی گرداند.</p>

<p><a class="p_ident" id="p_WNdZyt8add" href="#p_WNdZyt8add" tabindex="-1" role="presentation"></a>بعد از مسیر منبع، اولین خط از درخواست شامل 1.1/HTTP می‌باشد که بیانگر نسخه‌ی پروتوکل HTTP در حال استفاده می‌باشد.</p>

<p><a class="p_ident" id="p_16VBe4kxbK" href="#p_16VBe4kxbK" tabindex="-1" role="presentation"></a>در عمل، خیلی از سایت‌ها از HTTP نسخه 2 استفاده می کنند که از همان مفاهیم نسخه 1.1 پشتبانی می کند اما بسیار پیش‌رفته‌تر است که در نتیجه سریع تر عمل می کند. مرورگرها در هنگام ارتباط با سرویس‌دهنده‌ی داده شده، به صورت خودکار به نسخه‌ی پروتوکل مناسب رجوع می کنند و نتیجه‌ی درخواست فارغ از نسخه‌ی پروتوکل یکسان است. به دلیل اینکه نسخه‌ی 1.1 سرراست تر و آسان تر است، ما به همان می پردازیم.</p>

<p>پاسخ سرویس‌دهنده با یک شماره‌ی نسخه شروع می شود که بعد از آن وضعیت پاسخ درج می شود. ابتدا یک عدد سه رقمی وضعیت و سپس یک رشته‌ی متنی قابل خواندن برای انسان برگردانده می‌شود.</p>

<pre class="snippet cm-s-default" data-language="http" ><a class="c_ident" id="c_A6dkQ5Qg2b" href="#c_A6dkQ5Qg2b" tabindex="-1" role="presentation"></a>HTTP/1.1 200 OK</pre>

<p><a class="p_ident" id="p_w3a0ea+AjV" href="#p_w3a0ea+AjV" tabindex="-1" role="presentation"></a>کدهای وضعیتی که با عدد 2 شروع می شوند بیانگر موفقیت درخواست ارسال شده می باشند. کدهایی که با 4 شروع می شوند به این معنا هستند که در درخواست مشکلی وجود داشته است. 404 احتمالا معروف ترین کد وضعیت HTTP می‌باشد – به معنای این که منبع درخواستی پیدا نشد. کدهایی که با 5 شروع می شوند به معنای وجود خطا در سرویس دهنده می باشند و اشکال در درخواست نیست.</p>

<p id="headers"><a class="p_ident" id="p_b27hDjmYXQ" href="#p_b27hDjmYXQ" tabindex="-1" role="presentation"></a>اولین خط درخواست یا پاسخ ممکن است شامل تعدادی header یا سرپیام باشد. این خطوط به شکل name: value هستند و اطلاعات بیشتری درباره‌ی درخواست یا پاسخ فراهم می نمایند. سرپیام‌های زیر بخشی از پاسخ مثال بودند:</p>

<pre class="snippet cm-s-default" data-language="null" ><a class="c_ident" id="c_1ObQMSreRj" href="#c_1ObQMSreRj" tabindex="-1" role="presentation"></a>Content-Length: 65585
Content-Type: text/html
Last-Modified: Thu, 04 Jan 2018 14:05:30 GMT</pre>

<p><a class="p_ident" id="p_VGkIah1M2O" href="#p_VGkIah1M2O" tabindex="-1" role="presentation"></a>این پیام اندازه و نوع سند پاسخ را مشخص می کند. در این مثال، این پاسخ، سندی HTML به اندازه‌ی 65585 بایت می‌باشد. همچنین زمان آخرین تغییر ایجاد شده در سند نیز آمده است.</p>

<p><a class="p_ident" id="p_Q6uXkh/zT4" href="#p_Q6uXkh/zT4" tabindex="-1" role="presentation"></a>استفاده از بیشتر این سرپیام‌ها برای سرویس‌دهنده و سرویس‌گیرنده اختیاری است. اما تعداد کمی از آن ها اجباری می باشند. به عنوان مثال، سرپیام Host که بیانگر نام میزبان (hostname) است باید در درخواست وجود داشته باشد چرا که یک سرویس دهنده ممکن است به چندین نام میزبان رو یک آدرس IP سرویس‌دهی کند، که در صورت مشخص نبودن آن سرپیام، سرویس‌دهنده نمی تواند تشخیص دهد که درخواست سرویس‌گیرنده مربوط به کدام نام میزبان می‌باشد.</p>

<p><a class="p_ident" id="p_SaNq0C7YhV" href="#p_SaNq0C7YhV" tabindex="-1" role="presentation"></a>بعد از قسمت سرپیام‌ها، در هر دوی درخواست و پاسخ، یک خط خالی قرار می گیرد که بعد از آن بدنه خواهد آمد که حاوی داده‌هایی است که ارسال می شوند. در درخواست‌های GET و DELETE هیچ دادهای ارسال نمی شود اما در PUT و POST این گونه نیست. به طور مشابه، بعضی از انواع پاسخ، مثل پاسخ‌های خطا، دارای قسمت بدنه نمی باشند.</p>

<h2><a class="h_ident" id="h_bornDKgqvX" href="#h_bornDKgqvX" tabindex="-1" role="presentation"></a>مرورگرها و HTTP</h2>

<p><a class="p_ident" id="p_Ibq9sGXG9B" href="#p_Ibq9sGXG9B" tabindex="-1" role="presentation"></a>همانطور که در مثال دیدیم، یک مرورگر وقتی که ما یک URL را در نوار آدرسش وارد می کنیم، یک درخواست می سازد. زمانی که صفحه‌ی HTML دریافتی، به فایل‌های دیگری ارجاع دارد مثل تصاویر و فایل‌های جاوااسکریپت ، آن فایل‌ها نیز بازیابی می شوند.</p>

<p><a class="p_ident" id="p_/YhsCWaJRs" href="#p_/YhsCWaJRs" tabindex="-1" role="presentation"></a>یک وب‌سایت نسبتا بزرگ به آسانی می تواند دارای چیزی بین 10 تا 200 منبع باشد. برای اینکه بتوان این منابع را به سرعت بارگیری کرد، مرورگر چندین درخواست GET را همزمان ارسال می کند به جای اینکه برای تک تک پاسخ‌ها منتظر بماند.</p>

<p><a class="p_ident" id="p_n3OM6EV/KR" href="#p_n3OM6EV/KR" tabindex="-1" role="presentation"></a>صفحات HTML ممکن است حاوی فرم‌ها باشند که این امکان را به کاربر می دهند تا اطلاعاتی را در آن ها نوشته و به سرویس‌دهنده ارسال کنند. اینجا مثالی از یک فرم را مشاهده می کنید:</p>

<pre class="snippet cm-s-default" data-language="text/html" ><a class="c_ident" id="c_feixSy0wew" href="#c_feixSy0wew" tabindex="-1" role="presentation"></a><span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">form</span> <span class="cm-attribute">method</span>=<span class="cm-string">&quot;GET&quot;</span> <span class="cm-attribute">action</span>=<span class="cm-string">&quot;example/message.html&quot;</span><span class="cm-tag cm-bracket">&gt;</span>
  <span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">p</span><span class="cm-tag cm-bracket">&gt;</span>Name: <span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">input</span> <span class="cm-attribute">type</span>=<span class="cm-string">&quot;text&quot;</span> <span class="cm-attribute">name</span>=<span class="cm-string">&quot;name&quot;</span><span class="cm-tag cm-bracket">&gt;</span><span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">p</span><span class="cm-tag cm-bracket">&gt;</span>
  <span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">p</span><span class="cm-tag cm-bracket">&gt;</span>Message:<span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">br</span><span class="cm-tag cm-bracket">&gt;</span><span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">textarea</span> <span class="cm-attribute">name</span>=<span class="cm-string">&quot;message&quot;</span><span class="cm-tag cm-bracket">&gt;</span><span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">textarea</span><span class="cm-tag cm-bracket">&gt;</span><span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">p</span><span class="cm-tag cm-bracket">&gt;</span>
  <span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">p</span><span class="cm-tag cm-bracket">&gt;</span><span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">button</span> <span class="cm-attribute">type</span>=<span class="cm-string">&quot;submit&quot;</span><span class="cm-tag cm-bracket">&gt;</span>Send<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">button</span><span class="cm-tag cm-bracket">&gt;</span><span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">p</span><span class="cm-tag cm-bracket">&gt;</span>
<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">form</span><span class="cm-tag cm-bracket">&gt;</span></pre>

<p><a class="p_ident" id="p_PlDa3N681D" href="#p_PlDa3N681D" tabindex="-1" role="presentation"></a>این کد فرمی با دو فیلد را تولید می کند: یک فیلد کوچک که نام را درخواست می کند و فیلدی بزرگتر که امکان نوشتن پیام را فراهم می‌سازد. زمانی که روی دکمه‌ی Send کلیک می کنید، فرم ثبت می شود (submit) به این معنا که محتوای فیلدهای آن به صورت یک درخواست HTTP در آمده و ارسال می شود و مرورگر به محل نتیجه‌ی درخواست منتقل می شود.</p>

<p><a class="p_ident" id="p_2w2cGAh/+O" href="#p_2w2cGAh/+O" tabindex="-1" role="presentation"></a>زمانی که خاصیت <code>method</code> مربوط به عنصر <code>&lt;form&gt;</code> برابر با <code>GET</code> باشد ( یا اینکه اصلا ذکر نشود)، اطلاعات فرم به انتهای URL مشخص شده در خاصیت <code>action</code> به عنوان یک رشته‌ی پرس‌جو (query string) اضافه می شود. مرورگر ممکن است درخواستی به این URL به شکل زیر ایجاد کند:</p>

<pre class="snippet cm-s-default" data-language="null" ><a class="c_ident" id="c_1RUljJwVrY" href="#c_1RUljJwVrY" tabindex="-1" role="presentation"></a>GET /example/message.html?name=Jean&amp;message=Yes%3F HTTP/1.1</pre>

<p><a class="p_ident" id="p_JKhrBKn1DF" href="#p_JKhrBKn1DF" tabindex="-1" role="presentation"></a>علامت سوال بیانگر انتهای قسمت مسیر مربوط به URL و شروع رشته‌ی پرس و جو می‌باشد. بعد از آن جفت‌های نام و مقدار که متناظر با خاصیت name در فیلدهای فرم و محتوای آن عناصر می‌باشند به ترتیب می آیند. کاراکتر آمپرسند(<code>&amp;</code>) برای جداسازی جفت‌ها استفاده می شود.</p>

<p><a class="p_ident" id="p_SKRHIAvgrL" href="#p_SKRHIAvgrL" tabindex="-1" role="presentation"></a>پیام اصلی که در URL منتقل می شود “?Yes” است اما علامت سوال با یک کد رمزی جایگزین شده است. بعضی از کاراکترهای موجود در رشته‌های پرس و جو باید گریز داده شوند. علامت سوال که به صورت <bdo><code>%3F</code></bdo> در آمده است یکی از آن ها است. به نظر یک قانون نانوشته وجود دارد که هر فرمتی روش گریزدهی کاراکتر مخصوص به خود را لازم دارد. در این مورد، که کدگذاری URL نامیده می شود (URL Encoding) از یک علامت درصد و دو رقم هگزادسیمال (مبنای 16) برای کدگذاری کد کاراکتر استفاده می شود. در این مورد، 3F که در سیستم دهدهی معادل 63 می‌باشد، کد کاراکتر علامت سوال است. جاوااسکریپت دو تابع <code>encodeURIComponent</code> و <code>decodeURIComponent</code> را برای کدگذاری و کدگشایی از این فرمت فراهم نموده است.</p>

<pre class="snippet cm-s-default" data-language="javascript" ><a class="c_ident" id="c_v2cBL8Tnwf" href="#c_v2cBL8Tnwf" tabindex="-1" role="presentation"></a><span class="cm-variable">console</span>.<span class="cm-property">log</span>(<span class="cm-variable">encodeURIComponent</span>(<span class="cm-string">&quot;Yes?&quot;</span>));
<span class="cm-comment">// → Yes%3F</span>
<span class="cm-variable">console</span>.<span class="cm-property">log</span>(<span class="cm-variable">decodeURIComponent</span>(<span class="cm-string">&quot;Yes%3F&quot;</span>));
<span class="cm-comment">// → Yes?</span></pre>

<p><a class="p_ident" id="p_DKHvG3G6b/" href="#p_DKHvG3G6b/" tabindex="-1" role="presentation"></a>اگر خاصیت <code>method</code> را در فرم HTML مثالی که دیدیم به <code>POST</code> تغییر دهیم، درخواست HTTP ساخته شده از روش <code>POST</code> استفاده می کند و رشته‌ی پرس‌وجو را در قسمت بدنه‌ی درخواست قرار می دهد تا اینکه در URL اضافه کند.</p>

<pre class="snippet cm-s-default" data-language="http" ><a class="c_ident" id="c_5Xyh6tIq0d" href="#c_5Xyh6tIq0d" tabindex="-1" role="presentation"></a>POST /example/message.html HTTP/1.1
Content-length: 24
Content-type: application/x-www-form-urlencoded

name=Jean&amp;message=Yes%3F</pre>

<p><a class="p_ident" id="p_GWayBsLrL+" href="#p_GWayBsLrL+" tabindex="-1" role="presentation"></a>درخواست‌های GET بهتر است برای درخواست‌هایی استفاده شوند که اثرات جانبی ندارند و فقط برای درخواست اطلاعات استفاده می شوند. درخواست‌هایی که قرار است چیزی را روی سرویس دهنده تغییر دهند ، مثلا حساب کاربری جدیدی ایجاد کنند یا پیامی را ارسال کنند، باید با دیگر روش ها مثل <code>POST</code> ارسال شوند. یک نرم افزار سمت کاربر (client-side) مثل مرورگر می داند که نباید به صورت کورکورانه درخواست‌های <code>POST</code> ارسال می کند اما به صورت ضمنی درخواست‌های <code>GET</code> ایجاد کند – به عنوان مثال برای پیش‌واکشی یک منبع که کاربر به زودی به آن نیاز خواهد داشت.</p>

<p>به فرم‌ها و نحوه‌ی تعامل با آن ها به وسیله‌ی جاوااسکریپت <a href="18_http.html#forms">در همین فصل</a> باز خواهیم گشت.</p>

<h2 id="fetch"><a class="h_ident" id="h_1Iqv5okrKE" href="#h_1Iqv5okrKE" tabindex="-1" role="presentation"></a>Fetch</h2>

<p><a class="p_ident" id="p_SoLS1byDyt" href="#p_SoLS1byDyt" tabindex="-1" role="presentation"></a>رابطی‌ را که از طریق آن، جاوااسکریپت مرورگر می تواند درخواست‌های HTTP بسازد، <code>fetch</code> می نامند. به دلیل اینکه این رابط نسبتا جدید است، به خوبی از promise ها استفاده می کند ( که در رابط های مرورگر چیز نادری است).</p>

<pre class="snippet cm-s-default" data-language="javascript" ><a class="c_ident" id="c_RHiMHW5ptB" href="#c_RHiMHW5ptB" tabindex="-1" role="presentation"></a><span class="cm-variable">fetch</span>(<span class="cm-string">&quot;example/data.txt&quot;</span>).<span class="cm-property">then</span>(<span class="cm-def">response</span> <span class="cm-operator">=&gt;</span> {
  <span class="cm-variable">console</span>.<span class="cm-property">log</span>(<span class="cm-variable-2">response</span>.<span class="cm-property">status</span>);
  <span class="cm-comment">// → 200</span>
  <span class="cm-variable">console</span>.<span class="cm-property">log</span>(<span class="cm-variable-2">response</span>.<span class="cm-property">headers</span>.<span class="cm-property">get</span>(<span class="cm-string">&quot;Content-Type&quot;</span>));
  <span class="cm-comment">// → text/plain</span>
});</pre>

<p><a class="p_ident" id="p_jC/YRC/GWd" href="#p_jC/YRC/GWd" tabindex="-1" role="presentation"></a>فراخوانی <code>fetch</code> یک promise را برمی گرداند که به یک شیء <code>Response</code> منجر می شود که حاوی اطلاعاتی درباره‌ی پاسخ سرویس‌دهنده است، مثل کد وضعیت آن و سرپیام‌هایش. سرپیام‌ها درون یک شیء شبیه <code>Map</code> قرار می گیرند که نسبت به بزرگی و کوچکی حروف کلیدهایش (نام سرپیام‌ها) حساس نیست چرا که نام سرپیام ها لزومی ندارد به حروف حساس باشد. به این معنا که <bdo><code>headers.<wbr>get(&quot;Content-Type&quot;)</code></bdo> و <bdo><code>headers.<wbr>get(&quot;content-TYPE&quot;)</code></bdo> مقدار مشابهی را برمی گردانند.</p>

<p>توجه داشته باشید که promise برگشتی از <code>fetch</code> به صورت موفقیت‌آمیز حل‌وفصل می‌شود حتی اگر سرویس دهنده با کد خطا پاسخ داده باشد. همچنین ممکن است لغو شود، اگر خطایی در شبکه رخ بدهد یا سرویس‌دهنده‌ای که درخواست به آن ارسال می شود پیدا نشود.</p>

<p><a class="p_ident" id="p_cd+18kup26" href="#p_cd+18kup26" tabindex="-1" role="presentation"></a>اولین آرگومانی که fetch دریافت می کند URLای است که مورد درخواست است. زمانی که این URL با نام یک پروتوکل شروع نمی شود (مثل <bdo><em>http:</em></bdo>)، به صورت نسبی در نظر گرفته می شود، به این معنا که آدرس نسبت به موقعیت سند فعلی تفسیر می شود. اگر این URL با یک کاراکتر اسلش (/) شروع شود، جایگزین مسیر فعلی خواهد شد منظور بخشی است که پس از نام سرویس‌دهنده در URL می‌آید. در صورت نبود اسلش در ابتدا، مسیر فعلی تا آخرین کاراکتر اسلش، پیش از URL نسبی داده شده قرار خواهد گرفت.</p>

<p><a class="p_ident" id="p_FykHZel6vX" href="#p_FykHZel6vX" tabindex="-1" role="presentation"></a>برای دریافت محتوای اصلی یک پاسخ، می توانید از متد <code>text</code> آن استفاده کنید. به دلیل اینکه promise اولیه، به محض اینکه سرپیام‌های پاسخ دریافت شوند، حل و فصل می شود، و خواندن بدنه‌ی پاسخ ممکن است زمان بیشتری بطلبد، دوباره به شکل یک promise برگردانده می شود.</p>

<pre class="snippet cm-s-default" data-language="javascript" ><a class="c_ident" id="c_p/pN7BXNbA" href="#c_p/pN7BXNbA" tabindex="-1" role="presentation"></a><span class="cm-variable">fetch</span>(<span class="cm-string">&quot;example/data.txt&quot;</span>)
  .<span class="cm-property">then</span>(<span class="cm-def">resp</span> <span class="cm-operator">=&gt;</span> <span class="cm-variable-2">resp</span>.<span class="cm-property">text</span>())
  .<span class="cm-property">then</span>(<span class="cm-def">text</span> <span class="cm-operator">=&gt;</span> <span class="cm-variable">console</span>.<span class="cm-property">log</span>(<span class="cm-variable-2">text</span>));
<span class="cm-comment">// → This is the content of data.txt</span></pre>

<p><a class="p_ident" id="p_ExyQ+tHsTb" href="#p_ExyQ+tHsTb" tabindex="-1" role="presentation"></a>متد مشابهی به نام <code>json</code> وجود دارد که promiseای برمی گرداند که زمانی موفق به تولید مقدار می شود که بدنه را بتوان به عنوان JSON تفسیر کرد، و اگر محتوای بدنه یک JSON معتبر نباشد، promise لغو می شود.</p>

<p>به صورت پیش‌فرض، <code>fetch</code> از روش <code>GET</code> برای ساختن درخواست‌هایش استفاده می کند و بدنه‌ای برای درخواست درنظر نمی گیرد. می توانید به صورت دیگری آن را تنظیم کنید؛ به وسیله‌ی ارسال آرگومان دوم که حاوی شیء گزینه‌های بیشتر می‌باشد. به عنوان مثال، این درخواست تلاش می کند تا <code>example/data.txt</code> را حذف کند.</p>

<pre class="snippet cm-s-default" data-language="javascript" ><a class="c_ident" id="c_hrJqISfbr3" href="#c_hrJqISfbr3" tabindex="-1" role="presentation"></a><span class="cm-variable">fetch</span>(<span class="cm-string">&quot;example/data.txt&quot;</span>, {<span class="cm-property">method</span>: <span class="cm-string">&quot;DELETE&quot;</span>}).<span class="cm-property">then</span>(<span class="cm-def">resp</span> <span class="cm-operator">=&gt;</span> {
  <span class="cm-variable">console</span>.<span class="cm-property">log</span>(<span class="cm-variable-2">resp</span>.<span class="cm-property">status</span>);
  <span class="cm-comment">// → 405</span>
});</pre>

<p><a class="p_ident" id="p_XXnkmdrWGa" href="#p_XXnkmdrWGa" tabindex="-1" role="presentation"></a>کد وضعیت 405 به این معنا است که “این متد مجاز نیست”. روش یک سرویس‌دهنده‌ی HTTP برای گفتن “من نمی توانم این کار رو بکنم” است.</p>

<p>برای افزودن یک بدنه‌ی درخواست، می توانید گزینه‌ی <code>body</code> را بیفزایید. برای تنظیم سرپیام‌ها، گزینه‌ای به نام <code>headers</code> وجود دارد. به عنوان مثال، این درخواست یک سرپیام <code>Range</code> را اضافه می‌کند که به سرویس‌دهنده دستور می دهد که فقط بخشی از پاسخ را برگرداند.</p>

<pre class="snippet cm-s-default" data-language="javascript" ><a class="c_ident" id="c_ayu6SNFLBc" href="#c_ayu6SNFLBc" tabindex="-1" role="presentation"></a><span class="cm-variable">fetch</span>(<span class="cm-string">&quot;example/data.txt&quot;</span>, {<span class="cm-property">headers</span>: {<span class="cm-property">Range</span>: <span class="cm-string">&quot;bytes=8-19&quot;</span>}})
  .<span class="cm-property">then</span>(<span class="cm-def">resp</span> <span class="cm-operator">=&gt;</span> <span class="cm-variable-2">resp</span>.<span class="cm-property">text</span>())
  .<span class="cm-property">then</span>(<span class="cm-variable">console</span>.<span class="cm-property">log</span>);
<span class="cm-comment">// → the content</span></pre>

<p><a class="p_ident" id="p_OWDsTKX7Xl" href="#p_OWDsTKX7Xl" tabindex="-1" role="presentation"></a>مرورگر به صورت خودکار چند سرپیام به درخواست اضافه می کند مثل “Host” و آن دسته از سرپیام‌ها که برای سرویس‌دهنده لازم هستند تا بتواند اندازه‌ی بدنه را بداند. اما اضافه کردن سرپیام‌های خودتان معمولا برای افزودن چیزهایی مثل اطلاعات هویت‌سنجی یا اعلام نوع فرمت فایل درخواستی به سرویس‌دهنده، استفاده می شود.</p>

<h2 id="http_sandbox"><a class="h_ident" id="h_QsDQKHf27s" href="#h_QsDQKHf27s" tabindex="-1" role="presentation"></a>سازوکار حفاظتی - HTTP sandboxing</h2>

<p><a class="p_ident" id="p_Jck+pdr3C3" href="#p_Jck+pdr3C3" tabindex="-1" role="presentation"></a>ساختن درخواست‌های HTTP درون اسکریپت‌های صفحه‌ی وب، نگرانی‌هایی در مورد امنیت به وجود می‌آورد. فردی که اسکریپت را کنترل می کند ممکن است نیتی مشابه کسی که اسکریپت در کامپیوترش اجرا می شود، نداشته باشد. به صورت واضح‌تر، اگر من از سایت themafia.org بازدید کنم دوست ندارم که اسکریپت‌های این سایت بتوانند درخواستی به سایت بانک من (mybank.com) ارسال کنند و از اطلاعات شناسایی من در مرورگرم استفاده کنند و دستوراتی برای انتقال پول‌های من به حساب‌های ناشناس اجرا کنند.</p>

<p><a class="p_ident" id="p_ZWtOUecxc0" href="#p_ZWtOUecxc0" tabindex="-1" role="presentation"></a>به همین دلیل، مرورگرها با غیرفعال کردن اجازه‌ی ارسال درخواست HTTP از درون اسکریپت‌ها به دیگر دامنه‌ها( نام هایی مثل themefia.org یا mybank.com) از ما محافظت می کنند.</p>

<p>ممکن است این محدودیت در زمان ساختن سیستم‌هایی که لازم است برای اهداف قانونی به چند دامنه دسترسی داشته باشد آزار دهنده باشد. خوشبختانه، سرویس‌دهنده‌ها می توانند یک سرپیام شبیه مثال زیر را در پاسخ خودشان قرار دهند تا صراحتا به مرورگر اعلام کنند که مشکلی نیست که درخواست از دامنه‌ی دیگری بیاید.</p>

<pre class="snippet cm-s-default" data-language="null" ><a class="c_ident" id="c_kNUaXkbMWE" href="#c_kNUaXkbMWE" tabindex="-1" role="presentation"></a>Access-Control-Allow-Origin: *</pre>

<h2><a class="h_ident" id="h_IVuV9VrdGl" href="#h_IVuV9VrdGl" tabindex="-1" role="presentation"></a>بهره‌مندی از HTTP</h2>

<p>در زمان ساخت سیستمی که لازم است در آن بین یک برنامه‌ی جاوااسکریپت که در مرورگر اجرا می شود (سمت کاربر) و برنامه‌ای که روی سرویس‌دهنده است (سمت سرور) ارتباط برقرار شود، می توان از روش‌های متفاوتی برای مدلسازی این ارتباط استفاده کرد.</p>

<p><a class="p_ident" id="p_WdFFV8wu3m" href="#p_WdFFV8wu3m" tabindex="-1" role="presentation"></a>یکی از مدل‌های رایج، استفاده از فراخوانی‌های رویه از راه دور (<em>remote procedure calls</em>) است. دراین مدل، ارتباط از الگوی فراخوانی نرمال توابع پیروی می کند با این استثناء که تابع در واقع روی کامپیوتر دیگر اجرا می شود. فراخوانی آن شامل ساخت یک درخواست به سرویس‌دهنده و مشخص کردن نام تابع و آرگومان‌های آن می‌باشد. پاسخ به آن درخواست حاوی مقدار بازگشتی است.</p>

<p><a class="p_ident" id="p_9Asn1ri5pP" href="#p_9Asn1ri5pP" tabindex="-1" role="presentation"></a>در مدل فراخوانی از راه دور، HTTP فقط نقش یک وسیله ارتباطی را بازی می کند و شما به احتمال زیاد آن را با یک لایه‌ی تجرید مخفی می کنید.</p>

<p><a class="p_ident" id="p_xW3ivXdHO0" href="#p_xW3ivXdHO0" tabindex="-1" role="presentation"></a>روشی دیگر ساختن سیستم ارتباط برپایه مفهوم منابع و متد‌های HTTP است. به جای اینکه یک رویه‌ی از راه دور به نام <code>addUser</code> فراخوانی شود، از درخواست <code>PUT</code> به <bdo><code>/users/larry</code></bdo> استفاده می کنید. به جای قرار دادن مشخصات آن کاربر در آرگومان‌های تابع، یک فرمت سند JSON تعریف می کنید ( یا از فرمتی موجود استفاده می کنید) که نمایانگر یک کاربر باشد. بدنه‌ی درخواست <code>PUT</code> برای ایجاد یک منبع جدید، سندی به این شکل خواهد بود. یک منبع را می توان با ساختن یک درخواست <code>GET</code> به URL منبع (به عنوان مثال <bdo><code>/users/larry</code></bdo>) واکشی کرد که دوباره سندی که نمایانگر منبع مورد نظر است را بر‌می‌گرداند.</p>

<p><a class="p_ident" id="p_byYn9eS4lD" href="#p_byYn9eS4lD" tabindex="-1" role="presentation"></a>استفاده از روش دوم باعث می شود بتوان از بعضی امکاناتی که HTTP فراهم می کند آسان تر استفاده کرد مثل پشتیبانی از کش کردن منابع (نگه داری یک کپی روی سیستم کاربر برای دسترسی سریع). مفاهیم استفاده شده در HTTP که خوبی طراحی شده اند، می توانند مجموعه‌ی مفیدی از قواعد را برای طراحی رابط سرویس‌دهنده فراهم نمایند.</p>

<h2><a class="h_ident" id="h_+vvooX5LK4" href="#h_+vvooX5LK4" tabindex="-1" role="presentation"></a>امنیت و HTTPS</h2>

<p><a class="p_ident" id="p_PUNRHDDS1x" href="#p_PUNRHDDS1x" tabindex="-1" role="presentation"></a>سفر داده‌ها در اینترنت معمولا در مسیری بلند و پرمخاطره رخ می دهد. برای اینکه داده‌ها به مقصدشان برسند، باید از چیزهای مختلفی مثل Wifi یک کافی شاپ تا شبکه‌هایی که توسط شرکت‌های متنوع و دولت‌ها کنترل می شوند عبور کنند. در هر نقطه‌ای در طول مسیرش می توانند مورد بازرسی یا حتی دستکاری قرار بگیرند.</p>

<p>بعضی اطلاعات باید مخفی بمانند مانند رمز عبور حساب ایمیلتان، یا اطلاعاتی هستند که باید هنگامی که به مقصد می‌رسند دستکاری نشده باشند مانند شماره‌ی حسابی که در سایت بانکتان به آن پول واریز می کنید. HTTP ساده زیاد مناسب این این موارد نیست.</p>

<p><a class="p_ident" id="p_2Y+SgAx83I" href="#p_2Y+SgAx83I" tabindex="-1" role="presentation"></a>پروتوکل امن HTTP که URLها در آن با <bdo><em>https://</em></bdo> شروع می شوند، ترافیک HTTP را به شکلی محافظت می کند که ساختن و دستکاری آن خیلی سخت بشود. قبل از تبادل داده‌ها ، سرویس‌گیرنده تحقیق می کند که سرویس‌دهنده همانی باشد که ادعا می کند و این کار با درخواست از سرور برای فراهم ساختن گواهینامه‌ی رمزی که توسط یک مرجع معتبر صدور گواهینامه صادر شده است و مورد شناسایی مرورگر می‌باشد، انجام می شود. بعد تمامی داده‌هایی که از طریق این ارتباط جابجا می شوند به رمز در می آیند به شکلی که از استراق سمع و مداخله ایمن بمانند.</p>

<p><a class="p_ident" id="p_sxM+GsByWh" href="#p_sxM+GsByWh" tabindex="-1" role="presentation"></a>بنابراین، وقتی این پروتوکل به درستی کار می کند، HTTPS از جعل وب سایت مورد ارتباط توسط شخص ثالث و جاسوسی در ارتباطات شما جلوگیری می‌کند. این پروتوکل کامل و بی نقص نیست، و موارد متنوعی وجود داشته که HTTPS موفقیت آمیز نبوده‌است؛ به دلیل لو رفتن گواهینامه یا دزدیده شدن آن یا نرم‌افزار معیوب، اما به هر حال این پروتوکل بسیار از HTTP ساده امن تر می‌باشد.</p>

<h2 id="forms"><a class="h_ident" id="h_uDdj+746uZ" href="#h_uDdj+746uZ" tabindex="-1" role="presentation"></a>فیلدهای فرم</h2>

<p>فرم ها اساسا برای وب قبل از جاوااسکریپت طراحی شده بوند، تا به وب‌سایت‌ها امکان ارسال اطلاعات ثبت شده توسط کاربر را به صورت یک درخواست HTTP بدهند. این طراحی فرض را بر این می گذارد که تعامل با سرویس‌دهنده همیشه با انتقال به یک صفحه‌ی دیگر رخ می دهد.</p>

<p><a class="p_ident" id="p_AEaGKg4haX" href="#p_AEaGKg4haX" tabindex="-1" role="presentation"></a>اما عناصر فرم هم شبیه به دیگر قسمت‌های صفحه، بخشی از DOM محسوب می شوند و عناصر DOM که فیلدهای فرم را نشان می دهند دارای تعدادی خاصیت و رخداد هستند که در دیگر عناصر موجود نیست. این باعث می شود که بتوان با برنامه‌های جاوااسکریپت این گونه فیلدها را کنترل و رسیدگی کرد و بتوان کارهایی مثل اضافه کردن کارکرد‌های جدید به یک فرم یا استفاده از فرم‌ها و فیلدها به عنوان بلاک‌های سازنده در اپلیکیشن‌های جاوااسکریپت استفاده کرد.</p>

<p><a class="p_ident" id="p_KOo7sblIFS" href="#p_KOo7sblIFS" tabindex="-1" role="presentation"></a>یک فرم وب شامل هر تعداد از فیلدهای ورودی که توسط برچسب <code>&lt;form&gt;</code> محصور می شوند است. HTML امکان داشتن سبک‌های متفاوت و متعددی از فیلدها را فراهم می سازد، از چک‌باکس‌های on/off تا منوهای بازشدنی و فیلدهایی برای ورودی متنی. این کتاب به صورت جامع در مورد همه‌ی انواع فیلدها صحبت نمی کند، اما به صورت کلی نگاهی به آن ها می اندازیم.</p>

<p>خیلی از انواع فیلدها از برچسب <code>&lt;input&gt;</code> استفاده می کنند. خصوصیت <code>type</code> این برچسب برای انتخاب سبک فیلد استفاده می شود. اینجا بعضی از انواع <code>&lt;input&gt;</code> رایج آورده شده است:</p>

<table>

<tr><td><code>text</code></td><td>یک فیلد یک خطی برای دریافت متن</td>

</tr>

<tr><td><code>password</code></td><td>فیلدی شبیه به text با این تفاوت که متن تایپ‌شده قابل شناسایی نیست</td>

</tr>

<tr><td><code>checkbox</code></td><td>فیلدی دارای دو حالت فعال و غیرفعال</td>

</tr>

<tr><td><code>radio</code></td><td>بخشی از یک فیلد چند گزینه‌ای</td>

</tr>

<tr><td><code>file</code></td><td>این فیلد به کاربر اجازه‌ی انتخاب یک فایل از کامپیوترش را می دهد</td>

</tr>

</table>

<p><a class="p_ident" id="p_0As5gVwYfY" href="#p_0As5gVwYfY" tabindex="-1" role="presentation"></a>فیلدهای فرم نیازی نیست حتما درون یک برچسب <code>&lt;form&gt;</code> قرار گیرند. می توانید آن ها در هر جای صفحه استفاده کنید. استفاده بدون برچسب form از فیلدها باعث می شود که نتوان آن ها را به صورت نرمال ثبت کرد ( فقط یک فرم به شکل کامل قابلیت ثبت را دارد)، اما در مواقع کار با فیلدهای ورودی در جاوااسکریپت ، اغلب قصد ثبت فیلدهایمان به صورت نرمال نداریم.</p>

<pre class="snippet cm-s-default" data-language="text/html" ><a class="c_ident" id="c_BwDEUfcPYP" href="#c_BwDEUfcPYP" tabindex="-1" role="presentation"></a><span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">p</span><span class="cm-tag cm-bracket">&gt;</span><span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">input</span> <span class="cm-attribute">type</span>=<span class="cm-string">&quot;text&quot;</span> <span class="cm-attribute">value</span>=<span class="cm-string">&quot;abc&quot;</span><span class="cm-tag cm-bracket">&gt;</span> (text)<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">p</span><span class="cm-tag cm-bracket">&gt;</span>
<span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">p</span><span class="cm-tag cm-bracket">&gt;</span><span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">input</span> <span class="cm-attribute">type</span>=<span class="cm-string">&quot;password&quot;</span> <span class="cm-attribute">value</span>=<span class="cm-string">&quot;abc&quot;</span><span class="cm-tag cm-bracket">&gt;</span> (password)<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">p</span><span class="cm-tag cm-bracket">&gt;</span>
<span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">p</span><span class="cm-tag cm-bracket">&gt;</span><span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">input</span> <span class="cm-attribute">type</span>=<span class="cm-string">&quot;checkbox&quot;</span> <span class="cm-attribute">checked</span><span class="cm-tag cm-bracket">&gt;</span> (checkbox)<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">p</span><span class="cm-tag cm-bracket">&gt;</span>
<span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">p</span><span class="cm-tag cm-bracket">&gt;</span><span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">input</span> <span class="cm-attribute">type</span>=<span class="cm-string">&quot;radio&quot;</span> <span class="cm-attribute">value</span>=<span class="cm-string">&quot;A&quot;</span> <span class="cm-attribute">name</span>=<span class="cm-string">&quot;choice&quot;</span><span class="cm-tag cm-bracket">&gt;</span>
   <span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">input</span> <span class="cm-attribute">type</span>=<span class="cm-string">&quot;radio&quot;</span> <span class="cm-attribute">value</span>=<span class="cm-string">&quot;B&quot;</span> <span class="cm-attribute">name</span>=<span class="cm-string">&quot;choice&quot;</span> <span class="cm-attribute">checked</span><span class="cm-tag cm-bracket">&gt;</span>
   <span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">input</span> <span class="cm-attribute">type</span>=<span class="cm-string">&quot;radio&quot;</span> <span class="cm-attribute">value</span>=<span class="cm-string">&quot;C&quot;</span> <span class="cm-attribute">name</span>=<span class="cm-string">&quot;choice&quot;</span><span class="cm-tag cm-bracket">&gt;</span> (radio)<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">p</span><span class="cm-tag cm-bracket">&gt;</span>
<span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">p</span><span class="cm-tag cm-bracket">&gt;</span><span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">input</span> <span class="cm-attribute">type</span>=<span class="cm-string">&quot;file&quot;</span><span class="cm-tag cm-bracket">&gt;</span> (file)<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">p</span><span class="cm-tag cm-bracket">&gt;</span></pre>

<p>رابط جاوااسکریپت برای این گونه عناصر بسته به نوع عنصر متفاوت است.</p>

<p><a class="p_ident" id="p_LDF80HNdkE" href="#p_LDF80HNdkE" tabindex="-1" role="presentation"></a>فیلدهای متنی چند خطی برچسب مخصوص خودشان را دارند، <code>&lt;textarea&gt;</code>، بیشتر به دلیل اینکه قرار دادن یک مقدار چند خطی در قسمت خصوصیت‌ها (attribute) مناسب نیست. برچسب <code>&lt;textarea&gt;</code> نیاز به برچسب پایانی <bdo><code>&lt;/<wbr>textarea&gt;</code></bdo> دارد و از متن بین این دو برچسب به جای خاصیت <code>value</code> استفاده می کند.</p>

<pre class="snippet cm-s-default" data-language="text/html" ><a class="c_ident" id="c_ta2qUMw3tQ" href="#c_ta2qUMw3tQ" tabindex="-1" role="presentation"></a><span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">textarea</span><span class="cm-tag cm-bracket">&gt;</span>
one
two
three
<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">textarea</span><span class="cm-tag cm-bracket">&gt;</span></pre>

<p>و در نهایت، برچسب <code>&lt;select&gt;</code> برای ایجاد فیلدی که امکان انتخاب از بین تعدادی گزینه‌ی از پیش تعریف شده را به کاربر می دهد استفاده می شود.</p>

<pre class="snippet cm-s-default" data-language="text/html" ><a class="c_ident" id="c_ZxJgtmof49" href="#c_ZxJgtmof49" tabindex="-1" role="presentation"></a><span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">select</span><span class="cm-tag cm-bracket">&gt;</span>
  <span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">option</span><span class="cm-tag cm-bracket">&gt;</span>Pancakes<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">option</span><span class="cm-tag cm-bracket">&gt;</span>
  <span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">option</span><span class="cm-tag cm-bracket">&gt;</span>Pudding<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">option</span><span class="cm-tag cm-bracket">&gt;</span>
  <span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">option</span><span class="cm-tag cm-bracket">&gt;</span>Ice cream<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">option</span><span class="cm-tag cm-bracket">&gt;</span>
<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">select</span><span class="cm-tag cm-bracket">&gt;</span></pre>

<p>هر زمان که مقدار یک فیلد فرم تغییر کند، یک رخداد <code>&quot;change&quot;</code> ایجاد می شود.</p>

<h2><a class="h_ident" id="h_/n9VuL9o/U" href="#h_/n9VuL9o/U" tabindex="-1" role="presentation"></a>Focus</h2>

<p><a class="p_ident" id="p_9EKJCnmjJs" href="#p_9EKJCnmjJs" tabindex="-1" role="presentation"></a>برخلاف بیشتر عناصر موجود در اسناد HTML، فیلدهای فرم را می توان با <em>صفحه‌ی کلید</em> <em>فعال</em> (focus) کرد. زمانی که با کلیک موس یا روشی دیگر این عناصر فعال می شوند در دسترس ورودی صفحه‌ی کلید قرار می گیرند.</p>

<p>بنابراین زمانی می توانید درون یک فیلد متنی چیزی تایپ کنید که در مرورگر فعال (مورد تمرکز) باشد. دیگر فیلدها به رخدادهای صفحه‌کلید به شکلی متفاوت پاسخ می دهند. به عنوان مثال در <code>&lt;select&gt;</code> با تایپ متن توسط کاربر این فیلد تلاش می کند تا گزینه‌ای که محتوای تایپ شده را دارد انتخاب شود و با کلیدهای جهت دار می توان گزینه‌ی انتخابی را تغییر داد.</p>

<p>می توانیم فعال بودن یک فیلد را با جاوااسکریپت به وسیله‌ی متدهای <code>focus</code> و <code>blur</code> کنترل کنیم. اولین متد عنصری که روی آن فراخوانی شده را فعال می کند و دومی از حالت فعال آن را خارج می کند. مقداری که در <bdo><code>document.<wbr>activeElement</code></bdo> قرار دارد متناظر با عنصری است که در حال حاضر فعال می‌باشد.</p>

<pre class="snippet cm-s-default" data-language="text/html" ><a class="c_ident" id="c_QrBgwnycJO" href="#c_QrBgwnycJO" tabindex="-1" role="presentation"></a><span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">input</span> <span class="cm-attribute">type</span>=<span class="cm-string">&quot;text&quot;</span><span class="cm-tag cm-bracket">&gt;</span>
<span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">script</span><span class="cm-tag cm-bracket">&gt;</span>
  <span class="cm-variable">document</span>.<span class="cm-property">querySelector</span>(<span class="cm-string">&quot;input&quot;</span>).<span class="cm-property">focus</span>();
  <span class="cm-variable">console</span>.<span class="cm-property">log</span>(<span class="cm-variable">document</span>.<span class="cm-property">activeElement</span>.<span class="cm-property">tagName</span>);
  <span class="cm-comment">// → INPUT</span>
  <span class="cm-variable">document</span>.<span class="cm-property">querySelector</span>(<span class="cm-string">&quot;input&quot;</span>).<span class="cm-property">blur</span>();
  <span class="cm-variable">console</span>.<span class="cm-property">log</span>(<span class="cm-variable">document</span>.<span class="cm-property">activeElement</span>.<span class="cm-property">tagName</span>);
  <span class="cm-comment">// → BODY</span>
<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">script</span><span class="cm-tag cm-bracket">&gt;</span></pre>

<p>برای بعضی صفحات، انتظار می رود که کاربر بلافاصله به سراغ یک فیلد فرم برود. جاوااسکریپت می تواند برای فعال سازی این فیلد بعد از بارگیری سند استفاده شود، HTML نیز خاصیتی به نام <code>autofocus</code> فراهم می کند که همین اثر را دارد و به مرورگر اعلام می کند که قصد داریم کدام فیلد فعال باشد. این گزینه این امکان را برای مرورگر فراهم می سازد که این رفتار را در مواقعی که مناسب نیست غیرفعال کند، مثل زمانی که کاربر به سراغ فیلد دیگری رفته است.</p>

<p><a class="p_ident" id="p_LXkxKSpOsu" href="#p_LXkxKSpOsu" tabindex="-1" role="presentation"></a>مرورگرها به شکلی سنتی به کاربر اجازه می دهند تا فیلدهای دیگر را با استفاده از کلید <span class="keyname">tab</span> فعال کند. می توانیم با استفاده از خاصیت <code>tabindex</code>، به ترتیب این فعال‌سازی اثر بگذاریم . در مثال پیش رو، در سند مشخص می شود که حالت فعال فیلد بعد از فیلد متنی به جای لینک help، به دکمه‌ی OK منتقل شود.</p>

<pre class="snippet cm-s-default" data-language="text/html"  data-focus="true"><a class="c_ident" id="c_DXorT/vrbR" href="#c_DXorT/vrbR" tabindex="-1" role="presentation"></a><span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">input</span> <span class="cm-attribute">type</span>=<span class="cm-string">&quot;text&quot;</span> <span class="cm-attribute">tabindex</span>=<span class="cm-string">1</span><span class="cm-tag cm-bracket">&gt;</span> <span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">a</span> <span class="cm-attribute">href</span>=<span class="cm-string">&quot;.&quot;</span><span class="cm-tag cm-bracket">&gt;</span>(help)<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">a</span><span class="cm-tag cm-bracket">&gt;</span>
<span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">button</span> <span class="cm-attribute">onclick</span>=<span class="cm-string">&quot;console.log('ok')&quot;</span> <span class="cm-attribute">tabindex</span>=<span class="cm-string">2</span><span class="cm-tag cm-bracket">&gt;</span>OK<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">button</span><span class="cm-tag cm-bracket">&gt;</span></pre>

<p><a class="p_ident" id="p_pbEhhfuWTq" href="#p_pbEhhfuWTq" tabindex="-1" role="presentation"></a>به صورت پیش‌فرض، بیشتر انواع عناصر HTML نمی توانند فعال شوند (focus). اما می توانید از <code>tabindex</code> در همه‌ی عناصر استفاده کنید که باعث می شود بتوان به آن ها قابلیت فعال بودن داد. قرار دادن <bdo>-1</bdo> برای <code>tabindex</code> باعث می شود که از آن عنصر صرف نظر شود حتی اگر به صورت نرمال امکان فعال بودن داشته باشد.</p>

<h2><a class="h_ident" id="h_FAsijz7Oq/" href="#h_FAsijz7Oq/" tabindex="-1" role="presentation"></a>فیلد‌های خاموش (disabled)</h2>

<p>می توان تمامی فیلدهای فرم را به وسیله‌ی خاصیت <code>disabled</code> خاموش کرد. این خاصیت را می توان بدون مشخص کردن مقدار به کار برد- همین که وجود داشته باشد باعث خاموش شدن فیلد می شود.</p>

<pre class="snippet cm-s-default" data-language="text/html" ><a class="c_ident" id="c_f++NW8087u" href="#c_f++NW8087u" tabindex="-1" role="presentation"></a><span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">button</span><span class="cm-tag cm-bracket">&gt;</span>I'm all right<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">button</span><span class="cm-tag cm-bracket">&gt;</span>
<span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">button</span> <span class="cm-attribute">disabled</span><span class="cm-tag cm-bracket">&gt;</span>I'm out<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">button</span><span class="cm-tag cm-bracket">&gt;</span></pre>

<p><a class="p_ident" id="p_eJGNyvIsBI" href="#p_eJGNyvIsBI" tabindex="-1" role="presentation"></a>فیلدهای خاموش را نمی توان تغییر داد یا مورد تمرکز (focus) قرار داد. همچنین مرورگرها ظاهر آن ها خاکستری و کم رنگ می کنند.</p>

<p>زمانی که یک برنامه در حال رسیدگی به کاری است که از فشردن یک دکمه یا یک فیلد کنترلی دیگر ایجاد شده، و این‌کار نیازمند ارتباط با سرویس‌دهنده است که در نتیجه نیاز به کمی زمان دارد، بهتر است تا پایان انجام آن کار، فیلد مورد نظر را خاموش کنیم. با این کار ، اگر کاربر صبر نکند و دوباره روی دکمه کلیک کند، به صورت ناخواسته آن کار تکرار نمی شود.</p>

<h2><a class="h_ident" id="h_9IANWQvc7u" href="#h_9IANWQvc7u" tabindex="-1" role="presentation"></a>فرم به عنوان یک کل</h2>

<p>زمانی که یک فیلد درون عنصر <code>&lt;form&gt;</code> قرار می گیرد، عنصر DOM آن خاصیتی به نام <code>form</code> خواهد داشت که به عنصر DOM فرم اشاره می کند. عنصر <code>&lt;form&gt;</code> در عوض، خاصیتی به نام <code>elements</code> دارد که حاوی یک مجموعه‌ی آرایه‌شکل از فیلدهای قرار گرفته در آن می‌باشد.</p>

<p><a class="p_ident" id="p_N3Re16DwBf" href="#p_N3Re16DwBf" tabindex="-1" role="presentation"></a>خاصیت <code>name</code> یک فیلد در فرم، راه شناسایی مقدار آن در زمان ثبت فرم می‌باشد. این خاصیت را همچنین می توان به عنوان نام در زمان دسترسی به خاصیت <code>elements</code> مربوط به فرم استفاده کرد که هم به صورت شیء آرایه‌شکل ( قابل دسترسی با عدد) و هم به صورت یک map (دسترسی با نام).</p>

<pre class="snippet cm-s-default" data-language="text/html" ><a class="c_ident" id="c_2pmbvR5Jhe" href="#c_2pmbvR5Jhe" tabindex="-1" role="presentation"></a><span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">form</span> <span class="cm-attribute">action</span>=<span class="cm-string">&quot;example/submit.html&quot;</span><span class="cm-tag cm-bracket">&gt;</span>
  Name: <span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">input</span> <span class="cm-attribute">type</span>=<span class="cm-string">&quot;text&quot;</span> <span class="cm-attribute">name</span>=<span class="cm-string">&quot;name&quot;</span><span class="cm-tag cm-bracket">&gt;</span><span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">br</span><span class="cm-tag cm-bracket">&gt;</span>
  Password: <span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">input</span> <span class="cm-attribute">type</span>=<span class="cm-string">&quot;password&quot;</span> <span class="cm-attribute">name</span>=<span class="cm-string">&quot;password&quot;</span><span class="cm-tag cm-bracket">&gt;</span><span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">br</span><span class="cm-tag cm-bracket">&gt;</span>
  <span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">button</span> <span class="cm-attribute">type</span>=<span class="cm-string">&quot;submit&quot;</span><span class="cm-tag cm-bracket">&gt;</span>Log in<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">button</span><span class="cm-tag cm-bracket">&gt;</span>
<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">form</span><span class="cm-tag cm-bracket">&gt;</span>
<span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">script</span><span class="cm-tag cm-bracket">&gt;</span>
  <span class="cm-keyword">let</span> <span class="cm-def">form</span> <span class="cm-operator">=</span> <span class="cm-variable">document</span>.<span class="cm-property">querySelector</span>(<span class="cm-string">&quot;form&quot;</span>);
  <span class="cm-variable">console</span>.<span class="cm-property">log</span>(<span class="cm-variable">form</span>.<span class="cm-property">elements</span>[<span class="cm-number">1</span>].<span class="cm-property">type</span>);
  <span class="cm-comment">// → password</span>
  <span class="cm-variable">console</span>.<span class="cm-property">log</span>(<span class="cm-variable">form</span>.<span class="cm-property">elements</span>.<span class="cm-property">password</span>.<span class="cm-property">type</span>);
  <span class="cm-comment">// → password</span>
  <span class="cm-variable">console</span>.<span class="cm-property">log</span>(<span class="cm-variable">form</span>.<span class="cm-property">elements</span>.<span class="cm-property">name</span>.<span class="cm-property">form</span> <span class="cm-operator">==</span> <span class="cm-variable">form</span>);
  <span class="cm-comment">// → true</span>
<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">script</span><span class="cm-tag cm-bracket">&gt;</span></pre>

<p><a class="p_ident" id="p_NnSVHsJkpy" href="#p_NnSVHsJkpy" tabindex="-1" role="presentation"></a>یک دکمه که خاصیت <code>type</code> آن که برابر با <code>submit</code> تنظیم شده، در هنگام فشرده شدن، باعث می شود که فرم ثبت شود. فشردن کلید <span class="keyname">enter</span> روی صفحه کلید وقتی که یک فیلد فرم فعال است نیز همین اثر را به دنبال خواهد داشت.</p>

<p>ثبت یک فرم به صورت نرمال به این صورت است که مرورگر کاربر را به صفحه‌ای که در خاصیت <code>action</code> فرم مشخص شده است، منتقل می‌کند چه درخواست به روش <code>GET</code> باشد چه <code>POST</code>. اما قبل از این اتفاق، یک رخداد <code>&quot;submit&quot;</code> ایجاد می شود. این رخداد را می توان با جاوااسکریپت مدیریت کرد و گرداننده می تواند با فراخوانی <code>preventDefault</code> روی شی رخداد مانع از این رفتار پیش‌فرض شود.</p>

<pre class="snippet cm-s-default" data-language="text/html" ><a class="c_ident" id="c_Zv/K0ruWJS" href="#c_Zv/K0ruWJS" tabindex="-1" role="presentation"></a><span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">form</span> <span class="cm-attribute">action</span>=<span class="cm-string">&quot;example/submit.html&quot;</span><span class="cm-tag cm-bracket">&gt;</span>
  Value: <span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">input</span> <span class="cm-attribute">type</span>=<span class="cm-string">&quot;text&quot;</span> <span class="cm-attribute">name</span>=<span class="cm-string">&quot;value&quot;</span><span class="cm-tag cm-bracket">&gt;</span>
  <span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">button</span> <span class="cm-attribute">type</span>=<span class="cm-string">&quot;submit&quot;</span><span class="cm-tag cm-bracket">&gt;</span>Save<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">button</span><span class="cm-tag cm-bracket">&gt;</span>
<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">form</span><span class="cm-tag cm-bracket">&gt;</span>
<span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">script</span><span class="cm-tag cm-bracket">&gt;</span>
  <span class="cm-keyword">let</span> <span class="cm-def">form</span> <span class="cm-operator">=</span> <span class="cm-variable">document</span>.<span class="cm-property">querySelector</span>(<span class="cm-string">&quot;form&quot;</span>);
  <span class="cm-variable">form</span>.<span class="cm-property">addEventListener</span>(<span class="cm-string">&quot;submit&quot;</span>, <span class="cm-def">event</span> <span class="cm-operator">=&gt;</span> {
    <span class="cm-variable">console</span>.<span class="cm-property">log</span>(<span class="cm-string">&quot;Saving value&quot;</span>, <span class="cm-variable">form</span>.<span class="cm-property">elements</span>.<span class="cm-property">value</span>.<span class="cm-property">value</span>);
    <span class="cm-variable-2">event</span>.<span class="cm-property">preventDefault</span>();
  });
<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">script</span><span class="cm-tag cm-bracket">&gt;</span></pre>

<p>متوقف کردن رخدادهای <code>&quot;submit&quot;</code> در جاوااسکریپت کاربردهای متنوعی دارد. می توانیم کدی بنویسیم که صحت مقادیری که کاربر وارد می کند را بررسی کند و در صورت وجود اشتباه به جای ثبت فرم بلافاصله خطایی نشان دهد. یا می توانیم روش معمول ثبت کردن فرم را غیرفعال کنیم ، به عنوان مثال، و بدون نیاز به بارگیری مجدد صفحه، اطلاعات ورودی را با استفاده از <code>fetch</code> به سرویس‌دهنده ارسال کنیم.</p>

<h2><a class="h_ident" id="h_4N0cfq236H" href="#h_4N0cfq236H" tabindex="-1" role="presentation"></a>فیلدهای متنی</h2>

<p><a class="p_ident" id="p_Yfb0Ie8yZw" href="#p_Yfb0Ie8yZw" tabindex="-1" role="presentation"></a>فیلدهایی که به وسیله‌ی برچسب‌های <code>&lt;input&gt;</code> ایجاد می شوند و نوع <code>text</code> یا <code>password</code> را دارند به همراه برچسب‌های <code>&lt;textarea&gt;</code>، از رابط یکسانی استفاده می کنند. عناصر متناظرشان در DOM دارای خاصیتی به نام <code>value</code> می‌باشد که محتوای کنونی آن ها را به شکل رشته‌ای نگهداری می کند. تغییر این خاصیت و استفاده از رشته‌ای دیگر برای آن محتوای فیلد را تغییر می دهد.</p>

<p><a class="p_ident" id="p_B/+3D1I4tf" href="#p_B/+3D1I4tf" tabindex="-1" role="presentation"></a>دو خاصیت <code>selectionStart</code> و <code>selectionEnd</code> مربوط به فیلدهای متنی اطلاعاتی در رابطه با مکان‌نما و ناحیه‌ی انتخاب شده در متن فراهم می سازند. زمانی که چیزی انتخاب نشده است، این دو خاصیت مقدار عددی یکسانی را نگهداری می کنند که موقعیت مکان نما می باشد. به عنوان مثال، 0 به معنای شروع متن و 10 بیانگر این است که مکان‌نما بعد از کاراکتر دهم همین کاراکتر قرار دارد. زمانی که بخشی از فیلد انتخاب شده باشد، این دو خاصیت مقدار متفاوتی خواهند داشت و بیانگر شروع و پایان متن انتخاب شده می باشند. مثل <code>value</code> این خاصیت‌ها را نیز می توان تغییر داد.</p>

<p><a class="p_ident" id="p_Nf4mxrUK0o" href="#p_Nf4mxrUK0o" tabindex="-1" role="presentation"></a>فرض کنید که در حال نوشتن مقاله‌ای در مورد Khasekhemwy (پادشاهی در مصر باستان) می باشید و در نوشتن نام او دچار مشکل هستید. در کد پیش رو یک برچسب <code>&lt;textarea&gt;</code> و یک گرداننده‌ی رخداد با هم ترکیب می شوند و با فشردن کلید F2 کلمه‌ی “Khasekhemwy” برای شما در فیلد وارد می شود.</p>

<pre class="snippet cm-s-default" data-language="text/html" ><a class="c_ident" id="c_bpWFxEi3zn" href="#c_bpWFxEi3zn" tabindex="-1" role="presentation"></a><span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">textarea</span><span class="cm-tag cm-bracket">&gt;</span><span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">textarea</span><span class="cm-tag cm-bracket">&gt;</span>
<span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">script</span><span class="cm-tag cm-bracket">&gt;</span>
  <span class="cm-keyword">let</span> <span class="cm-def">textarea</span> <span class="cm-operator">=</span> <span class="cm-variable">document</span>.<span class="cm-property">querySelector</span>(<span class="cm-string">&quot;textarea&quot;</span>);
  <span class="cm-variable">textarea</span>.<span class="cm-property">addEventListener</span>(<span class="cm-string">&quot;keydown&quot;</span>, <span class="cm-def">event</span> <span class="cm-operator">=&gt;</span> {
    <span class="cm-comment">// The key code for F2 happens to be 113</span>
    <span class="cm-keyword">if</span> (<span class="cm-variable-2">event</span>.<span class="cm-property">keyCode</span> <span class="cm-operator">==</span> <span class="cm-number">113</span>) {
      <span class="cm-variable">replaceSelection</span>(<span class="cm-variable">textarea</span>, <span class="cm-string">&quot;Khasekhemwy&quot;</span>);
      <span class="cm-variable-2">event</span>.<span class="cm-property">preventDefault</span>();
    }
  });
  <span class="cm-keyword">function</span> <span class="cm-def">replaceSelection</span>(<span class="cm-def">field</span>, <span class="cm-def">word</span>) {
    <span class="cm-keyword">let</span> <span class="cm-def">from</span> <span class="cm-operator">=</span> <span class="cm-variable-2">field</span>.<span class="cm-property">selectionStart</span>, <span class="cm-def">to</span> <span class="cm-operator">=</span> <span class="cm-variable-2">field</span>.<span class="cm-property">selectionEnd</span>;
    <span class="cm-variable-2">field</span>.<span class="cm-property">value</span> <span class="cm-operator">=</span> <span class="cm-variable-2">field</span>.<span class="cm-property">value</span>.<span class="cm-property">slice</span>(<span class="cm-number">0</span>, <span class="cm-variable-2">from</span>) <span class="cm-operator">+</span> <span class="cm-variable-2">word</span> <span class="cm-operator">+</span>
                  <span class="cm-variable-2">field</span>.<span class="cm-property">value</span>.<span class="cm-property">slice</span>(<span class="cm-variable-2">to</span>);
    <span class="cm-comment">// Put the cursor after the word</span>
    <span class="cm-variable-2">field</span>.<span class="cm-property">selectionStart</span> <span class="cm-operator">=</span> <span class="cm-variable-2">from</span> <span class="cm-operator">+</span> <span class="cm-variable-2">word</span>.<span class="cm-property">length</span>;
    <span class="cm-variable-2">field</span>.<span class="cm-property">selectionEnd</span> <span class="cm-operator">=</span> <span class="cm-variable-2">from</span> <span class="cm-operator">+</span> <span class="cm-variable-2">word</span>.<span class="cm-property">length</span>;
  }
<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">script</span><span class="cm-tag cm-bracket">&gt;</span></pre>

<p>تابع <code>replaceSelection</code> بخش انتخاب شده در فیلد متنی را با کلمه‌ی داده شده جایگزین می نماید و بعد مکان‌نما را به بعد از آن کلمه منتقل می کند تا کاربر بتواند به تایپ خود ادامه دهد.</p>

<p>رخداد <code>&quot;change&quot;</code> برای یک فیلد متنی با هر بار نوشتن چیزی ایجاد نمی شود. بلکه زمانی ایجاد می شود که فیلد مذکور بعد از اینکه محتوایش تغییر کرد از حالت focus خارج می شود. برای اینکه بتوان به سرعت به تغییرات در یک فیلد متنی پاسخ داد، باید یک گرداننده برای رخداد <code>&quot;input&quot;</code> ثبت کنید که با تایپ هر کاراکتر توسط کاربر یا حذف آن یا ایجاد هر تغییری در محتوای فیلد ایجاد می شود.</p>

<p>در مثال پیش رو یک فیلد متنی نشان داده می شود و یک شمارنده که طول متن موجود در فیلد را نشان می دهد.</p>

<pre class="snippet cm-s-default" data-language="text/html" ><a class="c_ident" id="c_FW2nBbCoKe" href="#c_FW2nBbCoKe" tabindex="-1" role="presentation"></a><span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">input</span> <span class="cm-attribute">type</span>=<span class="cm-string">&quot;text&quot;</span><span class="cm-tag cm-bracket">&gt;</span> length: <span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">span</span> <span class="cm-attribute">id</span>=<span class="cm-string">&quot;length&quot;</span><span class="cm-tag cm-bracket">&gt;</span>0<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">span</span><span class="cm-tag cm-bracket">&gt;</span>
<span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">script</span><span class="cm-tag cm-bracket">&gt;</span>
  <span class="cm-keyword">let</span> <span class="cm-def">text</span> <span class="cm-operator">=</span> <span class="cm-variable">document</span>.<span class="cm-property">querySelector</span>(<span class="cm-string">&quot;input&quot;</span>);
  <span class="cm-keyword">let</span> <span class="cm-def">output</span> <span class="cm-operator">=</span> <span class="cm-variable">document</span>.<span class="cm-property">querySelector</span>(<span class="cm-string">&quot;#length&quot;</span>);
  <span class="cm-variable">text</span>.<span class="cm-property">addEventListener</span>(<span class="cm-string">&quot;input&quot;</span>, () <span class="cm-operator">=&gt;</span> {
    <span class="cm-variable">output</span>.<span class="cm-property">textContent</span> <span class="cm-operator">=</span> <span class="cm-variable">text</span>.<span class="cm-property">value</span>.<span class="cm-property">length</span>;
  });
<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">script</span><span class="cm-tag cm-bracket">&gt;</span></pre>

<h2><a class="h_ident" id="h_UZtbnKGvfT" href="#h_UZtbnKGvfT" tabindex="-1" role="presentation"></a>فیلد بررسی (checkbox) و دکمه‌های رادیویی</h2>

<p>یک فیلد چک‌باکس، یک فیلد دو حالته است. مقدار آن را می توان به وسیله‌ی خاصیت <code>checked</code> آن تغییر داد یا به‌دست آورد که مقداری بولی می‌باشد.</p>

<pre class="snippet cm-s-default" data-language="text/html" ><a class="c_ident" id="c_QDNdcETI4b" href="#c_QDNdcETI4b" tabindex="-1" role="presentation"></a><span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">label</span><span class="cm-tag cm-bracket">&gt;</span>
  <span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">input</span> <span class="cm-attribute">type</span>=<span class="cm-string">&quot;checkbox&quot;</span> <span class="cm-attribute">id</span>=<span class="cm-string">&quot;purple&quot;</span><span class="cm-tag cm-bracket">&gt;</span> Make this page purple
<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">label</span><span class="cm-tag cm-bracket">&gt;</span>
<span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">script</span><span class="cm-tag cm-bracket">&gt;</span>
  <span class="cm-keyword">let</span> <span class="cm-def">checkbox</span> <span class="cm-operator">=</span> <span class="cm-variable">document</span>.<span class="cm-property">querySelector</span>(<span class="cm-string">&quot;#purple&quot;</span>);
  <span class="cm-variable">checkbox</span>.<span class="cm-property">addEventListener</span>(<span class="cm-string">&quot;change&quot;</span>, () <span class="cm-operator">=&gt;</span> {
    <span class="cm-variable">document</span>.<span class="cm-property">body</span>.<span class="cm-property">style</span>.<span class="cm-property">background</span> <span class="cm-operator">=</span>
      <span class="cm-variable">checkbox</span>.<span class="cm-property">checked</span> <span class="cm-operator">?</span> <span class="cm-string">&quot;mediumpurple&quot;</span> : <span class="cm-string">&quot;&quot;</span>;
  });
<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">script</span><span class="cm-tag cm-bracket">&gt;</span></pre>

<p><a class="p_ident" id="p_ZMZTdNurb+" href="#p_ZMZTdNurb+" tabindex="-1" role="presentation"></a>برچسب <code>&lt;label&gt;</code> یک بخش از سند را به یک فیلد ورودی مرتبط می‌سازد. با کلیک روی label، فیلد مرتبط با آن فعال می شود که باعث می شود مورد تمرکز مرورگر قرار بگیرد یا در مواقعی که یک چک‌باکس یا دکمه‌ی رادیویی باشد مقدارش را تغییر دهد (انتخاب یا از حالت انتخاب خارج می کند)</p>

<p>یک دکمه‌ی رادیویی شبیه به یک چک‌باکس است با این تفاوت که به صورت ضمنی و به وسیله‌ی خاصیت <code>name</code> مشترک به دیگر دکمه‌های رادیویی پیوند می خورد در نتیجه فقط یکی از این دکمه‌ها را می توان در آن واحد فعال داشت.</p>

<pre class="snippet cm-s-default" data-language="text/html" ><a class="c_ident" id="c_tM2CEiReVh" href="#c_tM2CEiReVh" tabindex="-1" role="presentation"></a>Color:
<span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">label</span><span class="cm-tag cm-bracket">&gt;</span>
  <span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">input</span> <span class="cm-attribute">type</span>=<span class="cm-string">&quot;radio&quot;</span> <span class="cm-attribute">name</span>=<span class="cm-string">&quot;color&quot;</span> <span class="cm-attribute">value</span>=<span class="cm-string">&quot;orange&quot;</span><span class="cm-tag cm-bracket">&gt;</span> Orange
<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">label</span><span class="cm-tag cm-bracket">&gt;</span>
<span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">label</span><span class="cm-tag cm-bracket">&gt;</span>
  <span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">input</span> <span class="cm-attribute">type</span>=<span class="cm-string">&quot;radio&quot;</span> <span class="cm-attribute">name</span>=<span class="cm-string">&quot;color&quot;</span> <span class="cm-attribute">value</span>=<span class="cm-string">&quot;lightgreen&quot;</span><span class="cm-tag cm-bracket">&gt;</span> Green
<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">label</span><span class="cm-tag cm-bracket">&gt;</span>
<span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">label</span><span class="cm-tag cm-bracket">&gt;</span>
  <span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">input</span> <span class="cm-attribute">type</span>=<span class="cm-string">&quot;radio&quot;</span> <span class="cm-attribute">name</span>=<span class="cm-string">&quot;color&quot;</span> <span class="cm-attribute">value</span>=<span class="cm-string">&quot;lightblue&quot;</span><span class="cm-tag cm-bracket">&gt;</span> Blue
<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">label</span><span class="cm-tag cm-bracket">&gt;</span>
<span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">script</span><span class="cm-tag cm-bracket">&gt;</span>
  <span class="cm-keyword">let</span> <span class="cm-def">buttons</span> <span class="cm-operator">=</span> <span class="cm-variable">document</span>.<span class="cm-property">querySelectorAll</span>(<span class="cm-string">&quot;[name=color]&quot;</span>);
  <span class="cm-keyword">for</span> (<span class="cm-keyword">let</span> <span class="cm-def">button</span> <span class="cm-keyword">of</span> <span class="cm-variable">Array</span>.<span class="cm-property">from</span>(<span class="cm-variable">buttons</span>)) {
    <span class="cm-variable">button</span>.<span class="cm-property">addEventListener</span>(<span class="cm-string">&quot;change&quot;</span>, () <span class="cm-operator">=&gt;</span> {
      <span class="cm-variable">document</span>.<span class="cm-property">body</span>.<span class="cm-property">style</span>.<span class="cm-property">background</span> <span class="cm-operator">=</span> <span class="cm-variable">button</span>.<span class="cm-property">value</span>;
    });
  }
<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">script</span><span class="cm-tag cm-bracket">&gt;</span></pre>

<p><a class="p_ident" id="p_vLPB+DaD5C" href="#p_vLPB+DaD5C" tabindex="-1" role="presentation"></a>در مثال بالا، استفاده از براکت‌ها در پرس و جوی CSS که به متد <code>querySelectorAll</code> ارسال می شوند برای انتخاب و نشانه‌گرفتن خصوصیت‌های عناصر (attributes)، استفاده می شوند. این پرس و جو عناصری را نتخاب می کند که مقدار خاصیت <code>name</code> شان برابر با <code>“color”</code> باشد.</p>

<h2><a class="h_ident" id="h_vjp2YfTPbr" href="#h_vjp2YfTPbr" tabindex="-1" role="presentation"></a>فیلدهای select (انتخاب گزینه)</h2>

<p><a class="p_ident" id="p_gUSP4nMke1" href="#p_gUSP4nMke1" tabindex="-1" role="presentation"></a>فیلدهای select به طور مفهومی مشابه دکمه‌های رادیویی هستند- این فیلدها هم به کاربر، امکان انتخاب از یک مجموعه گزینه‌ها را می دهند. در حالیکه در یک دکمه‌ی رادیویی چیدمان گزینه‌ها تحت کنترل ما می‌باشد، ظاهر یک برچسب <code>&lt;select&gt;</code> توسط مرورگر تعیین می شود.</p>

<p><a class="p_ident" id="p_xLZH/q2jWp" href="#p_xLZH/q2jWp" tabindex="-1" role="presentation"></a>فیلدهای select همچنین در یک حالت خاص، بیشتر شبیه لیستی از checkboxها می‌باشد تا دکمه‌های رادیویی. اگر خاصیت <code>multiple</code> را به یک برچسب <code>&lt;select&gt;</code> اضافه کنیم، کاربر این امکان را خواهد داشت که به جای یک گزینه بتواند چندین گزینه انتخاب نماید. این شکل از فیلد در بیشتر مرورگرها به صورت متفاوتی نسبت به حالت نرمال یک گزینه‌ای نشان داده می شود. در حالت عادی، این فیلد به صورت یک منوی کشویی (بازشونده) نمایش داده می شود که گزینه‌هایش زمانی دیده می‌شوند که آن را باز نمایید.</p>

<p><a class="p_ident" id="p_iPx3549I/J" href="#p_iPx3549I/J" tabindex="-1" role="presentation"></a>هر برچسب <code>&lt;option&gt;</code> دارای یک مقدار می‌باشد. این مقدار را می توان با خاصیت <code>value</code> تعریف کرد. اگر این خاصیت را مشخص نکنید، متن درون گزینه به عنوان مقدار در نظر گرفته می‌شود. خاصیت <code>value</code> متعلق به عنصر <code>&lt;select&gt;</code> نشان‌دهنده‌ی گزینه‌ی انتخاب شده می‌باشد. برای یک فیلد چند‌گزینه‌ای (multiple) این خاصیت معنای خاصی نخواهد داشت چرا که فقط به <em>یک</em> مقدار از مقادیر انتخاب شده اشاره می کند.</p>

<p>برچسب‌های <code>&lt;option&gt;</code> متعلق به فیلد <code>&lt;select&gt;</code> را می توان از طریق یک شیء آرایه‌گونه و به وسیله‌ی خاصیت <code>options</code> فیلد مورد دسترسی قرار داد. هر گزینه دارای یک خاصیت به نام <code>selected</code> می‌باشد که بیانگر این است که آیا انتخاب شده است یا خیر. این خاصیت را همچنین می توان برای انتخاب کردن یا از انتخاب خارج نمودن یک گزینه‌ نیز استفاده کرد.</p>

<p><a class="p_ident" id="p_rGo2bPn+iH" href="#p_rGo2bPn+iH" tabindex="-1" role="presentation"></a>این مثال مقادیر انتخاب شده را از یک فیلد انتخاب چند‌گزینه‌ای (<code>multiple</code>) استخراج می کند و از آن ها برای نوشتن یک عدد دودویی از بیت‌های جداگانه استفاده می کند. برای انتخاب چندین گزینه کلید <span class="keyname">control</span> (یا <span class="keyname">command</span> در مک) را نگه دارید.</p>

<pre class="snippet cm-s-default" data-language="text/html" ><a class="c_ident" id="c_Jh/nb6UYLR" href="#c_Jh/nb6UYLR" tabindex="-1" role="presentation"></a><span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">select</span> <span class="cm-attribute">multiple</span><span class="cm-tag cm-bracket">&gt;</span>
  <span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">option</span> <span class="cm-attribute">value</span>=<span class="cm-string">&quot;1&quot;</span><span class="cm-tag cm-bracket">&gt;</span>0001<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">option</span><span class="cm-tag cm-bracket">&gt;</span>
  <span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">option</span> <span class="cm-attribute">value</span>=<span class="cm-string">&quot;2&quot;</span><span class="cm-tag cm-bracket">&gt;</span>0010<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">option</span><span class="cm-tag cm-bracket">&gt;</span>
  <span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">option</span> <span class="cm-attribute">value</span>=<span class="cm-string">&quot;4&quot;</span><span class="cm-tag cm-bracket">&gt;</span>0100<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">option</span><span class="cm-tag cm-bracket">&gt;</span>
  <span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">option</span> <span class="cm-attribute">value</span>=<span class="cm-string">&quot;8&quot;</span><span class="cm-tag cm-bracket">&gt;</span>1000<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">option</span><span class="cm-tag cm-bracket">&gt;</span>
<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">select</span><span class="cm-tag cm-bracket">&gt;</span> = <span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">span</span> <span class="cm-attribute">id</span>=<span class="cm-string">&quot;output&quot;</span><span class="cm-tag cm-bracket">&gt;</span>0<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">span</span><span class="cm-tag cm-bracket">&gt;</span>
<span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">script</span><span class="cm-tag cm-bracket">&gt;</span>
  <span class="cm-keyword">let</span> <span class="cm-def">select</span> <span class="cm-operator">=</span> <span class="cm-variable">document</span>.<span class="cm-property">querySelector</span>(<span class="cm-string">&quot;select&quot;</span>);
  <span class="cm-keyword">let</span> <span class="cm-def">output</span> <span class="cm-operator">=</span> <span class="cm-variable">document</span>.<span class="cm-property">querySelector</span>(<span class="cm-string">&quot;#output&quot;</span>);
  <span class="cm-variable">select</span>.<span class="cm-property">addEventListener</span>(<span class="cm-string">&quot;change&quot;</span>, () <span class="cm-operator">=&gt;</span> {
    <span class="cm-keyword">let</span> <span class="cm-def">number</span> <span class="cm-operator">=</span> <span class="cm-number">0</span>;
    <span class="cm-keyword">for</span> (<span class="cm-keyword">let</span> <span class="cm-def">option</span> <span class="cm-keyword">of</span> <span class="cm-variable">Array</span>.<span class="cm-property">from</span>(<span class="cm-variable">select</span>.<span class="cm-property">options</span>)) {
      <span class="cm-keyword">if</span> (<span class="cm-variable-2">option</span>.<span class="cm-property">selected</span>) {
        <span class="cm-variable-2">number</span> <span class="cm-operator">+=</span> <span class="cm-variable">Number</span>(<span class="cm-variable-2">option</span>.<span class="cm-property">value</span>);
      }
    }
    <span class="cm-variable">output</span>.<span class="cm-property">textContent</span> <span class="cm-operator">=</span> <span class="cm-variable-2">number</span>;
  });
<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">script</span><span class="cm-tag cm-bracket">&gt;</span></pre>

<h2><a class="h_ident" id="h_xi8DW4dd/S" href="#h_xi8DW4dd/S" tabindex="-1" role="presentation"></a>فیلدهای انتخاب فایل</h2>

<p>فیلدهای فایل در ابتدا به عنوان راهی برای بارگذاری فایل‌ها از کامپیوتر کاربر به وسیله‌ی یک فرم طراحی شدند. در مرورگرهای مدرن، همچنین این فیلدها راهی برای خواندن این فایل‌ها به وسیله‌ی برنامه‌های جاوااسکریپت فراهم می‌کنند. فیلد انتخاب فایل به عنوان نوعی دربان عمل می کند؛ اسکریپت نمی تواند فایل‌های خصوصی را از کامپیوتر کاربر بخواند، اما اگر کاربر فایلی را به وسیله‌ی این فیلد انتخاب کند، تفسیر مرورگر این خواهد بود که اسکریپت ممکن است فایل انتخاب شده را بخواند.</p>

<p><a class="p_ident" id="p_H7M9nsZADl" href="#p_H7M9nsZADl" tabindex="-1" role="presentation"></a>ظاهر یک فیلد فایل معمولا شبیه به یک دکمه که عنوانی شبیه به “choose a file” یا “browse” را دارد می‌باشد و معمولا اطلاعاتی در باره‌ی فایل انتخاب شده در کنار آن نمایش داده می شود.</p>

<pre class="snippet cm-s-default" data-language="text/html" ><a class="c_ident" id="c_Gg47yko2dF" href="#c_Gg47yko2dF" tabindex="-1" role="presentation"></a><span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">input</span> <span class="cm-attribute">type</span>=<span class="cm-string">&quot;file&quot;</span><span class="cm-tag cm-bracket">&gt;</span>
<span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">script</span><span class="cm-tag cm-bracket">&gt;</span>
  <span class="cm-keyword">let</span> <span class="cm-def">input</span> <span class="cm-operator">=</span> <span class="cm-variable">document</span>.<span class="cm-property">querySelector</span>(<span class="cm-string">&quot;input&quot;</span>);
  <span class="cm-variable">input</span>.<span class="cm-property">addEventListener</span>(<span class="cm-string">&quot;change&quot;</span>, () <span class="cm-operator">=&gt;</span> {
    <span class="cm-keyword">if</span> (<span class="cm-variable">input</span>.<span class="cm-property">files</span>.<span class="cm-property">length</span> <span class="cm-operator">&gt;</span> <span class="cm-number">0</span>) {
      <span class="cm-keyword">let</span> <span class="cm-def">file</span> <span class="cm-operator">=</span> <span class="cm-variable">input</span>.<span class="cm-property">files</span>[<span class="cm-number">0</span>];
      <span class="cm-variable">console</span>.<span class="cm-property">log</span>(<span class="cm-string">&quot;You chose&quot;</span>, <span class="cm-variable-2">file</span>.<span class="cm-property">name</span>);
      <span class="cm-keyword">if</span> (<span class="cm-variable-2">file</span>.<span class="cm-property">type</span>) <span class="cm-variable">console</span>.<span class="cm-property">log</span>(<span class="cm-string">&quot;It has type&quot;</span>, <span class="cm-variable-2">file</span>.<span class="cm-property">type</span>);
    }
  });
<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">script</span><span class="cm-tag cm-bracket">&gt;</span></pre>

<p>خاصیت <code>files</code> مربوط به عنصر فیلد فایل، یک شیء آرایه‌گونه است ( نه یک آرایه‌ی واقعی) که حاوی فایل‌هایی است که در فیلد انتخاب شده اند. در ابتدا این خاصیت خالی است. علت اینکه نام آن <code>file</code> نیست این است که خصوصیتی(attribute) در فیلد فایل وجود دارد به نام <code>multiple</code> که باعث می شود بتوان چندین فایل را به صورت همزمان انتخاب کرد.</p>

<p><a class="p_ident" id="p_/l27zqXOfi" href="#p_/l27zqXOfi" tabindex="-1" role="presentation"></a>اشیائی که در شیء <code>files</code> قرار دارند دارای خاصیت‌هایی مثل <code>name</code> (نام فایل)، <code>size</code> (اندازه فایل به بایت که معادل 8 بیت است) و <code>type</code> (نوع فایل مثل <code>text/plain</code> یا <code>image/jpeg</code>) می باشند.</p>

<p id="filereader"><a class="p_ident" id="p_fXUvLF6VBD" href="#p_fXUvLF6VBD" tabindex="-1" role="presentation"></a>چیزی که در آن وجود ندارد خاصیتی است که محتوای فایل را نگهداری کند. بدست آوردن محتوای فایل کمی پیچیده تر است. به دلیل اینکه خواندن فایل از روی دیسک سخت ممکن است طول بکشد، رابط آن باید به صورت ناهمگام (asynchronous) باشد تا موجب قفل شدن شدن صفحه نشود.</p>

<pre class="snippet cm-s-default" data-language="text/html" ><a class="c_ident" id="c_NWBXf4dpgg" href="#c_NWBXf4dpgg" tabindex="-1" role="presentation"></a><span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">input</span> <span class="cm-attribute">type</span>=<span class="cm-string">&quot;file&quot;</span> <span class="cm-attribute">multiple</span><span class="cm-tag cm-bracket">&gt;</span>
<span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">script</span><span class="cm-tag cm-bracket">&gt;</span>
  <span class="cm-keyword">let</span> <span class="cm-def">input</span> <span class="cm-operator">=</span> <span class="cm-variable">document</span>.<span class="cm-property">querySelector</span>(<span class="cm-string">&quot;input&quot;</span>);
  <span class="cm-variable">input</span>.<span class="cm-property">addEventListener</span>(<span class="cm-string">&quot;change&quot;</span>, () <span class="cm-operator">=&gt;</span> {
    <span class="cm-keyword">for</span> (<span class="cm-keyword">let</span> <span class="cm-def">file</span> <span class="cm-keyword">of</span> <span class="cm-variable">Array</span>.<span class="cm-property">from</span>(<span class="cm-variable">input</span>.<span class="cm-property">files</span>)) {
      <span class="cm-keyword">let</span> <span class="cm-def">reader</span> <span class="cm-operator">=</span> <span class="cm-keyword">new</span> <span class="cm-variable">FileReader</span>();
      <span class="cm-variable-2">reader</span>.<span class="cm-property">addEventListener</span>(<span class="cm-string">&quot;load&quot;</span>, () <span class="cm-operator">=&gt;</span> {
        <span class="cm-variable">console</span>.<span class="cm-property">log</span>(<span class="cm-string">&quot;File&quot;</span>, <span class="cm-variable-2">file</span>.<span class="cm-property">name</span>, <span class="cm-string">&quot;starts with&quot;</span>,
                    <span class="cm-variable-2">reader</span>.<span class="cm-property">result</span>.<span class="cm-property">slice</span>(<span class="cm-number">0</span>, <span class="cm-number">20</span>));
      });
      <span class="cm-variable-2">reader</span>.<span class="cm-property">readAsText</span>(<span class="cm-variable-2">file</span>);
    }
  });
<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">script</span><span class="cm-tag cm-bracket">&gt;</span></pre>

<p><a class="p_ident" id="p_JLVf6B6eex" href="#p_JLVf6B6eex" tabindex="-1" role="presentation"></a>خواندن یک فایل به وسیله‌ی ایجاد شیئی به نام <code>FileReader</code> انجام می شود، که گرداننده‌ی رخداد <code>load</code> برای آن ثبت می شود و متد <code>readAsText</code> آن فراخوانی می شود و فایلی که قصد خواندن آن را داریم به آن داده شود. به محض اینکه بارگیری فایل به اتمام برسد، خاصیت <code>result</code> شیء reader فایل، حاوی محتوای فایل خواهد بود.</p>

<p><a class="p_ident" id="p_FMKuNI/4s+" href="#p_FMKuNI/4s+" tabindex="-1" role="presentation"></a>اشیاء <code>FileReader</code> زمانی که به هر دلیل خواندن فایل با مشکل روبرو شود، یک رخداد <code>“error”</code> ایجاد می کنند . شیء خطا در نهایت در خاصیت <code>error</code> شیء reader قرار می گیرد. این رابط قبل از اضافه شدن promiseها به زبان جاوااسکریپت طراحی شده است .می توانید این کار را در قالب promise به صورت زیر انجام دهید.</p>

<pre class="snippet cm-s-default" data-language="javascript" ><a class="c_ident" id="c_Kr3V9NFjD7" href="#c_Kr3V9NFjD7" tabindex="-1" role="presentation"></a><span class="cm-keyword">function</span> <span class="cm-def">readFileText</span>(<span class="cm-def">file</span>) {
  <span class="cm-keyword">return</span> <span class="cm-keyword">new</span> <span class="cm-variable">Promise</span>((<span class="cm-def">resolve</span>, <span class="cm-def">reject</span>) <span class="cm-operator">=&gt;</span> {
    <span class="cm-keyword">let</span> <span class="cm-def">reader</span> <span class="cm-operator">=</span> <span class="cm-keyword">new</span> <span class="cm-variable">FileReader</span>();
    <span class="cm-variable-2">reader</span>.<span class="cm-property">addEventListener</span>(
      <span class="cm-string">&quot;load&quot;</span>, () <span class="cm-operator">=&gt;</span> <span class="cm-variable-2">resolve</span>(<span class="cm-variable-2">reader</span>.<span class="cm-property">result</span>));
    <span class="cm-variable-2">reader</span>.<span class="cm-property">addEventListener</span>(
      <span class="cm-string">&quot;error&quot;</span>, () <span class="cm-operator">=&gt;</span> <span class="cm-variable-2">reject</span>(<span class="cm-variable-2">reader</span>.<span class="cm-property">error</span>));
    <span class="cm-variable-2">reader</span>.<span class="cm-property">readAsText</span>(<span class="cm-variable-2">file</span>);
  });
}</pre>

<h2><a class="h_ident" id="h_TuYSra01bs" href="#h_TuYSra01bs" tabindex="-1" role="presentation"></a>ذخیره‌ی داده‌ها در سمت کاربر (سرویس‌گیرنده)</h2>

<p>صفحات ساده‌ی HTML با کمی جاوااسکریپت می توانند فرمت خوبی برای اپلیکیشن‌های کوچک باشند – برنامه‌های کمکی کوچکی که بعضی کارها را خودکار می کنند. با ترکیب چند فیلد فرم با گرداننده‌های رخداد، می توانید هر کاری از تبدیل سانتی متر به اینچ گرفته تا محاسبه‌ی رمز‌های عبور از روی یک رمزعبور مادر و نام یک وب‌سایت را انجام دهید.</p>

<p>زمانی که این گونه اپلیکیشن‌ها نیاز به ذخیره و به خاطرسپاری چیزی به صورت پایدار دارند، نمی توانید از متغیرهای جاوااسکریپت استفاده کنید- متغیرها با بسته شدن صفحه‌ی مرورگر از بین می روند. می توانید یک سرویس‌دهنده راه اندازی کنید، آن‌را به اینترنت متصل کنید و اطلاعات اپلیکیشن تان را در آنجا ذخیره کنید. در <a href="20_node.html">فصل 20</a> به چگونگی این کار می پردازیم. اما این روش، کار و پیچیدگی زیادتری می طلبد. گاهی اوقات نگه‌داشتن داده‌ها در خود مرورگر برای کار ما کافی است.</p>

<p>شیء <code>localStorage</code> را می توان برای ذخیره‌ی داده‌ها به صورتی که با بارگیری مجدد صفحه حفظ شوند استفاده کرد. این شیء به شما این امکان را می دهد که مقادیر رشته‌ای را تحت نام‌هایی دسته بندی و ذخیره کنید.</p>

<pre class="snippet cm-s-default" data-language="javascript" ><a class="c_ident" id="c_zS9vKuxYED" href="#c_zS9vKuxYED" tabindex="-1" role="presentation"></a><span class="cm-variable">localStorage</span>.<span class="cm-property">setItem</span>(<span class="cm-string">&quot;username&quot;</span>, <span class="cm-string">&quot;marijn&quot;</span>);
<span class="cm-variable">console</span>.<span class="cm-property">log</span>(<span class="cm-variable">localStorage</span>.<span class="cm-property">getItem</span>(<span class="cm-string">&quot;username&quot;</span>));
<span class="cm-comment">// → marijn</span>
<span class="cm-variable">localStorage</span>.<span class="cm-property">removeItem</span>(<span class="cm-string">&quot;username&quot;</span>);</pre>

<p>یک مقدار در <code>localStorage</code> تا زمانی که دوباره بازنویسی شود باقی می ماند، می توان آن را با <code>removeItem</code> حذف کرد ؛ همچنین کاربر می‌تواند داده‌های محلی مرورگر خود را به صورت دستی حذف کند.</p>

<p>سایت‌هایی که از دامنه‌های متفاوتی هستند ناحیه‌های ذخیره‌ی مجزایی دریافت می کنند. این یعنی داده‌هایی که در <code>localStorage</code> توسط یک وب‌سایت داده شده ذخیره می شوند، علی القاعده، فقط توسط اسکریپت‌هایی که روی همان سایت قرار دارند قابل خواندن و بازنویسی می باشند.</p>

<p>مرورگرها محدودیتی در رابطه با اندازه‌ی داده‌هایی که یک وب سایت می تواند در <code>localStorage</code> ذخیره کند اعمال می کنند. این محدودیت، در کنار این واقعیت که پر کردن دیسک سخت کاربر با اطلاعات به‌درد‌نخور فایده‌ای ندارد، باعث می شود که این ویژگی موجب گرفته شدن فضای زیادی نشود.</p>

<p>در کد پیش رو یک اپلیکیشن ابتدایی برای یادداشت برداری پیاده سازی شده است. این برنامه مجموعه‌ای از یادداشت ها دارای نام را نگهداری می کند و به کاربر این امکان را می دهد که این یادداشت‌ها را ویرایش کرده و موارد جدید را نیز بتواند اضافه کند.</p>

<pre class="snippet cm-s-default" data-language="text/html" ><a class="c_ident" id="c_7EHyh6Vlvw" href="#c_7EHyh6Vlvw" tabindex="-1" role="presentation"></a>Notes: <span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">select</span><span class="cm-tag cm-bracket">&gt;</span><span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">select</span><span class="cm-tag cm-bracket">&gt;</span> <span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">button</span><span class="cm-tag cm-bracket">&gt;</span>Add<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">button</span><span class="cm-tag cm-bracket">&gt;</span><span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">br</span><span class="cm-tag cm-bracket">&gt;</span>
<span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">textarea</span> <span class="cm-attribute">style</span>=<span class="cm-string">&quot;width: 100%&quot;</span><span class="cm-tag cm-bracket">&gt;</span><span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">textarea</span><span class="cm-tag cm-bracket">&gt;</span>

<span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">script</span><span class="cm-tag cm-bracket">&gt;</span>
  <span class="cm-keyword">let</span> <span class="cm-def">list</span> <span class="cm-operator">=</span> <span class="cm-variable">document</span>.<span class="cm-property">querySelector</span>(<span class="cm-string">&quot;select&quot;</span>);
  <span class="cm-keyword">let</span> <span class="cm-def">note</span> <span class="cm-operator">=</span> <span class="cm-variable">document</span>.<span class="cm-property">querySelector</span>(<span class="cm-string">&quot;textarea&quot;</span>);

  <span class="cm-keyword">let</span> <span class="cm-def">state</span>;
  <span class="cm-keyword">function</span> <span class="cm-def">setState</span>(<span class="cm-def">newState</span>) {
    <span class="cm-variable">list</span>.<span class="cm-property">textContent</span> <span class="cm-operator">=</span> <span class="cm-string">&quot;&quot;</span>;
    <span class="cm-keyword">for</span> (<span class="cm-keyword">let</span> <span class="cm-def">name</span> <span class="cm-keyword">of</span> <span class="cm-variable">Object</span>.<span class="cm-property">keys</span>(<span class="cm-variable-2">newState</span>.<span class="cm-property">notes</span>)) {
      <span class="cm-keyword">let</span> <span class="cm-def">option</span> <span class="cm-operator">=</span> <span class="cm-variable">document</span>.<span class="cm-property">createElement</span>(<span class="cm-string">&quot;option&quot;</span>);
      <span class="cm-variable-2">option</span>.<span class="cm-property">textContent</span> <span class="cm-operator">=</span> <span class="cm-variable-2">name</span>;
      <span class="cm-keyword">if</span> (<span class="cm-variable-2">newState</span>.<span class="cm-property">selected</span> <span class="cm-operator">==</span> <span class="cm-variable-2">name</span>) <span class="cm-variable-2">option</span>.<span class="cm-property">selected</span> <span class="cm-operator">=</span> <span class="cm-atom">true</span>;
      <span class="cm-variable">list</span>.<span class="cm-property">appendChild</span>(<span class="cm-variable-2">option</span>);
    }
    <span class="cm-variable">note</span>.<span class="cm-property">value</span> <span class="cm-operator">=</span> <span class="cm-variable-2">newState</span>.<span class="cm-property">notes</span>[<span class="cm-variable-2">newState</span>.<span class="cm-property">selected</span>];

    <span class="cm-variable">localStorage</span>.<span class="cm-property">setItem</span>(<span class="cm-string">&quot;Notes&quot;</span>, <span class="cm-variable">JSON</span>.<span class="cm-property">stringify</span>(<span class="cm-variable-2">newState</span>));
    <span class="cm-variable">state</span> <span class="cm-operator">=</span> <span class="cm-variable-2">newState</span>;
  }
  <span class="cm-variable">setState</span>(<span class="cm-variable">JSON</span>.<span class="cm-property">parse</span>(<span class="cm-variable">localStorage</span>.<span class="cm-property">getItem</span>(<span class="cm-string">&quot;Notes&quot;</span>)) <span class="cm-operator">|</span><span class="cm-operator">|</span> {
    <span class="cm-property">notes</span>: {<span class="cm-string cm-property">&quot;shopping list&quot;</span>: <span class="cm-string">&quot;Carrots\nRaisins&quot;</span>},
    <span class="cm-property">selected</span>: <span class="cm-string">&quot;shopping list&quot;</span>
  });

  <span class="cm-variable">list</span>.<span class="cm-property">addEventListener</span>(<span class="cm-string">&quot;change&quot;</span>, () <span class="cm-operator">=&gt;</span> {
    <span class="cm-variable">setState</span>({<span class="cm-property">notes</span>: <span class="cm-variable">state</span>.<span class="cm-property">notes</span>, <span class="cm-property">selected</span>: <span class="cm-variable">list</span>.<span class="cm-property">value</span>});
  });
  <span class="cm-variable">note</span>.<span class="cm-property">addEventListener</span>(<span class="cm-string">&quot;change&quot;</span>, () <span class="cm-operator">=&gt;</span> {
    <span class="cm-variable">setState</span>({
      <span class="cm-property">notes</span>: <span class="cm-variable">Object</span>.<span class="cm-property">assign</span>({}, <span class="cm-variable">state</span>.<span class="cm-property">notes</span>,
                           {[<span class="cm-variable">state</span>.<span class="cm-property">selected</span>]: <span class="cm-variable">note</span>.<span class="cm-property">value</span>}),
      <span class="cm-property">selected</span>: <span class="cm-variable">state</span>.<span class="cm-property">selected</span>
    });
  });
  <span class="cm-variable">document</span>.<span class="cm-property">querySelector</span>(<span class="cm-string">&quot;button&quot;</span>)
    .<span class="cm-property">addEventListener</span>(<span class="cm-string">&quot;click&quot;</span>, () <span class="cm-operator">=&gt;</span> {
      <span class="cm-keyword">let</span> <span class="cm-def">name</span> <span class="cm-operator">=</span> <span class="cm-variable">prompt</span>(<span class="cm-string">&quot;Note name&quot;</span>);
      <span class="cm-keyword">if</span> (<span class="cm-variable-2">name</span>) <span class="cm-variable">setState</span>({
        <span class="cm-property">notes</span>: <span class="cm-variable">Object</span>.<span class="cm-property">assign</span>({}, <span class="cm-variable">state</span>.<span class="cm-property">notes</span>, {[<span class="cm-variable-2">name</span>]: <span class="cm-string">&quot;&quot;</span>}),
        <span class="cm-property">selected</span>: <span class="cm-variable-2">name</span>
      });
    });
<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">script</span><span class="cm-tag cm-bracket">&gt;</span></pre>

<p>اسکریپت بالا وضعیت ابتدایی خودش را از مقدار <code>&quot;Notes&quot;</code> که در <code>localStorage</code> ذخیره شده است می‌گیرد یا در صورت نبود آن، یک وضعیت نمونه که یک لیست خرید فرضی در آن قرار دارد را ایجاد می کند. خواندن یک فیلد که وجود خارجی ندارد از <code>localStorage</code> موجب می شود تا مقدار <code>null</code> برگردانده شود. ارسال <code>null</code> به <bdo><code>JSON.parse</code></bdo> موجب می شود که رشته‌ی <code>&quot;null&quot;</code> به وجود بیاید و درنتیجه خروجی <code>null</code> تولید شود. بنابراین، عملگر <code>||</code> را می توان برای در نظر گرفتن مقدار پیش‌فرض در شرایطی مثل این استفاده کرد.</p>

<p>متد <code>setState</code> موجب می شود اطمینان حاصل کنیم که DOM وضعیت مشخصی را نمایش می دهد و وضعیت جدید را در <code>localStorage</code> ذخیره می کند. گرداننده‌های رخداد این تابع را برای انتقال به یک وضعیت جدید فراخوانی می کنند.</p>

<p>استفاده از <bdo><code>Object.assign</code></bdo> در مثال بالا به این خاطر بود که یک کپی از شیء <bdo><code>state.notes</code></bdo> قدیمی ایجاد شود که حاوی خاصیتی باشد که اضافه یا بازنویسی شده است. <bdo><code>Object.assign</code></bdo> اولین آرگومانش را گرفته و تمامی خاصیت‌هایی که در آرگومان‌های بعدی می آید را به آن اضافه می کند. بنابراین، روش استفاده از براکت‌ها در آرگومان سوم برای ایجاد یک خاصیت که نام آن بر اساس یک مقدار پویا مشخص می شود استفاده شده است.</p>

<p><a class="p_ident" id="p_/L3EwnHIiY" href="#p_/L3EwnHIiY" tabindex="-1" role="presentation"></a>شیء دیگری وجود دارد شبیه به <code>localStorage</code> به نام <code>sessionStorage</code>. تفاوت بین این دو این است که محتوای <code>sessionStorage</code> با به پایان رسیدن هر جلسه (session) فراموش می شود که در بیشتر مرورگرها با بستن مرورگر این اتفاق می افتد.</p>

<h2><a class="h_ident" id="h_EzvDUHyjs2" href="#h_EzvDUHyjs2" tabindex="-1" role="presentation"></a>خلاصه</h2>

<p><a class="p_ident" id="p_LuU8lbHUay" href="#p_LuU8lbHUay" tabindex="-1" role="presentation"></a>در این فصل به نحوه‌ی عملکرد پروتوکل HTTP پرداختیم. یک کلاینت درخواستی را ارسال می کند که حاوی یک متد (معمولا <code>GET</code>) و یک مسیر که معرف یک منبع است می‌باشد. سرویس دهنده سپس تصمیم می گیرد که با این درخواست چه کند و با یک کد وضعیت و یک بدنه‌ی پاسخ، به درخواست جواب می دهد. هر دوی درخواست و پاسخ می توانند حاوی سرپیام‌ها (headers) باشند که اطلاعات بیشتری را فراهم می کنند.</p>

<p>رابطی که از طریق آن جاوااسکریپت مرورگر می تواند درخواست‌های HTTP را بسازد <code>fetch</code> نامیده می شود. ساخت یک درخواست به شکل زیر می ماند:</p>

<pre class="snippet cm-s-default" data-language="javascript" ><a class="c_ident" id="c_I5lSLBiG+b" href="#c_I5lSLBiG+b" tabindex="-1" role="presentation"></a><span class="cm-variable">fetch</span>(<span class="cm-string">&quot;/18_http.html&quot;</span>).<span class="cm-property">then</span>(<span class="cm-def">r</span> <span class="cm-operator">=&gt;</span> <span class="cm-variable-2">r</span>.<span class="cm-property">text</span>()).<span class="cm-property">then</span>(<span class="cm-def">text</span> <span class="cm-operator">=&gt;</span> {
  <span class="cm-variable">console</span>.<span class="cm-property">log</span>(<span class="cm-string-2">`The page starts with ${</span><span class="cm-variable-2">text</span>.<span class="cm-property">slice</span>(<span class="cm-number">0</span>, <span class="cm-number">15</span>)<span class="cm-string-2">}</span><span class="cm-string-2">`</span>);
});</pre>

<p>مرورگرها از درخواست‌های نوع <code>GET</code> برای بازیابی منابع مورد نیاز جهت نمایش یک صفحه‌ی وب استفاده می کنند. یک صفحه وب ممکن است حاوی فرم‌ها نیز باشد که این امکان را فراهم می کنند که با ثبت فرم، اطلاعات ورودی کاربر برای ارسال درخواست برای یک صفحه‌ی جدید ارسال شود.</p>

<p>HTML اشکال متنوعی از فیلدهای فرم را پشتیبانی می کند مانند فیلدهای متنی، چک‌باکس‌ها یا، فیلد‌های چند‌گزینه‌ای و فیلدهای انتخاب فایل.</p>

<p><a class="p_ident" id="p_5/3fb3Spy+" href="#p_5/3fb3Spy+" tabindex="-1" role="presentation"></a>این فیلدها را می تواند توسط جاوااسکریپت کنترل و تغییر داد. رخداد <code>&quot;change&quot;</code> با ایجاد تغییر در یک فیلد تولید می شود، رخداد <code>&quot;input&quot;</code> زمانی ایجاد می شود که متنی در فیلد تایپ شود و رخدادهای مربوط به صفحه‌کلید هنگامی که فیلد توسط صفحه‌کلید در دسترس و فعال است دریافت می شوند. خاصیت‌هایی مثل <code>value</code> (در فیلدهای text و select) یا <code>checked</code> (در چک‌باکس‌ها و دکمه‌های رادیویی) برای خواندن یا تنظیم محتوای فیلد استفاده می شوند.</p>

<p>زمانی که یک فرم ثبت می شود، یک رخداد <code>&quot;submit&quot;</code> روی آن ایجاد می شود. یک گرداننده‌ی جاوااسکریپت می تواند با فراخوانی <code>preventDefault</code> مانع از ثبت فرم شود. فیلدهای فرم را نیز می تواند بیرون از برچسب form استفاده کرد.</p>

<p>زمانی که کاربر فایلی را از سیستم محلی فایل خود به وسیله‌ی فیلد انتخاب فایل گزینش می کند، رابط <code>FileReader</code> را می تواند برای دسترسی به محتوای آن فایل از درون یک برنامه جاوااسکریپت استفاده کرد.</p>

<p>اشیاء <code>localStorage</code> و <code>sessionStorage</code> را می توان برای ذخیره اطلاعات به صورت مانا که علی رغم بارگیری مجدد صفحه باقی می‌مانند استفاده کرد. اولین شیء، داده‌ها را به صورت همیشگی ذخیره می کند( یا تا هنگامی که کاربر تصمیم به حذف آنها بگیرد) و دومی تا زمانی که مرورگر بسته نشده داده ها را نگه می دارد.</p>

<h2><a class="h_ident" id="h_ggOFdVwDCk" href="#h_ggOFdVwDCk" tabindex="-1" role="presentation"></a>تمرین‌ها</h2>

<h3><a class="i_ident" id="i_don85W0fD5" href="#i_don85W0fD5" tabindex="-1" role="presentation"></a>مذاکره محتوا</h3>

<p><a class="p_ident" id="p_/VqqTlzuCT" href="#p_/VqqTlzuCT" tabindex="-1" role="presentation"></a>یکی از کارهایی که HTTP می تواند انجام دهد اصطلاحا مذاکره‌ی محتوا – content negotiation خوانده می شود. از سرپیام درخواست <code>Accept</code> برای اعلام نوع سندی که سرویس‌گیرنده درخواست دارد به سرویس‌دهنده استفاده می شود.خیلی از سرویس‌دهنده‌ها این سرپیام را نادیده می گیرند، اما زمانی که یک سرویس‌دهنده از راه‌های متنوع کدگذاری یک منبع آگاه است، می تواند به این سرپیام نگاه کرده و چیزی که سرویس‌گیرنده ترجیح می دهد را برایش ارسال کند.</p>

<p><a class="p_ident" id="p_MsN895Vk8m" href="#p_MsN895Vk8m" tabindex="-1" role="presentation"></a>آدرس <a href="https://eloquentjavascript.net/author"><em>https://eloquentjavascript.net/author</em></a> تنظیم شده است که بسته به درخواست سرویس‌گیرنده با متن عادی، HTML یا JSON پاسخ می‌دهد. این فرمت‌ها توسط انواع استاندارد شده‌ی رسانه، <code>application/json</code> و <code>text/plain</code>، <code>text/html</code> شناسایی می‌شود.</p>

<p>درخواست‌هایی برای بازیابی هر سه نوع فرمت گفته شده را به منبع ارسال کنید. از خاصیت <code>headers</code> در شیء مربوط به گزینه‌های که به <code>fetch</code> داده می شود برای تنظیم سرپیام <code>Accept</code> به نوع رسانه‌ی مورد نظر استفاده کنید.</p>

<p>درآخر، تلاش کنید که نوع رسانه‌ی <code>application/<wbr>rainbows+unicorns</code> را درخواست کنید و ببینید چه اتفاقی خواهد افتاد.</p>

<pre class="snippet cm-s-default" data-language="javascript" ><a class="c_ident" id="c_HRKSrZS1tJ" href="#c_HRKSrZS1tJ" tabindex="-1" role="presentation"></a><span class="cm-comment">// Your code here.</span></pre>

<div class="solution"><div class="solution-text">

<p>کد خود را بر اساس مثال‌های مربوط به <code>fetch</code> بنویسید <a href="18_http.html#fetch"> که پیش‌تر در این فصل آمد</a>.</p>

<p><a class="p_ident" id="p_tnLKJups2q" href="#p_tnLKJups2q" tabindex="-1" role="presentation"></a>درخواست برای یک نوع رسانه‌ی نامعتبر موجب می‌شود که پاسخی با کد 406 برگردانده شود، “Not acceptable”، که کدی است که سرویس‌دهنده باید در زمانی که قادر نیست به سرپیام <code>Accept</code> پاسخ معتبری بدهد، ارسال کند.</p>

</div></div>

<h3><a class="i_ident" id="i_+jAwEuzqG0" href="#i_+jAwEuzqG0" tabindex="-1" role="presentation"></a>یک میز کار جاوااسکریپت</h3>

<p>رابطی بسازید که به کاربران این امکان را بدهد که بتوانند کدهای جاوااسکریپت بنویسند و آن‌ها را اجرا کنند.</p>

<p>یک دکمه‌ی کنار فیلد <code>&lt;textarea&gt;</code> قرار دهید که در صورت فشرده شدن ، از سازنده‌ی <code>Function</code> که در <a href="10_modules.html#eval">فصل 10</a> دیدیم استفاده کند تا محتوای فیلد را درون یک تابع قرار داده و فراخوانی کند. مقدار بازگشتی از تابع را ، یا هر خطایی که به وجود می آید، به یک رشته تبدیل کنید و آن را پایین فیلد متنی نمایش دهید.</p>

<pre class="snippet cm-s-default" data-language="text/html" ><a class="c_ident" id="c_zdElSW9Q47" href="#c_zdElSW9Q47" tabindex="-1" role="presentation"></a><span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">textarea</span> <span class="cm-attribute">id</span>=<span class="cm-string">&quot;code&quot;</span><span class="cm-tag cm-bracket">&gt;</span>return &quot;hi&quot;;<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">textarea</span><span class="cm-tag cm-bracket">&gt;</span>
<span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">button</span> <span class="cm-attribute">id</span>=<span class="cm-string">&quot;button&quot;</span><span class="cm-tag cm-bracket">&gt;</span>Run<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">button</span><span class="cm-tag cm-bracket">&gt;</span>
<span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">pre</span> <span class="cm-attribute">id</span>=<span class="cm-string">&quot;output&quot;</span><span class="cm-tag cm-bracket">&gt;</span><span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">pre</span><span class="cm-tag cm-bracket">&gt;</span>

<span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">script</span><span class="cm-tag cm-bracket">&gt;</span>
  <span class="cm-comment">// Your code here.</span>
<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">script</span><span class="cm-tag cm-bracket">&gt;</span></pre>

<div class="solution"><div class="solution-text">

<p>از <code>document.<wbr>querySelector</code> یا <code>document.<wbr>getElementById</code> برای دسترسی به عناصر موجود در صفحه‌ی HTMLتان استفاده کنید. یک گرداننده‌ی رخداد برای <code>&quot;click&quot;</code> یا <code>&quot;mousedown&quot;</code> روی دکمه می می تواند خاصیت <code>value</code> مربوط به فیلد متنی را گرفته و <code>Function</code> را روی آن فراخوانی کند.</p>

<p>اطمینان حاصل کنید که هم فراخوانی به <code>Function</code> و هم فراخوانی نتیجه‌ی آن را در یک بلاک <code>try</code> محصور کنید تا بتوانید استثناء‌هایی که تولید می شود را پوشش دهید. در این مورد، واقعا نمی‌دانیم که چه نوع استثنائی را باید انتظار داشته باشیم، پس همه را پوشش می دهیم.</p>

<p>خاصیت <code>textContent</code> مربوط به عنصر محل نمایش را می توان برای قرار دادن متن رشته‌ای در آن استفاده کرد. یا، اگر قصد دارید که محتوای قبلی آن را نگه‌دارید، یک گره‌ی متنی جدید با استفاده از <code>document.<wbr>createTextNode</code> بسازید و آن را به عنصر مورد نظر الحاق کنید. به خاطر داشته باشید که به پایان آن یک کاراکتر خط جدید اضافه کنید تا از ظاهر شدن تمام خروجی در یک خط جلوگیری کنید.</p>

</div></div>

<h3><a class="i_ident" id="i_bGomLLD/Fk" href="#i_bGomLLD/Fk" tabindex="-1" role="presentation"></a>بازی زندگی کانوی ( Conway’s Game of Life)</h3>

<p>بازی زندگی کانوی یک تشبیه ساده است که یک “زندگی” مصنوعی را روی یک جدول ایجاد می کند. هر خانه جدول می تواند زنده یا مرده باشد. در هر نسل(دوره) قوانین زیر اعمال می شوند:</p>

<ul>

<li>

<p>هر خانه(سلول) زنده ای که کمتر از دو یا بیشتر از سه همسایه‌ی زنده داشته باشد می‌میرد.</p></li>

<li>

<p>هر سلول زنده که دو یا سه همسایه‌ی زنده داشته باشد به زندگی تا دوره‌ی بعد ادامه خواهد داد.</p></li>

<li>

<p>هر سلول مرده که دقیقا سه همسایه‌ی زنده داشته باشد به یک سلول زنده تبدیل می شود.</p></li></ul>

<p>هر خانه‌ای که مجاور محسوب شود به عنوان همسایه در نظر گرفته می شود حتی خانه‌هایی که به صورت قطری مجاور هستند.</p>

<p><a class="p_ident" id="p_88VDrV/p1p" href="#p_88VDrV/p1p" tabindex="-1" role="presentation"></a>توجه داشته باشید که این قوانین به کل جدول (grid) اعمال می شوند نه به یک چهار ضلعی محدود. به این معنا که شمارش همسایه‌ها بر اساس وضعیتی خواهد بود که ابتدای هر نسل وجود دارد و تغییرات اعمالی به همسایه‌ها در طول این نسل نباید به وضعیت جدید یک سلول مشخص اثر بگذارد.</p>

<p><a class="p_ident" id="p_oNcQqh8J65" href="#p_oNcQqh8J65" tabindex="-1" role="presentation"></a>این بازی را به وسیله‌ی جاوااسکریپت و با استفاده هر ساختار داده‌ای که مناسب می دانید پیاده سازی کنید. از <code>Math.random</code> برای پر کردن جدول با الگوی تصادفی برای شروع استفاده کنید. از فیلدهای checkbox به همراه دکمه‌ای در کنارشان برای انتقال به نسل بعد در جدول استفاده کنید. زمانی که کاربر checkbox را فعال یا غیر فعال می کند تغییرات آن ها باید در هنگام محاسبه‌ی نسل بعد اعمال شوند.</p>

<pre class="snippet cm-s-default" data-language="text/html" ><a class="c_ident" id="c_xF6LIoITNO" href="#c_xF6LIoITNO" tabindex="-1" role="presentation"></a><span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">div</span> <span class="cm-attribute">id</span>=<span class="cm-string">&quot;grid&quot;</span><span class="cm-tag cm-bracket">&gt;</span><span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">div</span><span class="cm-tag cm-bracket">&gt;</span>
<span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">button</span> <span class="cm-attribute">id</span>=<span class="cm-string">&quot;next&quot;</span><span class="cm-tag cm-bracket">&gt;</span>Next generation<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">button</span><span class="cm-tag cm-bracket">&gt;</span>

<span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">script</span><span class="cm-tag cm-bracket">&gt;</span>
  <span class="cm-comment">// Your code here.</span>
<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">script</span><span class="cm-tag cm-bracket">&gt;</span></pre>

<div class="solution"><div class="solution-text">

<p><a class="p_ident" id="p_jtl8YFzgA4" href="#p_jtl8YFzgA4" tabindex="-1" role="presentation"></a>برای حل مساله‌ی اتفاق افتادن تغییرات در یک زمان واحد به صورت مفهومی، سعی کنید که محاسبه‌ی یک نسل را به صورت یک تابع ناب (pure) ببینید، که یک grid را گرفته و یک grid جدید تولید می کند که نماینده‌ی دوره‌ی بعد می‌باشد.</p>

<p>نمایش ماتریکس را می‌توان از راهی که در <a href="06_object.html#matrix">فصل 6</a> نشان داده شد، میسر کرد. می‌توانید تعداد همسایه‌های زنده را به وسیله‌ی دو حلقه‌ی تودرتو بشمارید، با پیمایش مختصات مجاور در هر دو بعد. مواظب باشید که سلول‌های خارج از فیلد را نشمارید و سلول مرکز را هم به حساب نیاورید، سلولی که همسایه‌هایش را قصد داریم بشماریم.</p>

<p><a class="p_ident" id="p_6vQ2u8HBDB" href="#p_6vQ2u8HBDB" tabindex="-1" role="presentation"></a>از دو راه می توان اطمینان حاصل کرد که تغییر checkbox ها روی نسل بعد تاثیر می‌گذارد. یک گرداننده‌ی رخداد می تواند این تغییرات را متوجه شود و grid فعلی را برای بازتاب آن به‌روز کند، یا می توانید یک grid تازه از مقادیر موجود در checkbox ها قبل از محاسبه‌ی نسل بعد برای تولید یک grid تازه استفاده کنید.</p>

<p><a class="p_ident" id="p_VwGIkAKaXK" href="#p_VwGIkAKaXK" tabindex="-1" role="presentation"></a>اگر انتخاب شما استفاده از گرداننده‌های رخداد باشد، ممکن است بخواهید که خاصیت‌هایی برای مشخص نمودن موقعیت هر checkbox الحاق کنید تا بتوان به آسانی سلولی که باید تغییر کند را پیدا کنید.</p>

<p><a class="p_ident" id="p_Q40e1Ef4in" href="#p_Q40e1Ef4in" tabindex="-1" role="presentation"></a>برای رسم جدول checkbox ها، می‌توانید یا از یک <code>&lt;table&gt;</code> ( به <a href="14_dom.html#exercise_table">Chapter 14</a> رجوع کنید ) استفاده کنید یا به سادگی همه‌ی آن ها را در یک عنصر قرار داده و از <code>&lt;br&gt;</code> بین ردیف‌ها استفاده کنید.</p>

</div></div><nav><a href="17_canvas.html" title="previous chapter">◀</a> <a href="index.html" title="cover">◆</a> <a href="19_paint.html" title="next chapter">▶</a></nav>
</article>
